/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  LIRPSuggestModal: () => LIRPSuggestModal,
  default: () => ListItemRandomPicker
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
function findIndexes(anArray, predicate) {
  const indexes = [];
  anArray.forEach((element, index) => {
    if (predicate(element, index)) {
      indexes.push(index);
    }
  });
  return indexes;
}
var DEFAULT_SETTINGS = {
  notePath: "Full path of a note",
  showWarning: true
};
var LIRPList = class {
  constructor(lines) {
    this.title = "";
    this.description = "";
    this.hidden = false;
    this.items = [];
    this.warning = [];
    const headingRegEx = /^# +(.+)$/;
    this.title = lines[0].replace(headingRegEx, "$1");
    const italicHeadingRegex = /^(_|\*)\S/;
    if (italicHeadingRegex.test(this.title)) {
      this.hidden = true;
    } else {
      this.hidden = false;
    }
    lines.shift();
    const listBeginItemRegex = /^(-|\d+\.) +(.+)$/;
    const listBeginIndexes = findIndexes(lines, (element) => listBeginItemRegex.test(element));
    if (listBeginIndexes.length === 0) {
      this.warning.push(`No items in list ${this.title}`);
      this.hidden = true;
      return;
    }
    const cleanLines = lines.map((element) => {
      return element.replace(listBeginItemRegex, "$2");
    });
    if (listBeginIndexes[0] !== 0) {
      let mdDescription = cleanLines.slice(0, listBeginIndexes[0]);
      if (mdDescription[0] === "") {
        mdDescription.shift();
      }
      this.description = mdDescription.join("\n");
    } else {
      this.description = "";
    }
    const listBeginCount = listBeginIndexes.length;
    let item;
    for (let currentIndex = 0; currentIndex < listBeginCount - 1; currentIndex++) {
      item = cleanLines.slice(listBeginIndexes[currentIndex], listBeginIndexes[currentIndex + 1]);
      this.pushItemBasedOnWeight(item);
    }
    item = cleanLines.slice(listBeginIndexes[listBeginCount - 1]);
    if (item.at(-1) === "") {
      item.pop();
    }
    this.pushItemBasedOnWeight(item);
  }
  pushItemBasedOnWeight(item) {
    const ItemWithWeightRegEx = /^\((\d+)\)\s+(.+)$/;
    let regExExecution;
    let repeat;
    if ((regExExecution = ItemWithWeightRegEx.exec(item[0])) !== null) {
      repeat = Number(regExExecution[1]);
      item[0] = regExExecution[2];
    } else {
      repeat = 1;
    }
    const stringItem = item.join("\n");
    for (let i = 0; i < repeat; i++) {
      this.items.push(stringItem);
    }
  }
  getListSuggestion() {
    const suggestion = {
      title: this.title,
      description: this.description.split("\n")[0]
    };
    return suggestion;
  }
  notHidden() {
    return !this.hidden;
  }
  pickRandomItem() {
    let randomItem = "";
    if (this.items.length > 0) {
      randomItem = this.items[Math.floor(Math.random() * this.items.length)];
    }
    return randomItem;
  }
  getWarning() {
    return this.warning;
  }
};
var LIRPNote = class {
  constructor() {
    this.noteName = "";
    this.description = "";
    this.list = [];
    this.error = [];
    this.warning = [];
  }
  loadFromNote(noteName, noteContent) {
    this.noteName = noteName;
    const lines = noteContent.split("\n");
    const headingRegex = /^# .+$/;
    let headingIndexes = findIndexes(lines, (element) => headingRegex.test(element));
    if (headingIndexes.length === 0) {
      this.error.push(`No heading in note`);
      return false;
    }
    if (headingIndexes[0] !== 0) {
      this.description = lines.slice(0, headingIndexes[0]).join("\n");
    }
    headingIndexes = findIndexes(lines, (element) => headingRegex.test(element));
    const headingCount = headingIndexes.length;
    for (let currentIndex = headingIndexes[0]; currentIndex < headingCount - 1; currentIndex++) {
      this.list.push(new LIRPList(lines.slice(headingIndexes[currentIndex], headingIndexes[currentIndex + 1])));
    }
    this.list.push(new LIRPList(lines.slice(headingIndexes[headingCount - 1])));
    return true;
  }
  getNoteSuggestion() {
    let noteSuggestion;
    noteSuggestion = [];
    this.list.forEach((element) => {
      if (element.notHidden()) {
        noteSuggestion.push(element.getListSuggestion());
      }
    });
    return noteSuggestion;
  }
  execMacroSubstitution(item, macroRecursion = 1) {
    const currentMacroRecusion = macroRecursion - 1;
    let modifiedItem = item;
    this.list.forEach((element) => {
      const stringTitleRegex = `{(${element.title})}`;
      const titleRegex = new RegExp(stringTitleRegex, "m");
      while (titleRegex.test(modifiedItem)) {
        const execTitleRegex = titleRegex.exec(modifiedItem);
        if (execTitleRegex !== null) {
          const listTitle = execTitleRegex[1];
          modifiedItem = modifiedItem.replace(titleRegex, this.pickRandomItemFromList(listTitle, currentMacroRecusion));
        }
      }
    });
    return modifiedItem;
  }
  pickRandomItemFromList(listTitle, macroRecursion = 1) {
    let randomItem = "";
    const currentList = this.list.find((element) => element.title === listTitle);
    if (currentList !== void 0) {
      randomItem = currentList.pickRandomItem();
      for (let repeat = 0; repeat < macroRecursion; repeat++) {
        randomItem = this.execMacroSubstitution(randomItem);
      }
    }
    return randomItem;
  }
  getError() {
    return this.error;
  }
  getWarning() {
    let allWarning;
    allWarning = [];
    allWarning = allWarning.concat(this.warning);
    this.list.forEach((element) => {
      allWarning = allWarning.concat(element.getWarning());
    });
    let NoteWarning;
    NoteWarning = [];
    allWarning.forEach(
      (element) => NoteWarning.push(`Warning in note "${this.noteName}" : ${element}`)
    );
    return NoteWarning;
  }
};
var LIRPSuggestModal = class extends import_obsidian.SuggestModal {
  constructor(app, items, callback) {
    super(app);
    this.items = items;
    this.callback = callback;
  }
  getSuggestions(query) {
    return this.items.filter(
      (item) => item.title.toLowerCase().includes(query.toLowerCase())
    );
  }
  renderSuggestion(item, el) {
    el.createEl("div", { text: item.title });
    el.createEl("small", { text: item.description });
  }
  onChooseSuggestion(item, evt) {
    this.callback(item.title);
  }
};
var ListItemRandomPicker = class extends import_obsidian.Plugin {
  async onload() {
    await this.loadSettings();
    this.addRibbonIcon("list-tree", "Pick random list item", (evt) => {
      this.doTheJob(this.settings.notePath + ".md");
    });
    this.addCommand({
      id: "insert-random-item",
      name: "Insert random item from list",
      callback: () => {
        this.doTheJob(this.settings.notePath + ".md");
      }
    });
    this.addSettingTab(new LIRPSettingTab(this.app, this));
  }
  onunload() {
  }
  async doTheJob(fullNotePath) {
    const file = this.app.vault.getAbstractFileByPath(fullNotePath);
    if (!file) {
      new import_obsidian.Notice("Note not found!");
      return;
    }
    if (!(file instanceof import_obsidian.TFile)) {
      new import_obsidian.Notice("Invalid file type. Expected a Markdown note file.");
      return;
    }
    const content = await this.app.vault.cachedRead(file);
    const currentLIRP = new LIRPNote();
    const loadSuccess = currentLIRP.loadFromNote(this.settings.notePath, content);
    if (!loadSuccess) {
      currentLIRP.getError().forEach((element) => new import_obsidian.Notice(element));
      return;
    }
    if (this.settings.showWarning) {
      currentLIRP.getWarning().forEach((element) => {
        new import_obsidian.Notice(element);
      });
    }
    ;
    new LIRPSuggestModal(this.app, currentLIRP.getNoteSuggestion(), (title) => {
      this.insertString(currentLIRP.pickRandomItemFromList(title));
    }).open();
  }
  insertString(currentString) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if (activeView) {
      const editor = activeView.editor;
      const selection = editor.getSelection();
      editor.replaceSelection(currentString);
    } else {
      new import_obsidian.Notice("No active Markdown editor found.");
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var LIRPSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Note Path").setDesc("Path to the note containing the lists.").addText(
      (text) => text.setPlaceholder("Enter the path to your note").setValue(this.plugin.settings.notePath).onChange(async (value) => {
        this.plugin.settings.notePath = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Show warning").setDesc("Show warnings of Note and lists, if present.").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.showWarning);
      toggle.onChange(async (value) => {
        this.plugin.settings.showWarning = value;
        await this.plugin.saveSettings();
      });
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBTdWdnZXN0TW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBURmlsZSwgTWFya2Rvd25WaWV3IH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5mdW5jdGlvbiBmaW5kSW5kZXhlczxUPihhbkFycmF5OiBUW10sIHByZWRpY2F0ZTogKGVsZW1lbnQ6IFQsIGluZGV4OiBudW1iZXIpID0+IGJvb2xlYW4pOiBudW1iZXJbXSB7XG4gICAgY29uc3QgaW5kZXhlczogbnVtYmVyW10gPSBbXTtcbiAgICBhbkFycmF5LmZvckVhY2goKGVsZW1lbnQsIGluZGV4KSA9PiB7XG4gICAgICBpZiAocHJlZGljYXRlKGVsZW1lbnQsIGluZGV4KSkge1xuICAgICAgICBpbmRleGVzLnB1c2goaW5kZXgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBpbmRleGVzO1xuICB9XG5pbnRlcmZhY2UgTElSUFBsdWdpblNldHRpbmdzIHtcbiAgICBub3RlUGF0aDogc3RyaW5nO1xuICAgIHNob3dXYXJuaW5nOiBib29sZWFuO1xufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBMSVJQUGx1Z2luU2V0dGluZ3MgPSB7XG4gICAgbm90ZVBhdGg6ICdGdWxsIHBhdGggb2YgYSBub3RlJyxcbiAgICBzaG93V2FybmluZzogdHJ1ZSxcbn07XG5cbmludGVyZmFjZSBMSVJQTGlzdEludGVyZmFjZSB7XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIGl0ZW1zOiBzdHJpbmdbXTtcbiAgICBnZXRMaXN0U3VnZ2VzdGlvbigpOiBMSVJQU3VnZ2VzdGlvbkludGVyZmFjZTtcbiAgICBub3RIaWRkZW4oKTogYm9vbGVhbjtcbiAgICBwaWNrUmFuZG9tSXRlbSgpOiBzdHJpbmc7XG4gICAgZ2V0V2FybmluZygpOiBzdHJpbmdbXTtcbn1cblxuY2xhc3MgTElSUExpc3QgaW1wbGVtZW50cyBMSVJQTGlzdEludGVyZmFjZSB7XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIGhpZGRlbjogYm9vbGVhbjtcbiAgICBpdGVtczogc3RyaW5nW107XG4gICAgd2FybmluZzogc3RyaW5nW11cblxuICAgIGNvbnN0cnVjdG9yKGxpbmVzOiBzdHJpbmdbXSkge1xuICAgICAgICB0aGlzLnRpdGxlID0gXCJcIjtcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IFwiXCI7XG4gICAgICAgIHRoaXMuaGlkZGVuID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXRlbXMgPSBbXTtcbiAgICAgICAgdGhpcy53YXJuaW5nID0gW107XG5cbiAgICAgICAgY29uc3QgaGVhZGluZ1JlZ0V4ID0gL14jICsoLispJC87XG4gICAgICAgIHRoaXMudGl0bGUgPSBsaW5lc1swXS5yZXBsYWNlKGhlYWRpbmdSZWdFeCwgXCIkMVwiKTtcbiAgICAgICAgY29uc3QgaXRhbGljSGVhZGluZ1JlZ2V4ID0gL14oX3xcXCopXFxTLztcbiAgICAgICAgaWYgKGl0YWxpY0hlYWRpbmdSZWdleC50ZXN0KHRoaXMudGl0bGUpKSB7XG4gICAgICAgICAgICB0aGlzLmhpZGRlbiA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmhpZGRlbiA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGxpbmVzLnNoaWZ0KCk7XG4gICAgICAgIGNvbnN0IGxpc3RCZWdpbkl0ZW1SZWdleCA9IC9eKC18XFxkK1xcLikgKyguKykkLztcbiAgICAgICAgY29uc3QgbGlzdEJlZ2luSW5kZXhlcyA9IGZpbmRJbmRleGVzKGxpbmVzLCAoZWxlbWVudCkgPT4gbGlzdEJlZ2luSXRlbVJlZ2V4LnRlc3QoZWxlbWVudCkpO1xuICAgICAgICBpZiAobGlzdEJlZ2luSW5kZXhlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMud2FybmluZy5wdXNoKGBObyBpdGVtcyBpbiBsaXN0ICR7dGhpcy50aXRsZX1gKTtcbiAgICAgICAgICAgIHRoaXMuaGlkZGVuID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjbGVhbkxpbmVzID0gbGluZXMubWFwKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudC5yZXBsYWNlKGxpc3RCZWdpbkl0ZW1SZWdleCwgXCIkMlwiKVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGxpc3RCZWdpbkluZGV4ZXNbMF0gIT09IDApIHtcbiAgICAgICAgICAgIGxldCBtZERlc2NyaXB0aW9uID0gY2xlYW5MaW5lcy5zbGljZSgwLCBsaXN0QmVnaW5JbmRleGVzWzBdKTtcbiAgICAgICAgICAgIC8vIHRha2luZyBjYXJlIG9mIE1EMDIyXG4gICAgICAgICAgICAvLyAgIE1EMDIyL2JsYW5rcy1hcm91bmQtaGVhZGluZ3M6IEhlYWRpbmdzIHNob3VsZCBiZSBzdXJyb3VuZGVkIGJ5IGJsYW5rIGxpbmVzXG4gICAgICAgICAgICBpZiAobWREZXNjcmlwdGlvblswXSA9PT0gXCJcIikge1xuICAgICAgICAgICAgICAgIG1kRGVzY3JpcHRpb24uc2hpZnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHRha2luZyBjYXJlIG9mIE1EMDMyXG4gICAgICAgICAgICAvLyAgIE1EMDMyL2JsYW5rcy1hcm91bmQtbGlzdHM6IExpc3RzIHNob3VsZCBiZSBzdXJyb3VuZGVkIGJ5IGJsYW5rIGxpbmVzXG4gICAgICAgICAgICAvLyBEdWUgdG8gc3BsaXQgb24gJ1xcbicsIHRoZSBzbGljZSwgYW5kIGF0IGxlYXN0IGEgam9pbiBvbiAnXFxuJyB0aGUgbGFzdCAnXFxuJyBpcyBhbHdheXMgbG9zdCAhXG4gICAgICAgICAgICAvLyBTbyB0aGUgZm9sb3dpbmcgY29kZSBpcyB1c2VsZXNzXG4gICAgICAgICAgICAvLyBpZiAobWREZXNjcmlwdGlvbi5hdCgtMSkgPT09IFwiXCIpIHtcbiAgICAgICAgICAgIC8vICAgICBtZERlc2NyaXB0aW9uLnBvcCgpO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IG1kRGVzY3JpcHRpb24uam9pbignXFxuJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gXCJcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGxpc3RCZWdpbkNvdW50ID0gbGlzdEJlZ2luSW5kZXhlcy5sZW5ndGhcbiAgICAgICAgbGV0IGl0ZW06IHN0cmluZ1tdO1xuICAgICAgICBmb3IgKGxldCBjdXJyZW50SW5kZXggPSAwOyBjdXJyZW50SW5kZXggPCAobGlzdEJlZ2luQ291bnQgLSAxKTsgY3VycmVudEluZGV4KyspIHtcbiAgICAgICAgICAgIGl0ZW0gPSAoY2xlYW5MaW5lcy5zbGljZShsaXN0QmVnaW5JbmRleGVzW2N1cnJlbnRJbmRleF0sIGxpc3RCZWdpbkluZGV4ZXNbY3VycmVudEluZGV4ICsgMV0pKTtcbiAgICAgICAgICAgIHRoaXMucHVzaEl0ZW1CYXNlZE9uV2VpZ2h0KGl0ZW0pO1xuICAgICAgICB9XG4gICAgICAgIGl0ZW0gPSAoY2xlYW5MaW5lcy5zbGljZShsaXN0QmVnaW5JbmRleGVzW2xpc3RCZWdpbkNvdW50IC0gMV0pKTtcbiAgICAgICAgLy8gdGFraW5nIGNhcmUgb2YgTUQwMjJcbiAgICAgICAgLy8gICBNRDAyMi9ibGFua3MtYXJvdW5kLWhlYWRpbmdzOiBIZWFkaW5ncyBzaG91bGQgYmUgc3Vycm91bmRlZCBieSBibGFuayBsaW5lc1xuICAgICAgICBpZiAoaXRlbS5hdCgtMSkgPT09IFwiXCIpIHtcbiAgICAgICAgICAgIGl0ZW0ucG9wKCk7XG4gICAgICAgIH0gICAgICAgIFxuICAgICAgICB0aGlzLnB1c2hJdGVtQmFzZWRPbldlaWdodChpdGVtKTtcbiAgICB9XG5cbiAgICBwdXNoSXRlbUJhc2VkT25XZWlnaHQoaXRlbTogc3RyaW5nW10pIDogdm9pZCB7XG4gICAgICAgIGNvbnN0IEl0ZW1XaXRoV2VpZ2h0UmVnRXggPSAvXlxcKChcXGQrKVxcKVxccysoLispJC87XG4gICAgICAgIGxldCByZWdFeEV4ZWN1dGlvblxuICAgICAgICBsZXQgcmVwZWF0OiBudW1iZXI7XG4gICAgICAgIGlmICgocmVnRXhFeGVjdXRpb24gPSBJdGVtV2l0aFdlaWdodFJlZ0V4LmV4ZWMoaXRlbVswXSkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICByZXBlYXQgPSBOdW1iZXIocmVnRXhFeGVjdXRpb25bMV0pO1xuICAgICAgICAgICAgaXRlbVswXSA9IHJlZ0V4RXhlY3V0aW9uWzJdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVwZWF0ID0gMTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzdHJpbmdJdGVtID0gaXRlbS5qb2luKCdcXG4nKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXBlYXQ7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKHN0cmluZ0l0ZW0pO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGdldExpc3RTdWdnZXN0aW9uKCk6IExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbiA9IHtcbiAgICAgICAgICAgIHRpdGxlOiB0aGlzLnRpdGxlLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246ICh0aGlzLmRlc2NyaXB0aW9uLnNwbGl0KCdcXG4nKVswXSksXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb247XG4gICAgfTtcblxuICAgIG5vdEhpZGRlbigpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLmhpZGRlbjtcbiAgICB9XG5cbiAgICBwaWNrUmFuZG9tSXRlbSgpOiBzdHJpbmcge1xuICAgICAgICBsZXQgcmFuZG9tSXRlbTogc3RyaW5nID0gXCJcIjtcbiAgICAgICAgaWYgKHRoaXMuaXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmFuZG9tSXRlbSA9IHRoaXMuaXRlbXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGhpcy5pdGVtcy5sZW5ndGgpXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmFuZG9tSXRlbTtcbiAgICB9XG5cbiAgICBnZXRXYXJuaW5nKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMud2FybmluZztcbiAgICB9XG5cbn1cbmludGVyZmFjZSBMSVJQTm90ZUludGVyZmFjZSB7XG4gICAgbm90ZU5hbWU6IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIGxvYWRGcm9tTm90ZShub3RlTmFtZTogc3RyaW5nLCBub3RlQ29udGVudDogc3RyaW5nKTogYm9vbGVhbjtcbiAgICBnZXROb3RlU3VnZ2VzdGlvbigpOiBMSVJQU3VnZ2VzdGlvbkludGVyZmFjZVtdO1xuICAgIHBpY2tSYW5kb21JdGVtRnJvbUxpc3QobGlzdFRpdGxlOiBzdHJpbmcsIG1hY3JvUmVjdXJzaW9uOiBudW1iZXIpOiBzdHJpbmc7IFxuICAgIGdldEVycm9yKCk6IHN0cmluZ1tdO1xuICAgIGdldFdhcm5pbmcoKTogc3RyaW5nW107XG59XG5cbmNsYXNzIExJUlBOb3RlIGltcGxlbWVudHMgTElSUE5vdGVJbnRlcmZhY2Uge1xuICAgIG5vdGVOYW1lOiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgICBsaXN0OiBMSVJQTGlzdFtdO1xuICAgIGVycm9yOiBzdHJpbmdbXTtcbiAgICB3YXJuaW5nOiBzdHJpbmdbXTtcblxuICAgIGNvbnN0cnVjdG9yICgpIHtcbiAgICAgICAgdGhpcy5ub3RlTmFtZSA9IFwiXCI7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBcIlwiO1xuICAgICAgICB0aGlzLmxpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5lcnJvciA9IFtdO1xuICAgICAgICB0aGlzLndhcm5pbmcgPSBbXTtcbiAgICB9XG5cbiAgICBsb2FkRnJvbU5vdGUobm90ZU5hbWU6IHN0cmluZywgbm90ZUNvbnRlbnQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICB0aGlzLm5vdGVOYW1lID0gbm90ZU5hbWU7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gbm90ZUNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgICAgICBjb25zdCBoZWFkaW5nUmVnZXggPSAvXiMgLiskLztcbiAgICAgICAgbGV0IGhlYWRpbmdJbmRleGVzID0gZmluZEluZGV4ZXMobGluZXMsIChlbGVtZW50KSA9PiBoZWFkaW5nUmVnZXgudGVzdChlbGVtZW50KSk7XG4gICAgICAgIGlmIChoZWFkaW5nSW5kZXhlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IucHVzaChgTm8gaGVhZGluZyBpbiBub3RlYCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhlYWRpbmdJbmRleGVzWzBdICE9PSAwKSB7XG4gICAgICAgICAgICAvLyB0YWtpbmcgY2FyZSBvZiBNRDAyMlxuICAgICAgICAgICAgLy8gICBNRDAyMi9ibGFua3MtYXJvdW5kLWhlYWRpbmdzOiBIZWFkaW5ncyBzaG91bGQgYmUgc3Vycm91bmRlZCBieSBibGFuayBsaW5lc1xuICAgICAgICAgICAgLy8gRHVlIHRvIHNwbGl0IG9uICdcXG4nLCB0aGUgc2xpY2UsIGFuZCBhdCBsZWFzdCBhIGpvaW4gb24gJ1xcbicgdGhlIGxhc3QgJ1xcbicgaXMgYWx3YXlzIGxvc3QgIVxuICAgICAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGxpbmVzLnNsaWNlKDAsIGhlYWRpbmdJbmRleGVzWzBdKS5qb2luKCdcXG4nKTtcbiAgICAgICAgfVxuICAgICAgICBoZWFkaW5nSW5kZXhlcyA9IGZpbmRJbmRleGVzKGxpbmVzLCAoZWxlbWVudCkgPT4gaGVhZGluZ1JlZ2V4LnRlc3QoZWxlbWVudCkpO1xuICAgICAgICBjb25zdCBoZWFkaW5nQ291bnQgPSBoZWFkaW5nSW5kZXhlcy5sZW5ndGhcbiAgICAgICAgZm9yIChsZXQgY3VycmVudEluZGV4ID0gaGVhZGluZ0luZGV4ZXNbMF07IGN1cnJlbnRJbmRleCA8IChoZWFkaW5nQ291bnQgLSAxKTsgY3VycmVudEluZGV4KyspIHtcbiAgICAgICAgICAgIHRoaXMubGlzdC5wdXNoKG5ldyBMSVJQTGlzdChsaW5lcy5zbGljZShoZWFkaW5nSW5kZXhlc1tjdXJyZW50SW5kZXhdLCBoZWFkaW5nSW5kZXhlc1tjdXJyZW50SW5kZXggKyAxXSkpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxpc3QucHVzaChuZXcgTElSUExpc3QobGluZXMuc2xpY2UoaGVhZGluZ0luZGV4ZXNbaGVhZGluZ0NvdW50IC0gMV0pKSk7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuXG4gICAgZ2V0Tm90ZVN1Z2dlc3Rpb24oKTogTElSUFN1Z2dlc3Rpb25JbnRlcmZhY2VbXSB7XG4gICAgICAgIGxldCBub3RlU3VnZ2VzdGlvbjogTElSUFN1Z2dlc3Rpb25JbnRlcmZhY2VbXTtcbiAgICAgICAgbm90ZVN1Z2dlc3Rpb24gPSBbXTtcbiAgICAgICAgdGhpcy5saXN0LmZvckVhY2goKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChlbGVtZW50Lm5vdEhpZGRlbigpKSB7XG4gICAgICAgICAgICAgICAgbm90ZVN1Z2dlc3Rpb24ucHVzaChlbGVtZW50LmdldExpc3RTdWdnZXN0aW9uKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG5vdGVTdWdnZXN0aW9uO1xuICAgIH1cblxuICAgIGV4ZWNNYWNyb1N1YnN0aXR1dGlvbihpdGVtOiBzdHJpbmcsIG1hY3JvUmVjdXJzaW9uOiBudW1iZXIgPSAxKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgY3VycmVudE1hY3JvUmVjdXNpb24gPSBtYWNyb1JlY3Vyc2lvbiAtMTtcbiAgICAgICAgbGV0IG1vZGlmaWVkSXRlbTogc3RyaW5nID0gaXRlbTtcbiAgICAgICAgdGhpcy5saXN0LmZvckVhY2goKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0cmluZ1RpdGxlUmVnZXggID0gYFxceygke2VsZW1lbnQudGl0bGV9KVxcfWA7XG4gICAgICAgICAgICBjb25zdCB0aXRsZVJlZ2V4ID0gbmV3IFJlZ0V4cChzdHJpbmdUaXRsZVJlZ2V4LCAnbScpO1xuICAgICAgICAgICAgd2hpbGUgKHRpdGxlUmVnZXgudGVzdChtb2RpZmllZEl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXhlY1RpdGxlUmVnZXggPSB0aXRsZVJlZ2V4LmV4ZWMobW9kaWZpZWRJdGVtKTtcbiAgICAgICAgICAgICAgICBpZiAoZXhlY1RpdGxlUmVnZXggIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGlzdFRpdGxlID0gZXhlY1RpdGxlUmVnZXhbMV1cbiAgICAgICAgICAgICAgICAgICAgbW9kaWZpZWRJdGVtID0gbW9kaWZpZWRJdGVtLnJlcGxhY2UodGl0bGVSZWdleCwgdGhpcy5waWNrUmFuZG9tSXRlbUZyb21MaXN0KGxpc3RUaXRsZSwgY3VycmVudE1hY3JvUmVjdXNpb24pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbW9kaWZpZWRJdGVtO1xuICAgIH1cblxuXG4gICAgcGlja1JhbmRvbUl0ZW1Gcm9tTGlzdChsaXN0VGl0bGU6IHN0cmluZywgbWFjcm9SZWN1cnNpb246IG51bWJlciA9IDEpOiBzdHJpbmcge1xuICAgICAgICBsZXQgcmFuZG9tSXRlbTogc3RyaW5nID0gXCJcIjtcbiAgICAgICAgY29uc3QgY3VycmVudExpc3QgPSB0aGlzLmxpc3QuZmluZCgoZWxlbWVudCkgPT4gZWxlbWVudC50aXRsZSA9PT0gbGlzdFRpdGxlKTtcbiAgICAgICAgaWYgKGN1cnJlbnRMaXN0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJhbmRvbUl0ZW0gPSBjdXJyZW50TGlzdC5waWNrUmFuZG9tSXRlbSgpO1xuICAgICAgICAgICAgZm9yIChsZXQgcmVwZWF0ID0gMDsgcmVwZWF0IDwgbWFjcm9SZWN1cnNpb247IHJlcGVhdCsrKSB7XG4gICAgICAgICAgICAgICAgcmFuZG9tSXRlbSA9IHRoaXMuZXhlY01hY3JvU3Vic3RpdHV0aW9uKHJhbmRvbUl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByYW5kb21JdGVtO1xuICAgIH0gXG5cbiAgICBnZXRFcnJvcigpOiBzdHJpbmdbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVycm9yO1xuICAgIH07XG5cbiAgICBnZXRXYXJuaW5nKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgbGV0IGFsbFdhcm5pbmc6IHN0cmluZ1tdO1xuICAgICAgICBhbGxXYXJuaW5nID0gW107XG4gICAgICAgIGFsbFdhcm5pbmcgPSBhbGxXYXJuaW5nLmNvbmNhdCh0aGlzLndhcm5pbmcpO1xuICAgICAgICB0aGlzLmxpc3QuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgYWxsV2FybmluZyA9IGFsbFdhcm5pbmcuY29uY2F0KGVsZW1lbnQuZ2V0V2FybmluZygpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGxldCBOb3RlV2FybmluZzogc3RyaW5nW107XG4gICAgICAgIE5vdGVXYXJuaW5nID0gW107XG4gICAgICAgIGFsbFdhcm5pbmcuZm9yRWFjaCgoZWxlbWVudCkgPT4gXG4gICAgICAgICAgICBOb3RlV2FybmluZy5wdXNoKGBXYXJuaW5nIGluIG5vdGUgXCIke3RoaXMubm90ZU5hbWV9XCIgOiAke2VsZW1lbnR9YClcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIE5vdGVXYXJuaW5nO1xuICAgIH07XG5cbn1cbmludGVyZmFjZSBMSVJQU3VnZ2VzdGlvbkludGVyZmFjZSB7XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xufVxuXG5cbmV4cG9ydCBjbGFzcyBMSVJQU3VnZ2VzdE1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlPiB7XG4gICAgaXRlbXM6IExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlW107XG4gICAgY2FsbGJhY2s6ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xuICBcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgaXRlbXM6IExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlW10sIGNhbGxiYWNrOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZCkge1xuICAgICAgc3VwZXIoYXBwKTtcbiAgICAgIHRoaXMuaXRlbXMgPSBpdGVtcztcbiAgICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogTElSUFN1Z2dlc3Rpb25JbnRlcmZhY2VbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLml0ZW1zLmZpbHRlcigoaXRlbSkgPT5cbiAgICAgICAgICAgIGl0ZW0udGl0bGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKVxuICAgICAgICApO1xuICAgICAgfVxuICAgIFxuICAgIHJlbmRlclN1Z2dlc3Rpb24oaXRlbTogTElSUFN1Z2dlc3Rpb25JbnRlcmZhY2UsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBpdGVtLnRpdGxlIH0pO1xuICAgICAgICBlbC5jcmVhdGVFbCgnc21hbGwnLCB7dGV4dDogaXRlbS5kZXNjcmlwdGlvbn0pO1xuICAgICAgfVxuICBcbiAgICAgIG9uQ2hvb3NlU3VnZ2VzdGlvbihpdGVtOiBMSVJQU3VnZ2VzdGlvbkludGVyZmFjZSwgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICB0aGlzLmNhbGxiYWNrKGl0ZW0udGl0bGUpO1xuICAgICAgfX1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTGlzdEl0ZW1SYW5kb21QaWNrZXIgZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzOiBMSVJQUGx1Z2luU2V0dGluZ3M7XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICAgICAgdGhpcy5hZGRSaWJib25JY29uKCdsaXN0LXRyZWUnLCAnUGljayByYW5kb20gbGlzdCBpdGVtJywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kb1RoZUpvYih0aGlzLnNldHRpbmdzLm5vdGVQYXRoICsgJy5tZCcpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdpbnNlcnQtcmFuZG9tLWl0ZW0nLFxuICAgICAgICAgICAgbmFtZTogJ0luc2VydCByYW5kb20gaXRlbSBmcm9tIGxpc3QnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmRvVGhlSm9iKHRoaXMuc2V0dGluZ3Mubm90ZVBhdGggKyAnLm1kJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgTElSUFNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcbiAgICB9XG5cbiAgICBvbnVubG9hZCgpIHtcblxuICAgIH1cblxuICAgIGFzeW5jIGRvVGhlSm9iKGZ1bGxOb3RlUGF0aDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZnVsbE5vdGVQYXRoKTtcblxuICAgICAgICBpZiAoIWZpbGUpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vdGUgbm90IGZvdW5kIScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnSW52YWxpZCBmaWxlIHR5cGUuIEV4cGVjdGVkIGEgTWFya2Rvd24gbm90ZSBmaWxlLicpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNhY2hlZFJlYWQoZmlsZSk7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRMSVJQID0gbmV3IExJUlBOb3RlKCk7XG5cbiAgICAgICAgY29uc3QgbG9hZFN1Y2Nlc3MgPSBjdXJyZW50TElSUC5sb2FkRnJvbU5vdGUodGhpcy5zZXR0aW5ncy5ub3RlUGF0aCwgY29udGVudCk7XG4gICAgICAgIGlmICghbG9hZFN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIGN1cnJlbnRMSVJQLmdldEVycm9yKCkuZm9yRWFjaCgoZWxlbWVudCkgPT4gbmV3IE5vdGljZShlbGVtZW50KSk7XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5zaG93V2FybmluZykge1xuICAgICAgICAgICAgY3VycmVudExJUlAuZ2V0V2FybmluZygpLmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShlbGVtZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBuZXcgTElSUFN1Z2dlc3RNb2RhbCh0aGlzLmFwcCwgY3VycmVudExJUlAuZ2V0Tm90ZVN1Z2dlc3Rpb24oKSwgKHRpdGxlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmluc2VydFN0cmluZyhjdXJyZW50TElSUC5waWNrUmFuZG9tSXRlbUZyb21MaXN0KHRpdGxlKSk7XG4gICAgICAgIH0pLm9wZW4oKTtcbiAgICB9XG5cbiAgICBpbnNlcnRTdHJpbmcoY3VycmVudFN0cmluZzogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXG4gICAgICAgIGlmIChhY3RpdmVWaWV3KSB7XG4gICAgICAgICAgICBjb25zdCBlZGl0b3IgPSBhY3RpdmVWaWV3LmVkaXRvcjtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKGN1cnJlbnRTdHJpbmcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3IE5vdGljZShcIk5vIGFjdGl2ZSBNYXJrZG93biBlZGl0b3IgZm91bmQuXCIpO1xuICAgICAgICB9XG5cbiAgICB9O1xuXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gICAgfVxufVxuXG5jbGFzcyBMSVJQU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHBsdWdpbjogTGlzdEl0ZW1SYW5kb21QaWNrZXI7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBMaXN0SXRlbVJhbmRvbVBpY2tlcikge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnTm90ZSBQYXRoJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdQYXRoIHRvIHRoZSBub3RlIGNvbnRhaW5pbmcgdGhlIGxpc3RzLicpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIHRoZSBwYXRoIHRvIHlvdXIgbm90ZScpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm5vdGVQYXRoKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mubm90ZVBhdGggPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiU2hvdyB3YXJuaW5nXCIpXG4gICAgICAgIC5zZXREZXNjKFwiU2hvdyB3YXJuaW5ncyBvZiBOb3RlIGFuZCBsaXN0cywgaWYgcHJlc2VudC5cIilcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XG4gICAgICAgICAgICB0b2dnbGUuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd1dhcm5pbmcpO1xuICAgICAgICAgICAgdG9nZ2xlLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dXYXJuaW5nID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNl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
