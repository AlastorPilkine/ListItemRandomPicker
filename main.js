/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => ListItemRandomPicker
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  notePath: "Full path of a note"
};
var ItemPickerModal = class extends import_obsidian.Modal {
  constructor(app, items, callback) {
    super(app);
    this.items = items;
    this.callback = callback;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.style.display = "flex";
    contentEl.style.flexDirection = "column";
    contentEl.style.height = "100%";
    const selectContainer = contentEl.createDiv();
    selectContainer.style.flexGrow = "1";
    selectContainer.style.display = "flex";
    selectContainer.style.flexDirection = "column";
    selectContainer.style.justifyContent = "center";
    selectContainer.style.alignItems = "center";
    const itemSelect = selectContainer.createEl("select");
    this.items.forEach((item) => {
      itemSelect.createEl("option", { value: item, text: item });
    });
    const buttonContainer = contentEl.createDiv();
    buttonContainer.style.display = "flex";
    buttonContainer.style.justifyContent = "center";
    buttonContainer.style.padding = "10px 0";
    const okButton = buttonContainer.createEl("button", { text: "OK" });
    okButton.addEventListener("click", () => {
      const selectedItem = itemSelect.value;
      this.close();
      this.callback(selectedItem);
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var ListItemRandomPicker = class extends import_obsidian.Plugin {
  async onload() {
    await this.loadSettings();
    this.addRibbonIcon("list-tree", "Pick random list item", (evt) => {
      this.openTitlePicker(this.settings.notePath);
    });
    this.addSettingTab(new LIRPSettingTab(this.app, this));
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async openTitlePicker(notePath) {
    const fullNotePath = notePath + ".md";
    const file = this.app.vault.getAbstractFileByPath(fullNotePath);
    if (!file) {
      new import_obsidian.Notice("Note not found!");
      return;
    }
    if (!(file instanceof import_obsidian.TFile)) {
      new import_obsidian.Notice("Invalid file type. Expected a TFile.");
      return;
    }
    const content = await this.app.vault.read(file);
    const titles = this.getTitlesFromNote(content);
    if (titles.length === 0) {
      new import_obsidian.Notice("No titles found in the note!");
      return;
    }
    new ItemPickerModal(this.app, titles, (title) => {
      this.insertRandomEntry(content, title);
    }).open();
  }
  getTitlesFromNote(content) {
    const titleRegex = /^#+\s+(.+)$/gm;
    const titles = [];
    let match;
    while ((match = titleRegex.exec(content)) !== null) {
      titles.push(match[1]);
    }
    return titles;
  }
  async insertRandomEntry(content, title) {
    const entries = this.getEntriesFromNote(content, title);
    if (entries.length === 0) {
      new import_obsidian.Notice("No entries found for this title!");
      return;
    }
    const randomEntry = entries[Math.floor(Math.random() * entries.length)].replace(/\n/g, "");
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if (activeView) {
      const editor = activeView.editor;
      const selection = editor.getSelection();
      editor.replaceSelection(randomEntry);
    } else {
      new import_obsidian.Notice("No active Markdown editor found.");
    }
  }
  getEntriesFromNote(content, title) {
    const titleRegex = new RegExp(`^#+\\s+${title}$`, "m");
    const titleMatch = titleRegex.exec(content);
    if (!titleMatch) {
      return [];
    }
    const startIndex = titleMatch.index + titleMatch[0].length;
    let endIndex = content.indexOf("\n#", startIndex);
    if (endIndex === -1) {
      endIndex = content.length;
    }
    const listItemRegex = /^(-|\d+\.) +(.+)$/gm;
    const entries = [];
    let currentEntry;
    let currentEntrySplit;
    let repeat;
    let itemString;
    const listContent = content.substring(startIndex, endIndex);
    while ((currentEntry = listItemRegex.exec(listContent)) !== null) {
      let fullString = currentEntry[2];
      const itemWithNumberRegEx = /^\((\d+)\)\s+(.+)$/m;
      if ((currentEntrySplit = itemWithNumberRegEx.exec(fullString)) !== null) {
        repeat = Number(currentEntrySplit[1]);
        itemString = currentEntrySplit[2];
      } else {
        repeat = 1;
        itemString = fullString;
      }
      for (let i = 0; i < repeat; i++) {
        entries.push(itemString);
      }
    }
    return entries;
  }
};
var LIRPSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Note Path").setDesc("Path to the note containing the lists.").addText((text) => text.setPlaceholder("Enter the path to your note").setValue(this.plugin.settings.notePath).onChange(async (value) => {
      this.plugin.settings.notePath = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBNb2RhbCwgTm90aWNlLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFRGaWxlLCBNYXJrZG93blZpZXcgfSBmcm9tICdvYnNpZGlhbic7XG5cbmludGVyZmFjZSBNeVBsdWdpblNldHRpbmdzIHtcbiAgICBub3RlUGF0aDogc3RyaW5nO1xufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBNeVBsdWdpblNldHRpbmdzID0ge1xuICAgIG5vdGVQYXRoOiAnRnVsbCBwYXRoIG9mIGEgbm90ZSdcbn07XG5cbmNsYXNzIEl0ZW1QaWNrZXJNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBpdGVtczogc3RyaW5nW107XG4gICAgY2FsbGJhY2s6IChpdGVtOiBzdHJpbmcpID0+IHZvaWQ7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgaXRlbXM6IHN0cmluZ1tdLCBjYWxsYmFjazogKGl0ZW06IHN0cmluZykgPT4gdm9pZCkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLml0ZW1zID0gaXRlbXM7XG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXG4gICAgICAgIC8vIENvbmZpZ3VyYXRpb24gZHUgY29udGVuZXVyIEZsZXhib3hcbiAgICAgICAgY29udGVudEVsLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XG4gICAgICAgIGNvbnRlbnRFbC5zdHlsZS5mbGV4RGlyZWN0aW9uID0gJ2NvbHVtbic7XG4gICAgICAgIGNvbnRlbnRFbC5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7IC8vIEFzc3VyZXotdm91cyBxdWUgbGUgY29udGVuZXVyIHByZW5kIHRvdXRlIGxhIGhhdXRldXJcblxuICAgICAgICAvLyBDb250ZW5ldXIgcG91ciBsZSBzXHUwMEU5bGVjdGV1ciAocHJlbmRyYSBsJ2VzcGFjZSByZXN0YW50KVxuICAgICAgICBjb25zdCBzZWxlY3RDb250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIHNlbGVjdENvbnRhaW5lci5zdHlsZS5mbGV4R3JvdyA9ICcxJzsgLy8gUHJlbmQgbCdlc3BhY2UgZGlzcG9uaWJsZVxuICAgICAgICBzZWxlY3RDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICAgICAgc2VsZWN0Q29udGFpbmVyLnN0eWxlLmZsZXhEaXJlY3Rpb24gPSAnY29sdW1uJztcbiAgICAgICAgc2VsZWN0Q29udGFpbmVyLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ2NlbnRlcic7IC8vIENlbnRyZSB2ZXJ0aWNhbGVtZW50IGxlIHNlbGVjdFxuICAgICAgICBzZWxlY3RDb250YWluZXIuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInOyAvLyBDZW50cmUgaG9yaXpvbnRhbGVtZW50IGxlIHNlbGVjdFxuXG4gICAgICAgIGNvbnN0IGl0ZW1TZWxlY3QgPSBzZWxlY3RDb250YWluZXIuY3JlYXRlRWwoJ3NlbGVjdCcpO1xuICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICBpdGVtU2VsZWN0LmNyZWF0ZUVsKCdvcHRpb24nLCB7IHZhbHVlOiBpdGVtLCB0ZXh0OiBpdGVtIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDb250ZW5ldXIgcG91ciBsZSBib3V0b24gKGVuIGJhcywgY2VudHJcdTAwRTkpXG4gICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgYnV0dG9uQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XG4gICAgICAgIGJ1dHRvbkNvbnRhaW5lci5zdHlsZS5qdXN0aWZ5Q29udGVudCA9ICdjZW50ZXInOyAvLyBDZW50cmUgaG9yaXpvbnRhbGVtZW50IGxlIGJvdXRvblxuICAgICAgICBidXR0b25Db250YWluZXIuc3R5bGUucGFkZGluZyA9ICcxMHB4IDAnOyAvLyBBam91dGUgdW4gcGV1IGQnZXNwYWNlIGF1dG91ciBkdSBib3V0b25cblxuICAgICAgICBjb25zdCBva0J1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnT0snIH0pO1xuICAgICAgICBva0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkSXRlbSA9IGl0ZW1TZWxlY3QudmFsdWU7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrKHNlbGVjdGVkSXRlbSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uQ2xvc2UoKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIExpc3RJdGVtUmFuZG9tUGlja2VyIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBzZXR0aW5nczogTXlQbHVnaW5TZXR0aW5ncztcblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuICAgICAgICB0aGlzLmFkZFJpYmJvbkljb24oJ2xpc3QtdHJlZScsICdQaWNrIHJhbmRvbSBsaXN0IGl0ZW0nLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9wZW5UaXRsZVBpY2tlcih0aGlzLnNldHRpbmdzLm5vdGVQYXRoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBMSVJQU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuICAgIH1cblxuICAgIG9udW5sb2FkKCkge1xuXG4gICAgfVxuXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgYXN5bmMgb3BlblRpdGxlUGlja2VyKG5vdGVQYXRoOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgZnVsbE5vdGVQYXRoID0gbm90ZVBhdGggKyAnLm1kJztcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmdWxsTm90ZVBhdGgpO1xuXG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnTm90ZSBub3QgZm91bmQhJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdJbnZhbGlkIGZpbGUgdHlwZS4gRXhwZWN0ZWQgYSBURmlsZS4nKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICAgICAgICBjb25zdCB0aXRsZXMgPSB0aGlzLmdldFRpdGxlc0Zyb21Ob3RlKGNvbnRlbnQpO1xuXG4gICAgICAgIGlmICh0aXRsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdObyB0aXRsZXMgZm91bmQgaW4gdGhlIG5vdGUhJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBuZXcgSXRlbVBpY2tlck1vZGFsKHRoaXMuYXBwLCB0aXRsZXMsICh0aXRsZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5pbnNlcnRSYW5kb21FbnRyeShjb250ZW50LCB0aXRsZSk7XG4gICAgICAgIH0pLm9wZW4oKTtcbiAgICB9XG5cbiAgICBnZXRUaXRsZXNGcm9tTm90ZShjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHRpdGxlUmVnZXggPSAvXiMrXFxzKyguKykkL2dtO1xuICAgICAgICBjb25zdCB0aXRsZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGxldCBtYXRjaDtcbiAgICAgICAgd2hpbGUgKChtYXRjaCA9IHRpdGxlUmVnZXguZXhlYyhjb250ZW50KSkgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHRpdGxlcy5wdXNoKG1hdGNoWzFdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGl0bGVzO1xuICAgIH1cblxuICAgIGFzeW5jIGluc2VydFJhbmRvbUVudHJ5KGNvbnRlbnQ6IHN0cmluZywgdGl0bGU6IHN0cmluZykge1xuXG4gICAgICAgIGNvbnN0IGVudHJpZXMgPSB0aGlzLmdldEVudHJpZXNGcm9tTm90ZShjb250ZW50LCB0aXRsZSk7XG5cbiAgICAgICAgaWYgKGVudHJpZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdObyBlbnRyaWVzIGZvdW5kIGZvciB0aGlzIHRpdGxlIScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJhbmRvbUVudHJ5ID0gZW50cmllc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBlbnRyaWVzLmxlbmd0aCldLnJlcGxhY2UoL1xcbi9nLCAnJyk7XG4gICAgICAgIC8vIGNvbnN0IHJhbmRvbUVudHJ5ID0gZW50cmllc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBlbnRyaWVzLmxlbmd0aCldLnRyaW0oKTtcblxuICAgICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblxuICAgICAgICBpZiAoYWN0aXZlVmlldykge1xuICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gYWN0aXZlVmlldy5lZGl0b3I7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVNlbGVjdGlvbihyYW5kb21FbnRyeSk7XG4gICAgICAgICAgICAvLyBjb25zdCBwb3NpdGlvbiA9IGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICAgICAgICAgIC8vIGVkaXRvci5yZXBsYWNlUmFuZ2UocmFuZG9tRW50cnksIHBvc2l0aW9uKTsgLy8sIHBvc2l0aW9uKTtcblxuICAgICAgICAgICAgLy8gLy8gRFx1MDBFOXBsYWNlciBsZSBjdXJzZXVyIFx1MDBFMCBsYSBmaW4gZGUgbCdpbnNlcnRpb25cbiAgICAgICAgICAgIC8vIGNvbnN0IG5ld1Bvc2l0aW9uID0geyBsaW5lOiBwb3NpdGlvbi5saW5lLCBjaDogcG9zaXRpb24uY2ggKyByYW5kb21FbnRyeS5sZW5ndGggfTtcbiAgICAgICAgICAgIC8vIGVkaXRvci5zZXRDdXJzb3IobmV3UG9zaXRpb24pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3IE5vdGljZShcIk5vIGFjdGl2ZSBNYXJrZG93biBlZGl0b3IgZm91bmQuXCIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0RW50cmllc0Zyb21Ob3RlKGNvbnRlbnQ6IHN0cmluZywgdGl0bGU6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgdGl0bGVSZWdleCA9IG5ldyBSZWdFeHAoYF4jK1xcXFxzKyR7dGl0bGV9JGAsICdtJyk7XG4gICAgICAgIGNvbnN0IHRpdGxlTWF0Y2ggPSB0aXRsZVJlZ2V4LmV4ZWMoY29udGVudCk7XG5cbiAgICAgICAgaWYgKCF0aXRsZU1hdGNoKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzdGFydEluZGV4ID0gdGl0bGVNYXRjaC5pbmRleCArIHRpdGxlTWF0Y2hbMF0ubGVuZ3RoO1xuICAgICAgICBsZXQgZW5kSW5kZXggPSBjb250ZW50LmluZGV4T2YoJ1xcbiMnLCBzdGFydEluZGV4KTtcbiAgICAgICAgaWYgKGVuZEluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgZW5kSW5kZXggPSBjb250ZW50Lmxlbmd0aDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGxpc3RJdGVtUmVnZXggPSAvXigtfFxcZCtcXC4pICsoLispJC9nbTtcbiAgICAgICAgY29uc3QgZW50cmllczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgbGV0IGN1cnJlbnRFbnRyeTtcbiAgICAgICAgbGV0IGN1cnJlbnRFbnRyeVNwbGl0O1xuICAgICAgICBsZXQgcmVwZWF0OiBudW1iZXI7XG4gICAgICAgIGxldCBpdGVtU3RyaW5nOiBzdHJpbmc7XG4gICAgICAgIGNvbnN0IGxpc3RDb250ZW50ID0gY29udGVudC5zdWJzdHJpbmcoc3RhcnRJbmRleCwgZW5kSW5kZXgpO1xuICAgICAgICB3aGlsZSAoKGN1cnJlbnRFbnRyeSA9IGxpc3RJdGVtUmVnZXguZXhlYyhsaXN0Q29udGVudCkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICBsZXQgZnVsbFN0cmluZyA9IGN1cnJlbnRFbnRyeVsyXTtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1XaXRoTnVtYmVyUmVnRXggPSAvXlxcKChcXGQrKVxcKVxccysoLispJC9tO1xuICAgICAgICAgICAgaWYgKChjdXJyZW50RW50cnlTcGxpdCA9IGl0ZW1XaXRoTnVtYmVyUmVnRXguZXhlYyhmdWxsU3RyaW5nKSkgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXBlYXQgPSBOdW1iZXIoY3VycmVudEVudHJ5U3BsaXRbMV0pO1xuICAgICAgICAgICAgICAgIGl0ZW1TdHJpbmcgPSBjdXJyZW50RW50cnlTcGxpdFsyXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVwZWF0ID0gMTtcbiAgICAgICAgICAgICAgICBpdGVtU3RyaW5nID0gZnVsbFN0cmluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVwZWF0OyBpKyspIHtcbiAgICAgICAgICAgICAgICBlbnRyaWVzLnB1c2goaXRlbVN0cmluZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVudHJpZXM7XG4gICAgfVxufVxuXG5jbGFzcyBMSVJQU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHBsdWdpbjogTGlzdEl0ZW1SYW5kb21QaWNrZXI7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBMaXN0SXRlbVJhbmRvbVBpY2tlcikge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcblxuICAgICAgICAvLyBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdTZXR0aW5ncyBmb3IgTGlzdCBJdGVtIFJhbmRvbSBQaWNrZXIuJyB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdOb3RlIFBhdGgnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1BhdGggdG8gdGhlIG5vdGUgY29udGFpbmluZyB0aGUgbGlzdHMuJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignRW50ZXIgdGhlIHBhdGggdG8geW91ciBub3RlJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mubm90ZVBhdGgpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5ub3RlUGF0aCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgfVxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBMkY7QUFNM0YsSUFBTSxtQkFBcUM7QUFBQSxFQUN2QyxVQUFVO0FBQ2Q7QUFFQSxJQUFNLGtCQUFOLGNBQThCLHNCQUFNO0FBQUEsRUFJaEMsWUFBWSxLQUFVLE9BQWlCLFVBQWtDO0FBQ3JFLFVBQU0sR0FBRztBQUNULFNBQUssUUFBUTtBQUNiLFNBQUssV0FBVztBQUFBLEVBQ3BCO0FBQUEsRUFFQSxTQUFTO0FBQ0wsVUFBTSxFQUFFLFVBQVUsSUFBSTtBQUd0QixjQUFVLE1BQU0sVUFBVTtBQUMxQixjQUFVLE1BQU0sZ0JBQWdCO0FBQ2hDLGNBQVUsTUFBTSxTQUFTO0FBR3pCLFVBQU0sa0JBQWtCLFVBQVUsVUFBVTtBQUM1QyxvQkFBZ0IsTUFBTSxXQUFXO0FBQ2pDLG9CQUFnQixNQUFNLFVBQVU7QUFDaEMsb0JBQWdCLE1BQU0sZ0JBQWdCO0FBQ3RDLG9CQUFnQixNQUFNLGlCQUFpQjtBQUN2QyxvQkFBZ0IsTUFBTSxhQUFhO0FBRW5DLFVBQU0sYUFBYSxnQkFBZ0IsU0FBUyxRQUFRO0FBQ3BELFNBQUssTUFBTSxRQUFRLFVBQVE7QUFDdkIsaUJBQVcsU0FBUyxVQUFVLEVBQUUsT0FBTyxNQUFNLE1BQU0sS0FBSyxDQUFDO0FBQUEsSUFDN0QsQ0FBQztBQUdE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QUF5QjtBQUN6RCxVQUFNLGFBQWEsSUFBSSxPQUFPLFVBQVUsVUFBVSxHQUFHO0FBQ3JELFVBQU0sYUFBYSxXQUFXLEtBQUssT0FBTztBQUUxQyxRQUFJLENBQUMsWUFBWTtBQUNiLGFBQU8sQ0FBQztBQUFBLElBQ1o7QUFFQSxVQUFNLGFBQWEsV0FBVyxRQUFRLFdBQVcsQ0FBQyxFQUFFO0FBQ3BELFFBQUksV0FBVyxRQUFRLFFBQVEsT0FBTyxVQUFVO0FBQ2hELFFBQUksYUFBYSxJQUFJO0FBQ2pCLGlCQUFXLFFBQVE7QUFBQSxJQUN2QjtBQUVBLFVBQU0sZ0JBQWdCO0FBQ3RCLFVBQU0sVUFBb0IsQ0FBQztBQUMzQixRQUFJO0FBQ0osUUFBSTtBQUNKLFFBQUk7QUFDSixRQUFJO0FBQ0osVUFBTSxjQUFjLFFBQVEsVUFBVSxZQUFZLFFBQVE7QUFDMUQsWUFBUSxlQUFlLGNBQWMsS0FBSyxXQUFXLE9BQU8sTUFBTTtBQUM5RCxVQUFJLGFBQWEsYUFBYSxDQUFDO0FBQy9CLFlBQU0sc0JBQXNCO0FBQzVCLFdBQUssb0JBQW9CLG9CQUFvQixLQUFLLFVBQVUsT0FBTyxNQUFNO0FBQ3JFLGlCQUFTLE9BQU8sa0JBQWtCLENBQUMsQ0FBQztBQUNwQyxxQkFBYSxrQkFBa0IsQ0FBQztBQUFBLE1BQ3BDLE9BQU87QUFDSCxpQkFBUztBQUNULHFCQUFhO0FBQUEsTUFDakI7QUFDQSxlQUFTLElBQUksR0FBRyxJQUFJLFFBQVEsS0FBSztBQUM3QixnQkFBUSxLQUFLLFVBQVU7QUFBQSxNQUMzQjtBQUFBLElBQ0o7QUFDQSxXQUFPO0FBQUEsRUFDWDtBQUNKO0FBRUEsSUFBTSxpQkFBTixjQUE2QixpQ0FBaUI7QUFBQSxFQUcxQyxZQUFZLEtBQVUsUUFBOEI7QUFDaEQsVUFBTSxLQUFLLE1BQU07QUFDakIsU0FBSyxTQUFTO0FBQUEsRUFDbEI7QUFBQSxFQUVBLFVBQWdCO0FBQ1osVUFBTSxFQUFFLFlBQVksSUFBSTtBQUV4QixnQkFBWSxNQUFNO0FBSWxCLFFBQUksd0JBQVEsV0FBVyxFQUNsQixRQUFRLFdBQVcsRUFDbkIsUUFBUSx3Q0FBd0MsRUFDaEQsUUFBUSxVQUFRLEtBQ1osZUFBZSw2QkFBNkIsRUFDNUMsU0FBUyxLQUFLLE9BQU8sU0FBUyxRQUFRLEVBQ3RDLFNBQVMsT0FBTyxVQUFVO0FBQ3ZCLFdBQUssT0FBTyxTQUFTLFdBQVc7QUFDaEMsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ25DLENBQUMsQ0FBQztBQUFBLEVBQ2Q7QUFDSjsiLAogICJuYW1lcyI6IFtdCn0K
