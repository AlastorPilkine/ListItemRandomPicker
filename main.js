/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => listItemRandomPicker
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  notePath: "Example Note"
};
var TitlePickerModal = class extends import_obsidian.Modal {
  constructor(app, titles, callback) {
    super(app);
    this.titles = titles;
    this.callback = callback;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.style.display = "flex";
    contentEl.style.flexDirection = "column";
    contentEl.style.height = "100%";
    const selectContainer = contentEl.createDiv();
    selectContainer.style.flexGrow = "1";
    selectContainer.style.display = "flex";
    selectContainer.style.flexDirection = "column";
    selectContainer.style.justifyContent = "center";
    selectContainer.style.alignItems = "center";
    const titleSelect = selectContainer.createEl("select");
    this.titles.forEach((title) => {
      titleSelect.createEl("option", { value: title, text: title });
    });
    const buttonContainer = contentEl.createDiv();
    buttonContainer.style.display = "flex";
    buttonContainer.style.justifyContent = "center";
    buttonContainer.style.padding = "10px 0";
    const okButton = buttonContainer.createEl("button", { text: "OK" });
    okButton.addEventListener("click", () => {
      const selectedTitle = titleSelect.value;
      this.close();
      this.callback(selectedTitle);
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var listItemRandomPicker = class extends import_obsidian.Plugin {
  async onload() {
    await this.loadSettings();
    this.addRibbonIcon("list-tree", "Pick Random Entry", (evt) => {
      this.openTitlePicker();
    });
    this.addSettingTab(new SampleSettingTab(this.app, this));
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async openTitlePicker() {
    const notePath = this.settings.notePath + ".md";
    const file = this.app.vault.getAbstractFileByPath(notePath);
    if (!file) {
      new import_obsidian.Notice("Note not found!");
      return;
    }
    if (!(file instanceof import_obsidian.TFile)) {
      new import_obsidian.Notice("Invalid file type. Expected a TFile.");
      return;
    }
    const content = await this.app.vault.read(file);
    const titles = this.getTitlesFromNote(content);
    if (titles.length === 0) {
      new import_obsidian.Notice("No titles found in the note!");
      return;
    }
    new TitlePickerModal(this.app, titles, (title) => {
      this.insertRandomEntry(notePath, title);
    }).open();
  }
  getTitlesFromNote(content) {
    const titleRegex = /^#+\s+(.+)$/gm;
    const titles = [];
    let match;
    while ((match = titleRegex.exec(content)) !== null) {
      titles.push(match[1]);
    }
    return titles;
  }
  async insertRandomEntry(notePath, title) {
    const file = this.app.vault.getAbstractFileByPath(notePath);
    if (!file) {
      new import_obsidian.Notice("Note not found!");
      return;
    }
    if (!(file instanceof import_obsidian.TFile)) {
      new import_obsidian.Notice("Invalid file type. Expected a TFile.");
      return;
    }
    const content = await this.app.vault.read(file);
    const entries = this.getEntriesFromNote(content, title);
    if (entries.length === 0) {
      new import_obsidian.Notice("No entries found for this title!");
      return;
    }
    const randomEntry = entries[Math.floor(Math.random() * entries.length)].replace(/\n/g, "");
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if (activeView) {
      const editor = activeView.editor;
      const position = editor.getCursor();
      editor.replaceRange(randomEntry, position, position);
      const newPosition = { line: position.line, ch: position.ch + randomEntry.length };
      editor.setCursor(newPosition);
    } else {
      new import_obsidian.Notice("No active Markdown editor found.");
    }
  }
  getEntriesFromNote(content, title) {
    const titleRegex = new RegExp(`^#+\\s+${title}$`, "m");
    const titleMatch = titleRegex.exec(content);
    if (!titleMatch) {
      return [];
    }
    const startIndex = titleMatch.index + titleMatch[0].length;
    let endIndex = content.indexOf("\n#", startIndex);
    if (endIndex === -1) {
      endIndex = content.length;
    }
    const listItemRegex = /^(-|\d+\.) +(.+)$/gm;
    const entries = [];
    let currentEntry;
    let currentEntrySplit;
    let repeat;
    let itemString;
    const listContent = content.substring(startIndex, endIndex);
    while ((currentEntry = listItemRegex.exec(listContent)) !== null) {
      let fullString = currentEntry[2];
      const ItemWithNumberRegEx = /^\((\d+)\)\s+(.+)$/m;
      if ((currentEntrySplit = ItemWithNumberRegEx.exec(fullString)) !== null) {
        repeat = Number(currentEntrySplit[1]);
        itemString = currentEntrySplit[2];
      } else {
        repeat = 1;
        itemString = fullString;
      }
      for (let i = 0; i < repeat; i++) {
        entries.push(itemString);
      }
    }
    return entries;
  }
};
var SampleSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Settings for List Item Random Picker." });
    new import_obsidian.Setting(containerEl).setName("Note Path").setDesc("Path to the note containing the entries.").addText((text) => text.setPlaceholder("Enter the path to your note").setValue(this.plugin.settings.notePath).onChange(async (value) => {
      this.plugin.settings.notePath = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBNb2RhbCwgTm90aWNlLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFRGaWxlLCBFZGl0b3IsIE1hcmtkb3duVmlldyB9IGZyb20gJ29ic2lkaWFuJztcblxuaW50ZXJmYWNlIE15UGx1Z2luU2V0dGluZ3Mge1xuICAgIG5vdGVQYXRoOiBzdHJpbmc7XG59XG5cbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IE15UGx1Z2luU2V0dGluZ3MgPSB7XG4gICAgbm90ZVBhdGg6ICdFeGFtcGxlIE5vdGUnXG59O1xuXG5jbGFzcyBUaXRsZVBpY2tlck1vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHRpdGxlczogc3RyaW5nW107XG4gICAgY2FsbGJhY2s6ICh0aXRsZTogc3RyaW5nKSA9PiB2b2lkO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHRpdGxlczogc3RyaW5nW10sIGNhbGxiYWNrOiAodGl0bGU6IHN0cmluZykgPT4gdm9pZCkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLnRpdGxlcyA9IHRpdGxlcztcbiAgICAgICAgdGhpcy5jYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH1cblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG5cbiAgICAgICAgLy8gQ29uZmlndXJhdGlvbiBkdSBjb250ZW5ldXIgRmxleGJveFxuICAgICAgICBjb250ZW50RWwuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICAgICAgY29udGVudEVsLnN0eWxlLmZsZXhEaXJlY3Rpb24gPSAnY29sdW1uJztcbiAgICAgICAgY29udGVudEVsLnN0eWxlLmhlaWdodCA9ICcxMDAlJzsgLy8gQXNzdXJlei12b3VzIHF1ZSBsZSBjb250ZW5ldXIgcHJlbmQgdG91dGUgbGEgaGF1dGV1clxuXG4gICAgICAgIC8vIENvbnRlbmV1ciBwb3VyIGxlIHNcdTAwRTlsZWN0ZXVyIChwcmVuZHJhIGwnZXNwYWNlIHJlc3RhbnQpXG4gICAgICAgIGNvbnN0IHNlbGVjdENvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgc2VsZWN0Q29udGFpbmVyLnN0eWxlLmZsZXhHcm93ID0gJzEnOyAvLyBQcmVuZCBsJ2VzcGFjZSBkaXNwb25pYmxlXG4gICAgICAgIHNlbGVjdENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgICAgICBzZWxlY3RDb250YWluZXIuc3R5bGUuZmxleERpcmVjdGlvbiA9ICdjb2x1bW4nO1xuICAgICAgICBzZWxlY3RDb250YWluZXIuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnY2VudGVyJzsgLy8gQ2VudHJlIHZlcnRpY2FsZW1lbnQgbGUgc2VsZWN0XG4gICAgICAgIHNlbGVjdENvbnRhaW5lci5zdHlsZS5hbGlnbkl0ZW1zID0gJ2NlbnRlcic7IC8vIENlbnRyZSBob3Jpem9udGFsZW1lbnQgbGUgc2VsZWN0XG5cbiAgICAgICAgY29uc3QgdGl0bGVTZWxlY3QgPSBzZWxlY3RDb250YWluZXIuY3JlYXRlRWwoJ3NlbGVjdCcpO1xuICAgICAgICB0aGlzLnRpdGxlcy5mb3JFYWNoKHRpdGxlID0+IHtcbiAgICAgICAgICAgIHRpdGxlU2VsZWN0LmNyZWF0ZUVsKCdvcHRpb24nLCB7IHZhbHVlOiB0aXRsZSwgdGV4dDogdGl0bGUgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENvbnRlbmV1ciBwb3VyIGxlIGJvdXRvbiAoZW4gYmFzLCBjZW50clx1MDBFOSlcbiAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICBidXR0b25Db250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICAgICAgYnV0dG9uQ29udGFpbmVyLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ2NlbnRlcic7IC8vIENlbnRyZSBob3Jpem9udGFsZW1lbnQgbGUgYm91dG9uXG4gICAgICAgIGJ1dHRvbkNvbnRhaW5lci5zdHlsZS5wYWRkaW5nID0gJzEwcHggMCc7IC8vIEFqb3V0ZSB1biBwZXUgZCdlc3BhY2UgYXV0b3VyIGR1IGJvdXRvblxuXG4gICAgICAgIGNvbnN0IG9rQnV0dG9uID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdPSycgfSk7XG4gICAgICAgIG9rQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRUaXRsZSA9IHRpdGxlU2VsZWN0LnZhbHVlO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5jYWxsYmFjayhzZWxlY3RlZFRpdGxlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgbGlzdEl0ZW1SYW5kb21QaWNrZXIgZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzOiBNeVBsdWdpblNldHRpbmdzO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXG4gICAgICAgIHRoaXMuYWRkUmliYm9uSWNvbignbGlzdC10cmVlJywgJ1BpY2sgUmFuZG9tIEVudHJ5JywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5vcGVuVGl0bGVQaWNrZXIoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBTYW1wbGVTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG5cbiAgICB9XG5cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBhc3luYyBvcGVuVGl0bGVQaWNrZXIoKSB7XG4gICAgICAgIGNvbnN0IG5vdGVQYXRoID0gdGhpcy5zZXR0aW5ncy5ub3RlUGF0aCArICcubWQnO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5vdGVQYXRoKTtcblxuICAgICAgICBpZiAoIWZpbGUpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vdGUgbm90IGZvdW5kIScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnSW52YWxpZCBmaWxlIHR5cGUuIEV4cGVjdGVkIGEgVEZpbGUuJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgY29uc3QgdGl0bGVzID0gdGhpcy5nZXRUaXRsZXNGcm9tTm90ZShjb250ZW50KTtcblxuICAgICAgICBpZiAodGl0bGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnTm8gdGl0bGVzIGZvdW5kIGluIHRoZSBub3RlIScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbmV3IFRpdGxlUGlja2VyTW9kYWwodGhpcy5hcHAsIHRpdGxlcywgKHRpdGxlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmluc2VydFJhbmRvbUVudHJ5KG5vdGVQYXRoLCB0aXRsZSk7XG4gICAgICAgIH0pLm9wZW4oKTtcbiAgICB9XG5cbiAgICBnZXRUaXRsZXNGcm9tTm90ZShjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHRpdGxlUmVnZXggPSAvXiMrXFxzKyguKykkL2dtO1xuICAgICAgICBjb25zdCB0aXRsZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGxldCBtYXRjaDtcbiAgICAgICAgd2hpbGUgKChtYXRjaCA9IHRpdGxlUmVnZXguZXhlYyhjb250ZW50KSkgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHRpdGxlcy5wdXNoKG1hdGNoWzFdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGl0bGVzO1xuICAgIH1cblxuICAgIGFzeW5jIGluc2VydFJhbmRvbUVudHJ5KG5vdGVQYXRoOiBzdHJpbmcsIHRpdGxlOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChub3RlUGF0aCk7XG5cbiAgICAgICAgaWYgKCFmaWxlKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdOb3RlIG5vdCBmb3VuZCEnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0ludmFsaWQgZmlsZSB0eXBlLiBFeHBlY3RlZCBhIFRGaWxlLicpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgIGNvbnN0IGVudHJpZXMgPSB0aGlzLmdldEVudHJpZXNGcm9tTm90ZShjb250ZW50LCB0aXRsZSk7XG5cbiAgICAgICAgaWYgKGVudHJpZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdObyBlbnRyaWVzIGZvdW5kIGZvciB0aGlzIHRpdGxlIScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJhbmRvbUVudHJ5ID0gZW50cmllc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBlbnRyaWVzLmxlbmd0aCldLnJlcGxhY2UoL1xcbi9nLCAnJyk7XG4gICAgICAgIC8vIGNvbnN0IHJhbmRvbUVudHJ5ID0gZW50cmllc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBlbnRyaWVzLmxlbmd0aCldLnRyaW0oKTtcblxuICAgICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblxuICAgICAgICBpZiAoYWN0aXZlVmlldykge1xuICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gYWN0aXZlVmlldy5lZGl0b3I7XG4gICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UocmFuZG9tRW50cnksIHBvc2l0aW9uLCBwb3NpdGlvbik7XG5cbiAgICAgICAgICAgIC8vIERcdTAwRTlwbGFjZXIgbGUgY3Vyc2V1ciBcdTAwRTAgbGEgZmluIGRlIGwnaW5zZXJ0aW9uXG4gICAgICAgICAgICBjb25zdCBuZXdQb3NpdGlvbiA9IHsgbGluZTogcG9zaXRpb24ubGluZSwgY2g6IHBvc2l0aW9uLmNoICsgcmFuZG9tRW50cnkubGVuZ3RoIH07XG4gICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKG5ld1Bvc2l0aW9uKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJObyBhY3RpdmUgTWFya2Rvd24gZWRpdG9yIGZvdW5kLlwiKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldEVudHJpZXNGcm9tTm90ZShjb250ZW50OiBzdHJpbmcsIHRpdGxlOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHRpdGxlUmVnZXggPSBuZXcgUmVnRXhwKGBeIytcXFxccyske3RpdGxlfSRgLCAnbScpO1xuICAgICAgICBjb25zdCB0aXRsZU1hdGNoID0gdGl0bGVSZWdleC5leGVjKGNvbnRlbnQpO1xuXG4gICAgICAgIGlmICghdGl0bGVNYXRjaCkge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IHRpdGxlTWF0Y2guaW5kZXggKyB0aXRsZU1hdGNoWzBdLmxlbmd0aDtcbiAgICAgICAgbGV0IGVuZEluZGV4ID0gY29udGVudC5pbmRleE9mKCdcXG4jJywgc3RhcnRJbmRleCk7XG4gICAgICAgIGlmIChlbmRJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgIGVuZEluZGV4ID0gY29udGVudC5sZW5ndGg7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBsaXN0SXRlbVJlZ2V4ID0gL14oLXxcXGQrXFwuKSArKC4rKSQvZ207XG4gICAgICAgIGNvbnN0IGVudHJpZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGxldCBjdXJyZW50RW50cnk7XG4gICAgICAgIGxldCBjdXJyZW50RW50cnlTcGxpdDtcbiAgICAgICAgbGV0IHJlcGVhdDogbnVtYmVyO1xuICAgICAgICBsZXQgaXRlbVN0cmluZzogc3RyaW5nO1xuICAgICAgICBjb25zdCBsaXN0Q29udGVudCA9IGNvbnRlbnQuc3Vic3RyaW5nKHN0YXJ0SW5kZXgsIGVuZEluZGV4KTtcbiAgICAgICAgd2hpbGUgKChjdXJyZW50RW50cnkgPSBsaXN0SXRlbVJlZ2V4LmV4ZWMobGlzdENvbnRlbnQpKSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgbGV0IGZ1bGxTdHJpbmcgPSBjdXJyZW50RW50cnlbMl07XG4gICAgICAgICAgICBjb25zdCBJdGVtV2l0aE51bWJlclJlZ0V4ID0gL15cXCgoXFxkKylcXClcXHMrKC4rKSQvbTtcbiAgICAgICAgICAgIGlmICgoY3VycmVudEVudHJ5U3BsaXQgPSBJdGVtV2l0aE51bWJlclJlZ0V4LmV4ZWMoZnVsbFN0cmluZykpICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmVwZWF0ID0gTnVtYmVyKGN1cnJlbnRFbnRyeVNwbGl0WzFdKTtcbiAgICAgICAgICAgICAgICBpdGVtU3RyaW5nID0gY3VycmVudEVudHJ5U3BsaXRbMl07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcGVhdCA9IDE7XG4gICAgICAgICAgICAgICAgaXRlbVN0cmluZyA9IGZ1bGxTdHJpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlcGVhdDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZW50cmllcy5wdXNoKGl0ZW1TdHJpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbnRyaWVzO1xuICAgIH1cbn1cblxuY2xhc3MgU2FtcGxlU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHBsdWdpbjogbGlzdEl0ZW1SYW5kb21QaWNrZXI7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBsaXN0SXRlbVJhbmRvbVBpY2tlcikge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcblxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdTZXR0aW5ncyBmb3IgTGlzdCBJdGVtIFJhbmRvbSBQaWNrZXIuJyB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdOb3RlIFBhdGgnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1BhdGggdG8gdGhlIG5vdGUgY29udGFpbmluZyB0aGUgZW50cmllcy4nKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdFbnRlciB0aGUgcGF0aCB0byB5b3VyIG5vdGUnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5ub3RlUGF0aClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm5vdGVQYXRoID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICB9XG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHNCQUFtRztBQU1uRyxJQUFNLG1CQUFxQztBQUFBLEVBQ3ZDLFVBQVU7QUFDZDtBQUVBLElBQU0sbUJBQU4sY0FBK0Isc0JBQU07QUFBQSxFQUlqQyxZQUFZLEtBQVUsUUFBa0IsVUFBbUM7QUFDdkUsVUFBTSxHQUFHO0FBQ1QsU0FBSyxTQUFTO0FBQ2QsU0FBSyxXQUFXO0FBQUEsRUFDcEI7QUFBQSxFQUVBLFNBQVM7QUFDTCxVQUFNLEVBQUUsVUFBVSxJQUFJO0FBR3RCLGNBQVUsTUFBTSxVQUFVO0FBQzFCLGNBQVUsTUFBTSxnQkFBZ0I7QUFDaEMsY0FBVSxNQUFNLFNBQVM7QUFHekIsVUFBTSxrQkFBa0IsVUFBVSxVQUFVO0FBQzVDLG9CQUFnQixNQUFNLFdB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
