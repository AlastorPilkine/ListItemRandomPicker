/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => ListItemRandomPicker
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  notePath: "Example Note"
};
var ItemPickerModal = class extends import_obsidian.Modal {
  constructor(app, items, callback) {
    super(app);
    this.items = items;
    this.callback = callback;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.style.display = "flex";
    contentEl.style.flexDirection = "column";
    contentEl.style.height = "100%";
    const selectContainer = contentEl.createDiv();
    selectContainer.style.flexGrow = "1";
    selectContainer.style.display = "flex";
    selectContainer.style.flexDirection = "column";
    selectContainer.style.justifyContent = "center";
    selectContainer.style.alignItems = "center";
    const itemSelect = selectContainer.createEl("select");
    this.items.forEach((item) => {
      itemSelect.createEl("option", { value: item, text: item });
    });
    const buttonContainer = contentEl.createDiv();
    buttonContainer.style.display = "flex";
    buttonContainer.style.justifyContent = "center";
    buttonContainer.style.padding = "10px 0";
    const okButton = buttonContainer.createEl("button", { text: "OK" });
    okButton.addEventListener("click", () => {
      const selectedItem = itemSelect.value;
      this.close();
      this.callback(selectedItem);
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var ListItemRandomPicker = class extends import_obsidian.Plugin {
  async onload() {
    await this.loadSettings();
    this.addRibbonIcon("list-tree", "Pick Random Entry", (evt) => {
      this.openTitlePicker(this.settings.notePath);
    });
    this.addSettingTab(new SampleSettingTab(this.app, this));
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async openTitlePicker(notePath) {
    const fullnotePath = notePath + ".md";
    const file = this.app.vault.getAbstractFileByPath(fullnotePath);
    if (!file) {
      new import_obsidian.Notice("Note not found!");
      return;
    }
    if (!(file instanceof import_obsidian.TFile)) {
      new import_obsidian.Notice("Invalid file type. Expected a TFile.");
      return;
    }
    const content = await this.app.vault.read(file);
    const titles = this.getTitlesFromNote(content);
    if (titles.length === 0) {
      new import_obsidian.Notice("No titles found in the note!");
      return;
    }
    new ItemPickerModal(this.app, titles, (title) => {
      this.insertRandomEntry(fullnotePath, title);
    }).open();
  }
  getTitlesFromNote(content) {
    const titleRegex = /^#+\s+(.+)$/gm;
    const titles = [];
    let match;
    while ((match = titleRegex.exec(content)) !== null) {
      titles.push(match[1]);
    }
    return titles;
  }
  async insertRandomEntry(notePath, title) {
    const file = this.app.vault.getAbstractFileByPath(notePath);
    if (!file) {
      new import_obsidian.Notice("Note not found!");
      return;
    }
    if (!(file instanceof import_obsidian.TFile)) {
      new import_obsidian.Notice("Invalid file type. Expected a TFile.");
      return;
    }
    const content = await this.app.vault.read(file);
    const entries = this.getEntriesFromNote(content, title);
    if (entries.length === 0) {
      new import_obsidian.Notice("No entries found for this title!");
      return;
    }
    const randomEntry = entries[Math.floor(Math.random() * entries.length)].replace(/\n/g, "");
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if (activeView) {
      const editor = activeView.editor;
      const position = editor.getCursor();
      editor.replaceRange(randomEntry, position, position);
      const newPosition = { line: position.line, ch: position.ch + randomEntry.length };
      editor.setCursor(newPosition);
    } else {
      new import_obsidian.Notice("No active Markdown editor found.");
    }
  }
  getEntriesFromNote(content, title) {
    const titleRegex = new RegExp(`^#+\\s+${title}$`, "m");
    const titleMatch = titleRegex.exec(content);
    if (!titleMatch) {
      return [];
    }
    const startIndex = titleMatch.index + titleMatch[0].length;
    let endIndex = content.indexOf("\n#", startIndex);
    if (endIndex === -1) {
      endIndex = content.length;
    }
    const listItemRegex = /^(-|\d+\.) +(.+)$/gm;
    const entries = [];
    let currentEntry;
    let currentEntrySplit;
    let repeat;
    let itemString;
    const listContent = content.substring(startIndex, endIndex);
    while ((currentEntry = listItemRegex.exec(listContent)) !== null) {
      let fullString = currentEntry[2];
      const ItemWithNumberRegEx = /^\((\d+)\)\s+(.+)$/m;
      if ((currentEntrySplit = ItemWithNumberRegEx.exec(fullString)) !== null) {
        repeat = Number(currentEntrySplit[1]);
        itemString = currentEntrySplit[2];
      } else {
        repeat = 1;
        itemString = fullString;
      }
      for (let i = 0; i < repeat; i++) {
        entries.push(itemString);
      }
    }
    return entries;
  }
};
var SampleSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Settings for List Item Random Picker." });
    new import_obsidian.Setting(containerEl).setName("Note Path").setDesc("Path to the note containing the entries.").addText((text) => text.setPlaceholder("Enter the path to your note").setValue(this.plugin.settings.notePath).onChange(async (value) => {
      this.plugin.settings.notePath = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBNb2RhbCwgTm90aWNlLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFRGaWxlLCBFZGl0b3IsIE1hcmtkb3duVmlldyB9IGZyb20gJ29ic2lkaWFuJztcblxuaW50ZXJmYWNlIE15UGx1Z2luU2V0dGluZ3Mge1xuICAgIG5vdGVQYXRoOiBzdHJpbmc7XG59XG5cbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IE15UGx1Z2luU2V0dGluZ3MgPSB7XG4gICAgbm90ZVBhdGg6ICdFeGFtcGxlIE5vdGUnXG59O1xuXG5jbGFzcyBJdGVtUGlja2VyTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgaXRlbXM6IHN0cmluZ1tdO1xuICAgIGNhbGxiYWNrOiAoaXRlbTogc3RyaW5nKSA9PiB2b2lkO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGl0ZW1zOiBzdHJpbmdbXSwgY2FsbGJhY2s6IChpdGVtOiBzdHJpbmcpID0+IHZvaWQpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5pdGVtcyA9IGl0ZW1zO1xuICAgICAgICB0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblxuICAgICAgICAvLyBDb25maWd1cmF0aW9uIGR1IGNvbnRlbmV1ciBGbGV4Ym94XG4gICAgICAgIGNvbnRlbnRFbC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgICAgICBjb250ZW50RWwuc3R5bGUuZmxleERpcmVjdGlvbiA9ICdjb2x1bW4nO1xuICAgICAgICBjb250ZW50RWwuc3R5bGUuaGVpZ2h0ID0gJzEwMCUnOyAvLyBBc3N1cmV6LXZvdXMgcXVlIGxlIGNvbnRlbmV1ciBwcmVuZCB0b3V0ZSBsYSBoYXV0ZXVyXG5cbiAgICAgICAgLy8gQ29udGVuZXVyIHBvdXIgbGUgc1x1MDBFOWxlY3RldXIgKHByZW5kcmEgbCdlc3BhY2UgcmVzdGFudClcbiAgICAgICAgY29uc3Qgc2VsZWN0Q29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICBzZWxlY3RDb250YWluZXIuc3R5bGUuZmxleEdyb3cgPSAnMSc7IC8vIFByZW5kIGwnZXNwYWNlIGRpc3BvbmlibGVcbiAgICAgICAgc2VsZWN0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XG4gICAgICAgIHNlbGVjdENvbnRhaW5lci5zdHlsZS5mbGV4RGlyZWN0aW9uID0gJ2NvbHVtbic7XG4gICAgICAgIHNlbGVjdENvbnRhaW5lci5zdHlsZS5qdXN0aWZ5Q29udGVudCA9ICdjZW50ZXInOyAvLyBDZW50cmUgdmVydGljYWxlbWVudCBsZSBzZWxlY3RcbiAgICAgICAgc2VsZWN0Q29udGFpbmVyLnN0eWxlLmFsaWduSXRlbXMgPSAnY2VudGVyJzsgLy8gQ2VudHJlIGhvcml6b250YWxlbWVudCBsZSBzZWxlY3RcblxuICAgICAgICBjb25zdCBpdGVtU2VsZWN0ID0gc2VsZWN0Q29udGFpbmVyLmNyZWF0ZUVsKCdzZWxlY3QnKTtcbiAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgaXRlbVNlbGVjdC5jcmVhdGVFbCgnb3B0aW9uJywgeyB2YWx1ZTogaXRlbSwgdGV4dDogaXRlbSB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ29udGVuZXVyIHBvdXIgbGUgYm91dG9uIChlbiBiYXMsIGNlbnRyXHUwMEU5KVxuICAgICAgICBjb25zdCBidXR0b25Db250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIGJ1dHRvbkNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgICAgICBidXR0b25Db250YWluZXIuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnY2VudGVyJzsgLy8gQ2VudHJlIGhvcml6b250YWxlbWVudCBsZSBib3V0b25cbiAgICAgICAgYnV0dG9uQ29udGFpbmVyLnN0eWxlLnBhZGRpbmcgPSAnMTBweCAwJzsgLy8gQWpvdXRlIHVuIHBldSBkJ2VzcGFjZSBhdXRvdXIgZHUgYm91dG9uXG5cbiAgICAgICAgY29uc3Qgb2tCdXR0b24gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ09LJyB9KTtcbiAgICAgICAgb2tCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZEl0ZW0gPSBpdGVtU2VsZWN0LnZhbHVlO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5jYWxsYmFjayhzZWxlY3RlZEl0ZW0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBvbkNsb3NlKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMaXN0SXRlbVJhbmRvbVBpY2tlciBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IE15UGx1Z2luU2V0dGluZ3M7XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICAgICAgdGhpcy5hZGRSaWJib25JY29uKCdsaXN0LXRyZWUnLCAnUGljayBSYW5kb20gRW50cnknLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9wZW5UaXRsZVBpY2tlcih0aGlzLnNldHRpbmdzLm5vdGVQYXRoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBTYW1wbGVTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG5cbiAgICB9XG5cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBhc3luYyBvcGVuVGl0bGVQaWNrZXIobm90ZVBhdGg6IHN0cmluZykge1xuICAgICAgICBjb25zdCBmdWxsbm90ZVBhdGggPSBub3RlUGF0aCArICcubWQnO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZ1bGxub3RlUGF0aCk7XG5cbiAgICAgICAgaWYgKCFmaWxlKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdOb3RlIG5vdCBmb3VuZCEnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0ludmFsaWQgZmlsZSB0eXBlLiBFeHBlY3RlZCBhIFRGaWxlLicpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgIGNvbnN0IHRpdGxlcyA9IHRoaXMuZ2V0VGl0bGVzRnJvbU5vdGUoY29udGVudCk7XG5cbiAgICAgICAgaWYgKHRpdGxlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vIHRpdGxlcyBmb3VuZCBpbiB0aGUgbm90ZSEnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIG5ldyBJdGVtUGlja2VyTW9kYWwodGhpcy5hcHAsIHRpdGxlcywgKHRpdGxlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmluc2VydFJhbmRvbUVudHJ5KGZ1bGxub3RlUGF0aCwgdGl0bGUpO1xuICAgICAgICB9KS5vcGVuKCk7XG4gICAgfVxuXG4gICAgZ2V0VGl0bGVzRnJvbU5vdGUoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCB0aXRsZVJlZ2V4ID0gL14jK1xccysoLispJC9nbTtcbiAgICAgICAgY29uc3QgdGl0bGVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBsZXQgbWF0Y2g7XG4gICAgICAgIHdoaWxlICgobWF0Y2ggPSB0aXRsZVJlZ2V4LmV4ZWMoY29udGVudCkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICB0aXRsZXMucHVzaChtYXRjaFsxXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRpdGxlcztcbiAgICB9XG5cbiAgICBhc3luYyBpbnNlcnRSYW5kb21FbnRyeShub3RlUGF0aDogc3RyaW5nLCB0aXRsZTogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobm90ZVBhdGgpO1xuXG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnTm90ZSBub3QgZm91bmQhJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdJbnZhbGlkIGZpbGUgdHlwZS4gRXhwZWN0ZWQgYSBURmlsZS4nKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICAgICAgICBjb25zdCBlbnRyaWVzID0gdGhpcy5nZXRFbnRyaWVzRnJvbU5vdGUoY29udGVudCwgdGl0bGUpO1xuXG4gICAgICAgIGlmIChlbnRyaWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnTm8gZW50cmllcyBmb3VuZCBmb3IgdGhpcyB0aXRsZSEnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByYW5kb21FbnRyeSA9IGVudHJpZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZW50cmllcy5sZW5ndGgpXS5yZXBsYWNlKC9cXG4vZywgJycpO1xuICAgICAgICAvLyBjb25zdCByYW5kb21FbnRyeSA9IGVudHJpZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZW50cmllcy5sZW5ndGgpXS50cmltKCk7XG5cbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cbiAgICAgICAgaWYgKGFjdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IGFjdGl2ZVZpZXcuZWRpdG9yO1xuICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKHJhbmRvbUVudHJ5LCBwb3NpdGlvbiwgcG9zaXRpb24pO1xuXG4gICAgICAgICAgICAvLyBEXHUwMEU5cGxhY2VyIGxlIGN1cnNldXIgXHUwMEUwIGxhIGZpbiBkZSBsJ2luc2VydGlvblxuICAgICAgICAgICAgY29uc3QgbmV3UG9zaXRpb24gPSB7IGxpbmU6IHBvc2l0aW9uLmxpbmUsIGNoOiBwb3NpdGlvbi5jaCArIHJhbmRvbUVudHJ5Lmxlbmd0aCB9O1xuICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcihuZXdQb3NpdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKFwiTm8gYWN0aXZlIE1hcmtkb3duIGVkaXRvciBmb3VuZC5cIik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRFbnRyaWVzRnJvbU5vdGUoY29udGVudDogc3RyaW5nLCB0aXRsZTogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCB0aXRsZVJlZ2V4ID0gbmV3IFJlZ0V4cChgXiMrXFxcXHMrJHt0aXRsZX0kYCwgJ20nKTtcbiAgICAgICAgY29uc3QgdGl0bGVNYXRjaCA9IHRpdGxlUmVnZXguZXhlYyhjb250ZW50KTtcblxuICAgICAgICBpZiAoIXRpdGxlTWF0Y2gpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHN0YXJ0SW5kZXggPSB0aXRsZU1hdGNoLmluZGV4ICsgdGl0bGVNYXRjaFswXS5sZW5ndGg7XG4gICAgICAgIGxldCBlbmRJbmRleCA9IGNvbnRlbnQuaW5kZXhPZignXFxuIycsIHN0YXJ0SW5kZXgpO1xuICAgICAgICBpZiAoZW5kSW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICBlbmRJbmRleCA9IGNvbnRlbnQubGVuZ3RoO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbGlzdEl0ZW1SZWdleCA9IC9eKC18XFxkK1xcLikgKyguKykkL2dtO1xuICAgICAgICBjb25zdCBlbnRyaWVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBsZXQgY3VycmVudEVudHJ5O1xuICAgICAgICBsZXQgY3VycmVudEVudHJ5U3BsaXQ7XG4gICAgICAgIGxldCByZXBlYXQ6IG51bWJlcjtcbiAgICAgICAgbGV0IGl0ZW1TdHJpbmc6IHN0cmluZztcbiAgICAgICAgY29uc3QgbGlzdENvbnRlbnQgPSBjb250ZW50LnN1YnN0cmluZyhzdGFydEluZGV4LCBlbmRJbmRleCk7XG4gICAgICAgIHdoaWxlICgoY3VycmVudEVudHJ5ID0gbGlzdEl0ZW1SZWdleC5leGVjKGxpc3RDb250ZW50KSkgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGxldCBmdWxsU3RyaW5nID0gY3VycmVudEVudHJ5WzJdO1xuICAgICAgICAgICAgY29uc3QgSXRlbVdpdGhOdW1iZXJSZWdFeCA9IC9eXFwoKFxcZCspXFwpXFxzKyguKykkL207XG4gICAgICAgICAgICBpZiAoKGN1cnJlbnRFbnRyeVNwbGl0ID0gSXRlbVdpdGhOdW1iZXJSZWdFeC5leGVjKGZ1bGxTdHJpbmcpKSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJlcGVhdCA9IE51bWJlcihjdXJyZW50RW50cnlTcGxpdFsxXSk7XG4gICAgICAgICAgICAgICAgaXRlbVN0cmluZyA9IGN1cnJlbnRFbnRyeVNwbGl0WzJdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXBlYXQgPSAxO1xuICAgICAgICAgICAgICAgIGl0ZW1TdHJpbmcgPSBmdWxsU3RyaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXBlYXQ7IGkrKykge1xuICAgICAgICAgICAgICAgIGVudHJpZXMucHVzaChpdGVtU3RyaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZW50cmllcztcbiAgICB9XG59XG5cbmNsYXNzIFNhbXBsZVNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IExpc3RJdGVtUmFuZG9tUGlja2VyO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTGlzdEl0ZW1SYW5kb21QaWNrZXIpIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnU2V0dGluZ3MgZm9yIExpc3QgSXRlbSBSYW5kb20gUGlja2VyLicgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnTm90ZSBQYXRoJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdQYXRoIHRvIHRoZSBub3RlIGNvbnRhaW5pbmcgdGhlIGVudHJpZXMuJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignRW50ZXIgdGhlIHBhdGggdG8geW91ciBub3RlJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mubm90ZVBhdGgpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5ub3RlUGF0aCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgfVxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBbUc7QUFNbkcsSUFBTSxtQkFBcUM7QUFBQSxFQUN2QyxVQUFVO0FBQ2Q7QUFFQSxJQUFNLGtCQUFOLGNBQThCLHNCQUFNO0FBQUEsRUFJaEMsWUFBWSxLQUFVLE9BQWlCLFVBQWtDO0FBQ3JFLFVBQU0sR0FBRztBQUNULFNBQUssUUFBUTtBQUNiLFNBQUssV0FBVztBQUFBLEVBQ3BCO0FBQUEsRUFFQSxTQUFTO0FBQ0wsVUFBTSxFQUFFLFVBQVUsSUFBSTtBQUd0QixjQUFVLE1BQU0sVUFBVTtBQUMxQixjQUFVLE1BQU0sZ0JBQWdCO0FBQ2hDLGNBQVUsTUFBTSxTQUFTO0FBR3pCLFVBQU0sa0JBQWtCLFVBQVUsVUFBVTtB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
