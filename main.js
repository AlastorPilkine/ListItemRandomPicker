/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  LIRPSuggestModal: () => LIRPSuggestModal,
  default: () => ListItemRandomPicker
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
function findIndexes(anArray, predicate) {
  const indexes = [];
  anArray.forEach((element, index) => {
    if (predicate(element, index)) {
      indexes.push(index);
    }
  });
  return indexes;
}
function indexIsBetweenFindIndexes(index, indexes, lastCouldBeOpen = false) {
  let isBeetween = false;
  if (lastCouldBeOpen) {
    if (indexes.length % 2 !== 0 && index >= indexes[indexes.length - 1]) {
      return true;
    }
    ;
  }
  ;
  for (let i = 0; i < indexes.length - 2; i = i + 2) {
    if (indexes[i] <= index && index <= indexes[i + 1]) {
      return true;
    }
  }
  return isBeetween;
}
function escapeRegex(stringToEscape) {
  return stringToEscape.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
}
var DiceRoller = class {
  checkDice(diceString) {
    const diceRegex = /^(\d+)?d(\d+)([\+\-]\d+)?(e)?(k\d+)?(kl\d+)?$/i;
    return diceRegex.test(diceString);
  }
  rollDice(diceString) {
    if (!this.checkDice(diceString)) {
      throw new Error("Syntaxe de lancer de d\xE9s invalide.");
    }
    const [_, countStr, sidesStr, modifierStr, explodeStr, keepStr, keepLowStr] = diceString.match(
      /^(\d+)?d(\d+)([\+\-]\d+)?(e)?(k\d+)?(kl\d+)?$/i
    );
    const count = parseInt(countStr || "1");
    const sides = parseInt(sidesStr);
    const modifier = parseInt(modifierStr || "0");
    const explode = !!explodeStr;
    const keep = keepStr ? parseInt(keepStr.slice(1)) : void 0;
    const keepLow = keepLowStr ? parseInt(keepLowStr.slice(2)) : void 0;
    let results = [];
    for (let i = 0; i < count; i++) {
      let result = Math.floor(Math.random() * sides) + 1;
      results.push(result);
      if (explode) {
        while (result === sides) {
          result = Math.floor(Math.random() * sides) + 1;
          results.push(result);
        }
      }
    }
    if (keep) {
      results.sort((a, b) => b - a);
      results = results.slice(0, keep);
    } else if (keepLow) {
      results.sort((a, b) => a - b);
      results = results.slice(0, keepLow);
    }
    const sum = results.reduce((acc, val) => acc + val, 0);
    return sum + modifier;
  }
  /**
   * Remplace les lancers de dés encadrés par des délimiteurs dans une chaîne multi-lignes.
   *
   * @param {string} text Le texte multi-lignes contenant les lancers de dés.
   * @param {string} startDelimiter Le délimiteur de début des lancers de dés.
   * @param {string} endDelimiter Le délimiteur de fin des lancers de dés.
   * @returns {string} Le texte avec les lancers de dés remplacés par leurs résultats.
   */
  replaceDiceRolls(text, startDelimiter, endDelimiter) {
    const regex = new RegExp(
      `${this.escapeRegExp(startDelimiter)}([^${this.escapeRegExp(
        startDelimiter + endDelimiter
      )}]+)${this.escapeRegExp(endDelimiter)}`,
      "g"
    );
    return text.replace(regex, (match, diceString) => {
      try {
        const result = this.rollDice(diceString);
        return result.toString();
      } catch (error) {
        return match;
      }
    });
  }
  /**
   * Échappe les caractères spéciaux pour une utilisation dans une expression régulière.
   *
   * @param {string} string La chaîne de caractères à échapper.
   * @returns {string} La chaîne de caractères échappée.
   */
  escapeRegExp(string) {
    return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
  }
};
var LIRPLogStatusValues = [
  "dupInNote",
  "dupInFolder",
  "emptyList",
  "emptyNote",
  "refLimit",
  "subRefLimit",
  "pathSetting",
  "folderAndFile",
  "showItem",
  "noActiveView"
];
var LIRPLogElement = class _LIRPLogElement {
  static getErrorStatus() {
    return ["dupInFolder", "pathSetting"];
  }
  static getWarningStatus() {
    let warningStatus = [];
    LIRPLogStatusValues.map((element) => {
      if (!_LIRPLogElement.getErrorStatus().contains(element) && !_LIRPLogElement.getWarningStatus().contains(element)) {
        warningStatus.push(element);
      }
      ;
    });
    return warningStatus;
  }
  static getInfoStatus() {
    return ["showItem", "refLimit", "subRefLimit"];
  }
  getType() {
    const errors = ["pathSetting", "dupInFolder"];
    if (errors.contains(this.status)) {
      return "error";
    } else {
      return "warning";
    }
    ;
  }
  constructor(father, child, status, complement = "") {
    this.father = father;
    this.child = child;
    this.status = status;
    this.complement = complement;
  }
  toString() {
    return `${this.getType()} / ${this.father} / ${this.child} / ${this.status} / ${this.complement}`;
  }
};
var LIRPLog = class {
  constructor() {
    this.logs = [];
  }
  push(father, child, status, complement = "") {
    this.logs.push(new LIRPLogElement(father, child, status, complement));
  }
  add(logs) {
    this.logs = this.logs.concat(logs.logs);
  }
  get(type) {
    const logsForType = this.logs.filter(
      (element) => element.getType() === type
    );
    let getArray = [];
    logsForType.map((element) => {
      getArray.push(element.toString());
    });
    return getArray;
  }
  flush() {
    this.logs = [];
  }
};
var LIRPList = class _LIRPList {
  static getSettingString(value = "") {
    if (value === "") {
      return "- [ ] Hide this list\n";
    } else {
      switch (value) {
        case "hide":
          return "^- \\[[x \\?]\\] Hide this list$";
        case "hide_string":
          return "- \\[[x ?]\\] Hide this list";
        case "hide_ticked":
          return "^- \\[[x?]\\] Hide this list$";
      }
      ;
    }
    ;
  }
  constructor(noteName, lines, nullValue, escapeString, commentString) {
    this.title = "";
    this.description = "";
    this.hidden = false;
    this.items = [];
    this.logs = new LIRPLog();
    this.nullValue = nullValue;
    this.escapeString = escapeString;
    this.commentString = commentString;
    const headingRegEx = /^# +(.+)$/;
    this.title = lines[0].replace(headingRegEx, "$1");
    lines.shift();
    const listBeginItemString = `^(?!${_LIRPList.getSettingString("hide_string")}) {0,3}(-|\\d+.|\\*) +(.+)$`;
    const listBeginItemRegex = new RegExp(listBeginItemString);
    const listBeginIndexes = findIndexes(lines, (element) => listBeginItemRegex.test(element));
    if (listBeginIndexes.length === 0) {
      this.logs.push(noteName, this.title, "emptyList");
      this.hidden = true;
      return;
    }
    const cleanLines = lines.map((element) => {
      return element.replace(listBeginItemRegex, "$2");
    });
    if (listBeginIndexes[0] !== 0) {
      let mdDescription = cleanLines.slice(0, listBeginIndexes[0]);
      if (mdDescription[0] === "") {
        mdDescription.shift();
      }
      let isHidden = false;
      const hideRegexTicked = new RegExp(_LIRPList.getSettingString("hide_ticked"));
      const hideRegex = new RegExp(_LIRPList.getSettingString("hide"));
      mdDescription.map((element) => {
        if (hideRegexTicked.test(element)) {
          isHidden = true;
          this.hidden = isHidden;
        }
        ;
      });
      mdDescription = mdDescription.filter((element) => !hideRegex.test(element));
      this.description = mdDescription.join("\n");
    } else {
      this.description = "";
    }
    const listBeginCount = listBeginIndexes.length;
    let item;
    for (let currentIndex = 0; currentIndex < listBeginCount - 1; currentIndex++) {
      item = cleanLines.slice(listBeginIndexes[currentIndex], listBeginIndexes[currentIndex + 1]);
      this.pushItemBasedOnWeight(item);
    }
    item = cleanLines.slice(listBeginIndexes[listBeginCount - 1]);
    if (item.at(-1) === "") {
      item.pop();
    }
    this.pushItemBasedOnWeight(item);
  }
  flushLogs() {
    this.logs.flush();
  }
  pushItemBasedOnWeight(item) {
    const ItemWithWeightRegEx = /^\((\d+)\)\s+(.+)$/;
    let regExExecution;
    let repeat;
    if ((regExExecution = ItemWithWeightRegEx.exec(item[0])) !== null) {
      repeat = Number(regExExecution[1]);
      item[0] = regExExecution[2];
    } else {
      repeat = 1;
    }
    if (item[0] === this.nullValue) {
      if (item.length === 1) {
        item[0] = "";
      } else {
        item.shift();
      }
      ;
    }
    ;
    const escapeStringRegex = `^ *${this.escapeString}(.*)`;
    const escapeStringRegEx = new RegExp(escapeStringRegex, "gm");
    const escapeItem = item.map((element) => {
      return element.replace(escapeStringRegEx, "$1");
    });
    let stringItem = escapeItem.join("\n");
    for (let i = 0; i < repeat; i++) {
      this.items.push(stringItem);
    }
  }
  getSuggestion(noteName) {
    const suggestion = {
      noteName,
      title: this.title,
      description: this.description.split("\n")[0]
    };
    return suggestion;
  }
  notHidden() {
    return !this.hidden;
  }
  pickRandomItem() {
    let randomItem = "";
    if (this.items.length > 0) {
      randomItem = this.items[Math.floor(Math.random() * this.items.length)];
    }
    return randomItem;
  }
  getLogs() {
    return this.logs;
  }
  get length() {
    return this.items.length;
  }
};
var LIRPNote = class _LIRPNote {
  static getSettingString(value = "") {
    if (value === "") {
      return "- [ ] Do not preserve comments\n";
    } else {
      switch (value) {
        case "deleteComment":
          return "^- \\[[x ?]\\] Do not preserve comments$";
        case "deleteComment_ticked":
          return "^- \\[[x?]\\] Do not preserve comments$";
      }
      ;
    }
    ;
  }
  constructor(nullValue, escapeString, commentString, referenceMaxDepth) {
    this.noteName = "";
    this.description = "";
    this.list = [];
    this.logs = new LIRPLog();
    this.nullValue = nullValue;
    this.escapeString = escapeString;
    this.commentString = commentString;
    this.rollDice = true;
    this.referenceMaxDepth = referenceMaxDepth;
    this.keepComment = true;
  }
  getListTitles() {
    let listTitles = [];
    this.list.map((element) => {
      listTitles.push(element.title);
    });
    return listTitles;
  }
  workWithComment(text) {
    const tickSettingRegEx = new RegExp(_LIRPNote.getSettingString("deleteComment_ticked"));
    const headingRegex = /^# .+$/;
    const commentLineString = `^${this.commentString}$`;
    const commentLineRegex = new RegExp(commentLineString);
    const commentBlock = `${this.commentString}.*?${this.commentString}`;
    const commentBlockRegex = new RegExp(commentBlock);
    const lines = text.split("\n");
    const settingIndex = findIndexes(lines, (element) => tickSettingRegEx.test(element));
    const commentLineIndex = findIndexes(lines, (element) => commentLineRegex.test(element));
    const headingIndex = findIndexes(lines, (element) => headingRegex.test(element));
    if (headingIndex.length === 0) {
      return text;
    }
    ;
    if (settingIndex.length === 0 || settingIndex[0] > headingIndex[0]) {
      this.keepComment = true;
    } else {
      this.keepComment = indexIsBetweenFindIndexes(settingIndex[0], commentLineIndex);
    }
    let insideComment = false;
    const newLines = [];
    lines.map((element) => {
      let isACommentLine = false;
      if (commentLineRegex.test(element)) {
        insideComment = !insideComment;
        isACommentLine = true;
      }
      if (insideComment || isACommentLine) {
        if (this.keepComment) {
          newLines.push(this.escapeString + element);
        }
        ;
      } else {
        if (this.keepComment) {
          newLines.push(element);
        } else {
          newLines.push(element.replace(commentBlockRegex, ""));
        }
        ;
      }
      ;
    });
    return newLines.join("\n");
  }
  loadFromNote(noteName, noteContent) {
    this.noteName = noteName;
    let lines = [];
    lines = this.workWithComment(noteContent).split("\n");
    if (lines[0] === "") {
      lines.shift();
    }
    ;
    const headingRegex = /^# .+$/;
    let headingIndexes = findIndexes(lines, (element) => headingRegex.test(element));
    if (headingIndexes.length === 0) {
      this.logs.push(noteName, "", "emptyNote");
      return false;
    }
    if (headingIndexes[0] !== 0) {
      let mdDescription = lines.slice(0, headingIndexes[0]);
      const deleteRegex = new RegExp(_LIRPNote.getSettingString("deleteComment"));
      mdDescription = mdDescription.filter((element) => !deleteRegex.test(element));
      this.description = mdDescription.join("\n");
    }
    const headingCount = headingIndexes.length;
    let pushSuccess = true;
    for (let currentIndex = 0; currentIndex < headingCount - 1; currentIndex++) {
      pushSuccess = this.pushListIfNotExists(new LIRPList(this.noteName, lines.slice(headingIndexes[currentIndex], headingIndexes[currentIndex + 1]), this.nullValue, this.escapeString, this.commentString)) && pushSuccess;
    }
    ;
    pushSuccess = this.pushListIfNotExists(new LIRPList(this.noteName, lines.slice(headingIndexes[headingCount - 1]), this.nullValue, this.escapeString, this.commentString)) && pushSuccess;
    return pushSuccess;
  }
  pushListIfNotExists(listToPush) {
    if (this.getListTitles().contains(listToPush.title)) {
      this.logs.push(this.noteName, listToPush.title, "dupInNote");
      return false;
    } else {
      this.list.push(listToPush);
      return true;
    }
    ;
  }
  getListSuggestion(withHidden = false) {
    const noteSuggestion = new LIRPSuggestionList();
    this.list.forEach((element) => {
      if (withHidden || element.notHidden()) {
        noteSuggestion.push(element.getSuggestion(this.noteName));
      }
    });
    return noteSuggestion;
  }
  doReferenceSubstitution(text) {
    let match;
    let modifiedText = text;
    let listTitle = "";
    const stringRefRegex = `{(${this.list.map((element) => escapeRegex(element.title)).join("|")})}`;
    for (let repeat = 0; repeat < this.referenceMaxDepth; repeat++) {
      const refRegex = new RegExp(stringRefRegex, "mg");
      while ((match = refRegex.exec(modifiedText)) !== null) {
        let newValue = this.pickRandomItemFromList(match[1], false);
        listTitle = match[0];
        modifiedText = modifiedText.replace(listTitle, newValue);
        refRegex.lastIndex = match.index + newValue.length;
      }
      ;
    }
    ;
    if (this.rollDice) {
      const diceRoller = new DiceRoller();
      modifiedText = diceRoller.replaceDiceRolls(modifiedText, "{", "}");
    }
    ;
    return {
      lastListTitle: listTitle,
      modifiedText
    };
  }
  flushLogs() {
    this.logs.flush();
    this.list.map((element) => {
      element.flushLogs();
    });
  }
  pickRandomItemFromList(listTitle, workOnReference = true) {
    let randomItem = "";
    let returnOfDoExecSub = {
      lastListTitle: listTitle,
      modifiedText: ""
    };
    const currentList = this.list.find((element) => element.title === listTitle);
    if (currentList !== void 0) {
      randomItem = currentList.pickRandomItem();
      if (workOnReference) {
        returnOfDoExecSub = this.doReferenceSubstitution(randomItem);
        randomItem = returnOfDoExecSub.modifiedText;
        const stringRefRegex = `{(${this.list.map((element) => escapeRegex(element.title)).join("|")})}`;
        const RefRegex = new RegExp(stringRefRegex);
        if (RefRegex.test(randomItem) && workOnReference) {
          if (returnOfDoExecSub.lastListTitle === "") {
            returnOfDoExecSub.lastListTitle = listTitle;
          }
          this.logs.push(this.noteName, returnOfDoExecSub.lastListTitle, "refLimit");
        }
        ;
      }
      ;
      return randomItem;
    } else {
      return "";
    }
    ;
  }
  getLogs() {
    let allLogs = new LIRPLog();
    allLogs.add(this.logs);
    this.list.map((element) => {
      allLogs.add(element.getLogs());
    });
    return allLogs;
  }
  get length() {
    return this.list.length;
  }
};
var LIRPMultiNote = class {
  constructor(nullValue, escapeString, commentString, referenceMaxDepth) {
    this.multiNote = [];
    this.nullValue = nullValue;
    this.escapeString = escapeString;
    this.commentString = commentString;
    this.referenceMaxDepth = referenceMaxDepth;
    this.logs = new LIRPLog();
  }
  loadFromNote(noteName, noteContent) {
    const currentNote = new LIRPNote(this.nullValue, this.escapeString, this.commentString, this.referenceMaxDepth);
    let status = currentNote.loadFromNote(noteName, noteContent);
    status = this.pushNoteIfListNotExists(currentNote) && status;
    return status;
  }
  pushNoteIfListNotExists(noteToPush) {
    const allListTitle = this.getListTitles();
    let unic = true;
    noteToPush.getListTitles().map((element) => {
      if (allListTitle.contains(element)) {
        this.logs.push(noteToPush.noteName, element, "dupInFolder", this.getNoteNameFromListTitle(element));
        unic = false;
      }
    });
    if (unic) {
      this.multiNote.push(noteToPush);
    } else {
      this.logs.add(noteToPush.logs);
    }
    ;
    return unic;
  }
  getNoteNameFromListTitle(listTitle) {
    let note = this.multiNote.find(
      (element) => element.getListTitles().contains(listTitle)
    );
    if (note !== void 0) {
      return note.noteName;
    } else {
      return "";
    }
    ;
  }
  getListTitles() {
    let listTitles = [];
    this.multiNote.map((element) => {
      listTitles = listTitles.concat(element.getListTitles());
    });
    return listTitles;
  }
  getListSuggestion(withHidden = false) {
    let allListSuggestion = new LIRPSuggestionList();
    this.multiNote.map((element) => {
      allListSuggestion = allListSuggestion.concat(element.getListSuggestion(withHidden));
    });
    return allListSuggestion;
  }
  getNoteSuggestion(withHidden = false) {
    let noteSuggestion = new LIRPSuggestionList();
    this.multiNote.map((element) => {
      if (element.getListSuggestion(withHidden).length > 0) {
        noteSuggestion.push({
          noteName: element.noteName,
          title: element.noteName,
          description: element.description.split("\n")[0]
        });
      }
      ;
    });
    return noteSuggestion;
  }
  doReferenceSubstitution(text) {
    let superNote = new LIRPNote(this.nullValue, this.escapeString, this.commentString, this.referenceMaxDepth);
    this.multiNote.map((element) => {
      superNote.list = superNote.list.concat(element.list);
    });
    let returnOfDoExecSub = {
      lastListTitle: "Reference substitution in selection",
      modifiedText: ""
    };
    returnOfDoExecSub = superNote.doReferenceSubstitution(text);
    let listTitle = "";
    const stringRefRegex = `{(${superNote.list.map((element) => escapeRegex(element.title)).join("|")})}`;
    const refRegex = new RegExp(stringRefRegex);
    if (refRegex.test(returnOfDoExecSub.modifiedText)) {
      this.logs.push("", "", "subRefLimit");
    }
    ;
    return returnOfDoExecSub.modifiedText;
  }
  pickRandomItemFromList(listTitle, workOnReference = true) {
    let superNote = new LIRPNote(this.nullValue, this.escapeString, this.commentString, this.referenceMaxDepth);
    superNote.noteName = this.getNoteNameFromListTitle(listTitle);
    this.multiNote.map((element) => {
      superNote.list = superNote.list.concat(element.list);
    });
    const randomItem = superNote.pickRandomItemFromList(listTitle);
    this.logs.add(superNote.getLogs());
    return randomItem;
  }
  flushLogs() {
    this.logs.flush();
    this.multiNote.map((element) => {
      element.flushLogs();
    });
  }
  getLogs() {
    let allLogs = new LIRPLog();
    allLogs.add(this.logs);
    this.multiNote.map((element) => {
      allLogs.add(element.getLogs());
    });
    return allLogs;
  }
  hasErrors() {
    const allLogs = this.getLogs();
    return allLogs.get("error").length !== 0;
  }
  get length() {
    return this.multiNote.length;
  }
};
var LIRPSuggestionList = class _LIRPSuggestionList {
  constructor() {
    this.list = [];
  }
  push(element) {
    this.list.push(element);
  }
  filterByNoteName(noteName) {
    const filterList = new _LIRPSuggestionList();
    this.list.map((element) => {
      if (element.noteName === noteName) {
        filterList.push(element);
      }
    });
    return filterList;
  }
  filter(callback) {
    const filteredList = new _LIRPSuggestionList();
    for (let i = 0; i < this.list.length; i++) {
      if (callback(this.list[i], i, this.list)) {
        filteredList.push(this.list[i]);
      }
      ;
    }
    ;
    return filteredList;
  }
  concat(otherList) {
    const newList = new _LIRPSuggestionList();
    newList.list = this.list.concat(otherList.list);
    return newList;
  }
  get length() {
    return this.list.length;
  }
};
var LIRPSuggestModal = class extends import_obsidian.SuggestModal {
  constructor(app, items, callback) {
    super(app);
    this.items = items;
    this.callback = callback;
  }
  getSuggestions(query) {
    return this.items.filter(
      (item) => item.title.toLowerCase().includes(query.toLowerCase())
    ).list;
  }
  renderSuggestion(item, el) {
    el.createEl("div", { text: item.title });
    let message = item.description;
    el.createEl("small", { text: message });
  }
  onChooseSuggestion(item, evt) {
    this.callback(item);
  }
};
var DEFAULT_SETTINGS = {
  notePath: "Note or folder path",
  nullValue: "null",
  escapeValue: "//",
  selectionForNotification: "!",
  showNoteSelector: true,
  showWarning: true,
  deleteSelectionForNotification: false,
  maxReferenceDepth: 3,
  commentValue: "%%"
};
var ListItemRandomPicker = class extends import_obsidian.Plugin {
  async onload() {
    await this.loadSettings();
    this.logs = new LIRPLog();
    this.addRibbonIcon("list-tree", "Pick random list item", (evt) => {
      this.prepareAction("note");
    });
    this.addCommand({
      id: "insert-random-item",
      name: "Insert random item from list",
      callback: () => {
        this.prepareAction("note");
      }
    });
    this.addCommand({
      id: "insert-list-setting-item",
      name: "Insert list settings values",
      callback: () => {
        this.insertString(LIRPList.getSettingString());
      }
    });
    this.addCommand({
      id: "insert-note-setting-item",
      name: "Insert note settings values",
      callback: () => {
        this.insertString(LIRPNote.getSettingString());
      }
    });
    this.addCommand({
      id: "insert-reference-item",
      name: "Insert list reference",
      callback: () => {
        this.prepareAction("reference");
      }
    });
    this.addCommand({
      id: "replace-reference-item",
      name: "Replace references in selection",
      callback: () => {
        this.prepareAction("doRefSubstitution");
      }
    });
    this.addSettingTab(new LIRPSettingTab(this.app, this));
  }
  onunload() {
  }
  getLIRPFiles(notePath) {
    let allVaultFiles = this.app.vault.getMarkdownFiles();
    let filesInNotePath = [];
    let foundAFile = false;
    const noteFileName = `${notePath}.md`;
    const notePathRegex = new RegExp(`^${notePath}/.+.md$`);
    allVaultFiles.map((element) => {
      if (notePathRegex.test(element.path)) {
        filesInNotePath.push(element.path);
      } else if (element.path === noteFileName) {
        foundAFile = true;
      }
      ;
    });
    if (filesInNotePath.length === 0 && foundAFile) {
      filesInNotePath.push(noteFileName);
    } else if (foundAFile && filesInNotePath.length !== 0) {
      this.logs.push("ListItemRandmPicker", "getLIRPFiles", "folderAndFile");
    }
    return filesInNotePath;
  }
  async loadLIRPFiles() {
    const allLIRPFiles = this.getLIRPFiles(this.settings.notePath);
    let currentLIRP = new LIRPMultiNote(this.settings.nullValue, this.settings.escapeValue, this.settings.commentValue, this.settings.maxReferenceDepth);
    for (const currentFile of allLIRPFiles) {
      const currentFSObject = this.app.vault.getAbstractFileByPath(currentFile);
      let content = "";
      if (currentFSObject instanceof import_obsidian.TFile) {
        content = await this.app.vault.cachedRead(currentFSObject);
        currentLIRP.loadFromNote(currentFSObject.path.slice(0, -3), content);
      }
      ;
    }
    ;
    return currentLIRP;
  }
  async prepareAction(action) {
    const currentLIRP = await this.loadLIRPFiles();
    if (currentLIRP.length === 0) {
      this.logs.push("ListItemRandomPicker", "loadLIRPFiles", "pathSetting");
    }
    ;
    if (!currentLIRP.hasErrors() && currentLIRP.length !== 0) {
      if (action === "doRefSubstitution") {
        this.doReferenceSubstitution(currentLIRP);
      } else {
        if (currentLIRP.length === 1 || !this.settings.showNoteSelector) {
          new LIRPSuggestModal(this.app, currentLIRP.getListSuggestion(action === "reference"), (item) => {
            if (action === "note") {
              this.workWithTitle(currentLIRP, item.title);
            } else {
              this.insertString(`{${item.title}}`);
            }
            ;
          }).open();
        } else {
          new LIRPSuggestModal(this.app, currentLIRP.getNoteSuggestion(action === "reference"), (item) => {
            new LIRPSuggestModal(this.app, currentLIRP.getListSuggestion(action === "reference").filterByNoteName(item.noteName), (item2) => {
              if (action === "note") {
                this.workWithTitle(currentLIRP, item2.title);
              } else {
                this.insertString(`{${item2.title}}`);
              }
              ;
            }).open();
          }).open();
        }
        ;
      }
      ;
    }
    this.doLogManagement(currentLIRP.getLogs());
    this.logs.flush();
    currentLIRP.flushLogs();
  }
  doLogManagement(multiNoteLogs) {
    const allLogs = this.logs;
    if (multiNoteLogs !== void 0) {
      allLogs.add(multiNoteLogs);
      multiNoteLogs.flush();
    }
    ;
    const errorMsg = [];
    const warningMsg = [];
    const infoMsg = [];
    allLogs.logs.map((element) => {
      switch (element.status) {
        case "dupInNote":
          warningMsg.push(`List "${element.child}" is duplicate in note "${element.father}". List is ignored`);
          break;
        case "dupInFolder":
          errorMsg.push(`ERROR : List "${element.child}" exists in two notes, "${element.father}" and "${element.complement}", make correction !`);
          break;
        case "emptyList":
          warningMsg.push(`List "${element.child}" is empty in "${element.father}"`);
          break;
        case "emptyNote":
          warningMsg.push(`"${element.child}" is empty`);
          break;
        case "refLimit":
          warningMsg.push(`Reference depth limit reach with list "${element.child}" in note "${element.father}"`);
          break;
        // case 'subRefLimit':
        //     warningMsg.push(`Reference depth limit reach`);
        //     break;
        case "pathSetting":
          errorMsg.push(`ERROR : verify path in plugin settings`);
          break;
        case "folderAndFile":
          warningMsg.push(`A note with the same name as the folder in settings gets ignored.`);
          break;
        case "showItem":
          infoMsg.push(`${element.complement}`);
          break;
        case "noActiveView":
          warningMsg.push(`No note in edition mode to do this action`);
          break;
      }
      ;
      errorMsg.map((element2) => new import_obsidian.Notice(element2));
      if (this.settings.showWarning) {
        warningMsg.map((element2) => new import_obsidian.Notice(element2));
      }
      ;
      infoMsg.map((element2) => new import_obsidian.Notice(element2));
    });
    this.logs.flush();
  }
  workWithTitle(note, listTitle) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if (activeView) {
      const selectionForNotificationRegex = `^${this.settings.selectionForNotification}$`;
      const noticeRegex = new RegExp(selectionForNotificationRegex);
      const selection = activeView.editor.getSelection();
      if (noticeRegex.test(selection)) {
        this.logs.push("", "", "showItem", note.pickRandomItemFromList(listTitle));
        if (this.settings.deleteSelectionForNotification) {
          activeView.editor.replaceSelection("");
        }
      } else {
        let stringToInsert = "";
        const repeatInsertRegEx = /^(\d+)(.*)/gm;
        let regExExecution;
        let repeat;
        if ((regExExecution = repeatInsertRegEx.exec(selection)) !== null) {
          const repeat2 = Number(regExExecution[1]);
          const delimiter = selection.replace(/^\d+/, "");
          const arrayStringToinsert = [];
          for (let i = 0; i < repeat2; i++) {
            arrayStringToinsert.push(note.pickRandomItemFromList(listTitle));
          }
          stringToInsert = arrayStringToinsert.join(delimiter);
        } else {
          stringToInsert = note.pickRandomItemFromList(listTitle);
        }
        activeView.editor.replaceSelection(stringToInsert);
      }
      ;
    } else {
      this.logs.push("ListItemRandomPicker", "workWithTitle", "noActiveView");
    }
    ;
    this.doLogManagement(note.getLogs());
  }
  doReferenceSubstitution(multiNote) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if (activeView) {
      const selection = activeView.editor.getSelection();
      activeView.editor.replaceSelection(multiNote.doReferenceSubstitution(selection));
    } else {
      this.logs.push("ListItemRandomPicker", "workWithTitle", "noActiveView");
    }
    ;
  }
  insertString(stringToInsert) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if (activeView) {
      activeView.editor.replaceSelection(stringToInsert);
    } else {
      this.logs.push("ListItemRandomPicker", "workWithTitle", "noActiveView");
    }
    ;
    this.doLogManagement();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var LIRPSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Path").setDesc('The path of a note or folder. Example: "Folder/Note" or "Folder".').addText(
      (text) => text.setPlaceholder("Enter the path to your note").setValue(this.plugin.settings.notePath).onChange(async (value) => {
        this.plugin.settings.notePath = value;
        await this.plugin.saveSettings();
      })
    );
    containerEl.createEl("h2", { text: "Specific values" });
    new import_obsidian.Setting(containerEl).setName("Null value").setDesc("If the first line of a list item has this value, that line is ignored. This allows you to have probabilities of getting no result. Usage example: having, or not having, a particle in a noun.").addText(
      (text) => text.setPlaceholder("Enter value").setValue(this.plugin.settings.nullValue).onChange(async (value) => {
        this.plugin.settings.nullValue = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Escape value").setDesc("To include heading one elements or first-level list items in your random list, escape them with these values. Exemple : // # Heading").addText(
      (text) => text.setPlaceholder("Enter value").setValue(this.plugin.settings.escapeValue).onChange(async (value) => {
        this.plugin.settings.escapeValue = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Selection value for notification").setDesc("If the selected text has this value, the item is not inserted; instead, a notification is shown.").addText(
      (text) => text.setPlaceholder("Enter value").setValue(this.plugin.settings.selectionForNotification).onChange(async (value) => {
        this.plugin.settings.selectionForNotification = value;
        await this.plugin.saveSettings();
      })
    );
    containerEl.createEl("h2", { text: "Behavior" });
    new import_obsidian.Setting(containerEl).setName("Show note selector").setDesc("If path is a folder containing at least two notes, a selector will allow you to choose the note; otherwise, all lists will be offered to you.").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.showNoteSelector);
      toggle.onChange(async (value) => {
        this.plugin.settings.showNoteSelector = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Show warning").setDesc("Are warnings displayed as notifications ?").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.showWarning);
      toggle.onChange(async (value) => {
        this.plugin.settings.showWarning = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Delete selection value on notification").setDesc("If this setting is on, the selected notification value is removed after it's used.").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.deleteSelectionForNotification);
      toggle.onChange(async (value) => {
        this.plugin.settings.deleteSelectionForNotification = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Reference depth limit").setDesc("Reference recursion limit: the maximum number of nested reference calls allowed. Zero disables reference resolution.").addSlider(
      (slider) => slider.setValue(this.plugin.settings.maxReferenceDepth).setLimits(0, 10, 1).setDynamicTooltip().onChange(async (value) => {
        this.plugin.settings.maxReferenceDepth = value;
        await this.plugin.saveSettings();
      })
    );
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBTdWdnZXN0TW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBURmlsZSwgTWFya2Rvd25WaWV3fSBmcm9tICdvYnNpZGlhbic7XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZnVuY3Rpb24gZmluZEluZGV4ZXM8VD4oYW5BcnJheTogVFtdLCBwcmVkaWNhdGU6IChlbGVtZW50OiBULCBpbmRleDogbnVtYmVyKSA9PiBib29sZWFuKTogbnVtYmVyW10ge1xuICAgIGNvbnN0IGluZGV4ZXM6IG51bWJlcltdID0gW107XG4gICAgYW5BcnJheS5mb3JFYWNoKChlbGVtZW50LCBpbmRleCkgPT4ge1xuICAgICAgaWYgKHByZWRpY2F0ZShlbGVtZW50LCBpbmRleCkpIHtcbiAgICAgICAgaW5kZXhlcy5wdXNoKGluZGV4KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gaW5kZXhlcztcbn07XG5cbmZ1bmN0aW9uIGluZGV4SXNCZXR3ZWVuRmluZEluZGV4ZXMoaW5kZXg6IG51bWJlciwgaW5kZXhlczogbnVtYmVyW10sIGxhc3RDb3VsZEJlT3Blbjpib29sZWFuID0gZmFsc2UpOiBib29sZWFuIHtcbiAgICBsZXQgaXNCZWV0d2Vlbjpib29sZWFuID0gZmFsc2U7XG4gICAgaWYgKGxhc3RDb3VsZEJlT3Blbikge1xuICAgICAgICBpZiAoKGluZGV4ZXMubGVuZ3RoICUgMiAhPT0gMCkgJiYgKGluZGV4ID49IGluZGV4ZXNbaW5kZXhlcy5sZW5ndGggLSAxXSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgIH07XG4gICAgZm9yIChsZXQgaT0wOyBpIDwgKGluZGV4ZXMubGVuZ3RoIC0gMik7IGkgPSBpICsyKSB7XG4gICAgICAgIGlmICgoaW5kZXhlc1tpXSA8PSBpbmRleCkgJiYgKGluZGV4IDw9IGluZGV4ZXNbaSsxXSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpc0JlZXR3ZWVuO1xufTtcblxuZnVuY3Rpb24gZXNjYXBlUmVnZXgoc3RyaW5nVG9Fc2NhcGU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHN0cmluZ1RvRXNjYXBlLnJlcGxhY2UoL1suKis/XiR7fSgpfFtcXF1cXFxcXS9nLCAnXFxcXCQmJyk7XG59O1xuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5jbGFzcyBEaWNlUm9sbGVyIHtcbiAgICBjaGVja0RpY2UoZGljZVN0cmluZzogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICBjb25zdCBkaWNlUmVnZXggPSAvXihcXGQrKT9kKFxcZCspKFtcXCtcXC1dXFxkKyk/KGUpPyhrXFxkKyk/KGtsXFxkKyk/JC9pO1xuICAgICAgcmV0dXJuIGRpY2VSZWdleC50ZXN0KGRpY2VTdHJpbmcpO1xuICAgIH07XG4gIFxuICAgIHJvbGxEaWNlKGRpY2VTdHJpbmc6IHN0cmluZyk6IG51bWJlciB7XG4gICAgICBpZiAoIXRoaXMuY2hlY2tEaWNlKGRpY2VTdHJpbmcpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlN5bnRheGUgZGUgbGFuY2VyIGRlIGRcdTAwRTlzIGludmFsaWRlLlwiKTtcbiAgICAgIH1cbiAgXG4gICAgICBjb25zdCBbXywgY291bnRTdHIsIHNpZGVzU3RyLCBtb2RpZmllclN0ciwgZXhwbG9kZVN0ciwga2VlcFN0ciwga2VlcExvd1N0cl0gPVxuICAgICAgICBkaWNlU3RyaW5nLm1hdGNoKFxuICAgICAgICAgIC9eKFxcZCspP2QoXFxkKykoW1xcK1xcLV1cXGQrKT8oZSk/KGtcXGQrKT8oa2xcXGQrKT8kL2lcbiAgICAgICAgKSBhcyBSZWdFeHBNYXRjaEFycmF5O1xuICBcbiAgICAgIGNvbnN0IGNvdW50ID0gcGFyc2VJbnQoY291bnRTdHIgfHwgXCIxXCIpO1xuICAgICAgY29uc3Qgc2lkZXMgPSBwYXJzZUludChzaWRlc1N0cik7XG4gICAgICBjb25zdCBtb2RpZmllciA9IHBhcnNlSW50KG1vZGlmaWVyU3RyIHx8IFwiMFwiKTtcbiAgICAgIGNvbnN0IGV4cGxvZGUgPSAhIWV4cGxvZGVTdHI7XG4gICAgICBjb25zdCBrZWVwID0ga2VlcFN0ciA/IHBhcnNlSW50KGtlZXBTdHIuc2xpY2UoMSkpIDogdW5kZWZpbmVkO1xuICAgICAgY29uc3Qga2VlcExvdyA9IGtlZXBMb3dTdHIgPyBwYXJzZUludChrZWVwTG93U3RyLnNsaWNlKDIpKSA6IHVuZGVmaW5lZDtcbiAgXG4gICAgICBsZXQgcmVzdWx0czogbnVtYmVyW10gPSBbXTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICBsZXQgcmVzdWx0ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogc2lkZXMpICsgMTtcbiAgICAgICAgcmVzdWx0cy5wdXNoKHJlc3VsdCk7XG4gIFxuICAgICAgICBpZiAoZXhwbG9kZSkge1xuICAgICAgICAgIHdoaWxlIChyZXN1bHQgPT09IHNpZGVzKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBzaWRlcykgKyAxO1xuICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHJlc3VsdCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gIFxuICAgICAgaWYgKGtlZXApIHtcbiAgICAgICAgcmVzdWx0cy5zb3J0KChhLCBiKSA9PiBiIC0gYSk7XG4gICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLnNsaWNlKDAsIGtlZXApO1xuICAgICAgfSBlbHNlIGlmIChrZWVwTG93KSB7XG4gICAgICAgIHJlc3VsdHMuc29ydCgoYSwgYikgPT4gYSAtIGIpO1xuICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5zbGljZSgwLCBrZWVwTG93KTtcbiAgICAgIH1cbiAgXG4gICAgICBjb25zdCBzdW0gPSByZXN1bHRzLnJlZHVjZSgoYWNjLCB2YWwpID0+IGFjYyArIHZhbCwgMCk7XG4gICAgICByZXR1cm4gc3VtICsgbW9kaWZpZXI7XG4gICAgfTtcbiAgXG4gICAgLyoqXG4gICAgICogUmVtcGxhY2UgbGVzIGxhbmNlcnMgZGUgZFx1MDBFOXMgZW5jYWRyXHUwMEU5cyBwYXIgZGVzIGRcdTAwRTlsaW1pdGV1cnMgZGFucyB1bmUgY2hhXHUwMEVFbmUgbXVsdGktbGlnbmVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQgTGUgdGV4dGUgbXVsdGktbGlnbmVzIGNvbnRlbmFudCBsZXMgbGFuY2VycyBkZSBkXHUwMEU5cy5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc3RhcnREZWxpbWl0ZXIgTGUgZFx1MDBFOWxpbWl0ZXVyIGRlIGRcdTAwRTlidXQgZGVzIGxhbmNlcnMgZGUgZFx1MDBFOXMuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGVuZERlbGltaXRlciBMZSBkXHUwMEU5bGltaXRldXIgZGUgZmluIGRlcyBsYW5jZXJzIGRlIGRcdTAwRTlzLlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IExlIHRleHRlIGF2ZWMgbGVzIGxhbmNlcnMgZGUgZFx1MDBFOXMgcmVtcGxhY1x1MDBFOXMgcGFyIGxldXJzIHJcdTAwRTlzdWx0YXRzLlxuICAgICAqL1xuICAgIHJlcGxhY2VEaWNlUm9sbHMoXG4gICAgICB0ZXh0OiBzdHJpbmcsXG4gICAgICBzdGFydERlbGltaXRlcjogc3RyaW5nLFxuICAgICAgZW5kRGVsaW1pdGVyOiBzdHJpbmdcbiAgICApOiBzdHJpbmcge1xuICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKFxuICAgICAgICBgJHt0aGlzLmVzY2FwZVJlZ0V4cChzdGFydERlbGltaXRlcil9KFteJHt0aGlzLmVzY2FwZVJlZ0V4cChcbiAgICAgICAgICBzdGFydERlbGltaXRlciArIGVuZERlbGltaXRlclxuICAgICAgICApfV0rKSR7dGhpcy5lc2NhcGVSZWdFeHAoZW5kRGVsaW1pdGVyKX1gLFxuICAgICAgICBcImdcIlxuICAgICAgKTtcbiAgXG4gICAgICByZXR1cm4gdGV4dC5yZXBsYWNlKHJlZ2V4LCAobWF0Y2gsIGRpY2VTdHJpbmcpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnJvbGxEaWNlKGRpY2VTdHJpbmcpO1xuICAgICAgICAgIHJldHVybiByZXN1bHQudG9TdHJpbmcoKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICByZXR1cm4gbWF0Y2g7IC8vIFNpIGxhIHN5bnRheGUgZXN0IGludmFsaWRlLCBvbiBnYXJkZSBsZSB0ZXh0ZSBkJ29yaWdpbmVcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgXG4gICAgLyoqXG4gICAgICogXHUwMEM5Y2hhcHBlIGxlcyBjYXJhY3RcdTAwRThyZXMgc3BcdTAwRTljaWF1eCBwb3VyIHVuZSB1dGlsaXNhdGlvbiBkYW5zIHVuZSBleHByZXNzaW9uIHJcdTAwRTlndWxpXHUwMEU4cmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nIExhIGNoYVx1MDBFRW5lIGRlIGNhcmFjdFx1MDBFOHJlcyBcdTAwRTAgXHUwMEU5Y2hhcHBlci5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBMYSBjaGFcdTAwRUVuZSBkZSBjYXJhY3RcdTAwRThyZXMgXHUwMEU5Y2hhcHBcdTAwRTllLlxuICAgICAqL1xuICAgIHByaXZhdGUgZXNjYXBlUmVnRXhwKHN0cmluZzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csIFwiXFxcXCQmXCIpO1xuICAgIH07XG4gIH07XG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbnR5cGUgTElSUExvZ1N0YXR1cyA9ICdkdXBJbk5vdGUnIHwgJ2R1cEluRm9sZGVyJyB8ICdlbXB0eUxpc3QnIHwgJ2VtcHR5Tm90ZScgfCAncmVmTGltaXQnIHwgJ3N1YlJlZkxpbWl0JyB8ICdwYXRoU2V0dGluZycgfCAnZm9sZGVyQW5kRmlsZScgfCAnc2hvd0l0ZW0nIHwgJ25vQWN0aXZlVmlldyc7XG50eXBlIExJUlBMb2dUeXBlID0gJ2Vycm9yJyB8ICd3YXJuaW5nJyB8ICdpbmZvJztcblxuY29uc3QgTElSUExvZ1N0YXR1c1ZhbHVlczogTElSUExvZ1N0YXR1c1tdID0gW1xuICAgICdkdXBJbk5vdGUnLFxuICAgICdkdXBJbkZvbGRlcicsXG4gICAgJ2VtcHR5TGlzdCcsXG4gICAgJ2VtcHR5Tm90ZScsXG4gICAgJ3JlZkxpbWl0JyxcbiAgICAnc3ViUmVmTGltaXQnLFxuICAgICdwYXRoU2V0dGluZycsXG4gICAgJ2ZvbGRlckFuZEZpbGUnLFxuICAgICdzaG93SXRlbScsXG4gICAgJ25vQWN0aXZlVmlldycsXG5dO1xuXG5jbGFzcyBMSVJQTG9nRWxlbWVudCB7XG4gICAgZmF0aGVyOiBzdHJpbmc7XG4gICAgY2hpbGQ6IHN0cmluZztcbiAgICBzdGF0dXM6IExJUlBMb2dTdGF0dXM7XG4gICAgY29tcGxlbWVudDogc3RyaW5nO1xuXG4gICAgc3RhdGljIGdldEVycm9yU3RhdHVzKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIFsnZHVwSW5Gb2xkZXInLCdwYXRoU2V0dGluZyddO1xuICAgIH07XG5cbiAgICBzdGF0aWMgZ2V0V2FybmluZ1N0YXR1cygpOiBzdHJpbmdbXSB7XG4gICAgICAgIGxldCB3YXJuaW5nU3RhdHVzOnN0cmluZ1tdID0gW107XG4gICAgICAgIExJUlBMb2dTdGF0dXNWYWx1ZXMubWFwKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoIUxJUlBMb2dFbGVtZW50LmdldEVycm9yU3RhdHVzKCkuY29udGFpbnMoZWxlbWVudCkgJiYgIUxJUlBMb2dFbGVtZW50LmdldFdhcm5pbmdTdGF0dXMoKS5jb250YWlucyhlbGVtZW50KSkge1xuICAgICAgICAgICAgICAgIHdhcm5pbmdTdGF0dXMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gd2FybmluZ1N0YXR1cztcbiAgICB9O1xuXG4gICAgc3RhdGljIGdldEluZm9TdGF0dXMoKTogc3RyaW5nW10ge1xuICAgICAgICByZXR1cm4gWydzaG93SXRlbScsJ3JlZkxpbWl0Jywnc3ViUmVmTGltaXQnXTtcbiAgICB9O1xuXG4gICAgZ2V0VHlwZSgpOiBMSVJQTG9nVHlwZSB7XG4gICAgICAgIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbJ3BhdGhTZXR0aW5nJywgJ2R1cEluRm9sZGVyJ107XG4gICAgICAgIGlmIChlcnJvcnMuY29udGFpbnModGhpcy5zdGF0dXMpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2Vycm9yJ1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICd3YXJuaW5nJ1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBjb25zdHJ1Y3RvciAoZmF0aGVyOiBzdHJpbmcsIGNoaWxkOiBzdHJpbmcsIHN0YXR1czogTElSUExvZ1N0YXR1cywgY29tcGxlbWVudDogc3RyaW5nID0gJycpIHtcbiAgICAgICAgdGhpcy5mYXRoZXIgPSBmYXRoZXI7XG4gICAgICAgIHRoaXMuY2hpbGQgPSBjaGlsZDtcbiAgICAgICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7XG4gICAgICAgIHRoaXMuY29tcGxlbWVudCA9IGNvbXBsZW1lbnQ7XG4gICAgfTtcblxuICAgIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgJHt0aGlzLmdldFR5cGUoKX0gLyAke3RoaXMuZmF0aGVyfSAvICR7dGhpcy5jaGlsZH0gLyAke3RoaXMuc3RhdHVzfSAvICR7dGhpcy5jb21wbGVtZW50fWA7XG4gICAgfTtcbn07XG5cbmNsYXNzIExJUlBMb2cge1xuICAgIGxvZ3M6IExJUlBMb2dFbGVtZW50W107XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5sb2dzID0gW107XG4gICAgfTtcbiAgICBcbiAgICBwdXNoKGZhdGhlcjogc3RyaW5nLCBjaGlsZDogc3RyaW5nLCBzdGF0dXM6IExJUlBMb2dTdGF0dXMsIGNvbXBsZW1lbnQ6IHN0cmluZyA9ICcnKTogdm9pZCB7XG4gICAgICAgIHRoaXMubG9ncy5wdXNoKG5ldyBMSVJQTG9nRWxlbWVudChmYXRoZXIsIGNoaWxkLCBzdGF0dXMsIGNvbXBsZW1lbnQpKTtcbiAgICB9O1xuXG4gICAgYWRkKGxvZ3M6IExJUlBMb2cpOnZvaWR7XG4gICAgICAgIHRoaXMubG9ncyA9IHRoaXMubG9ncy5jb25jYXQobG9ncy5sb2dzKTtcbiAgICB9O1xuXG4gICAgZ2V0KHR5cGU6IExJUlBMb2dUeXBlKTogc3RyaW5nW117XG4gICAgICAgIGNvbnN0IGxvZ3NGb3JUeXBlID0gdGhpcy5sb2dzLmZpbHRlcigoZWxlbWVudCkgPT4gXG4gICAgICAgICAgICBlbGVtZW50LmdldFR5cGUoKSA9PT0gdHlwZVxuICAgICAgICApO1xuICAgICAgICBsZXQgZ2V0QXJyYXk6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGxvZ3NGb3JUeXBlLm1hcCgoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgZ2V0QXJyYXkucHVzaChlbGVtZW50LnRvU3RyaW5nKCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGdldEFycmF5O1xuICAgIH07XG5cbiAgICBmbHVzaCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5sb2dzID0gW107XG4gICAgfTtcblxufTtcblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5pbnRlcmZhY2UgTElSUExpc3RJbnRlcmZhY2Uge1xuICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgICBpdGVtczogc3RyaW5nW107XG4gICAgZ2V0U3VnZ2VzdGlvbihub3RlTmFtZTogc3RyaW5nKTogTElSUFN1Z2dlc3Rpb25JbnRlcmZhY2U7XG4gICAgZmx1c2hMb2dzKCk6IHZvaWQ7XG4gICAgbm90SGlkZGVuKCk6IGJvb2xlYW47XG4gICAgcGlja1JhbmRvbUl0ZW0oKTogc3RyaW5nO1xuICAgIGdldExvZ3MoKTogTElSUExvZztcbn07XG5cbmNsYXNzIExJUlBMaXN0IGltcGxlbWVudHMgTElSUExpc3RJbnRlcmZhY2Uge1xuICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgICBoaWRkZW46IGJvb2xlYW47XG4gICAgaXRlbXM6IHN0cmluZ1tdO1xuICAgIGxvZ3M6IExJUlBMb2c7XG4gICAgbnVsbFZhbHVlOiBzdHJpbmc7XG4gICAgZXNjYXBlU3RyaW5nOiBzdHJpbmc7XG4gICAgY29tbWVudFN0cmluZzogc3RyaW5nO1xuXG4gICAgc3RhdGljIGdldFNldHRpbmdTdHJpbmcodmFsdWU6ICcnIHwgJ2hpZGUnIHwgJ2hpZGVfc3RyaW5nJyB8ICdoaWRlX3RpY2tlZCcgPSAnJyk6IHN0cmluZyB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gJycpIHtcbiAgICAgICAgICAgIHJldHVybiAnLSBbIF0gSGlkZSB0aGlzIGxpc3RcXG4nXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnaGlkZSc6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnXlxcLSBcXFxcW1t4IFxcXFw/XVxcXFxdIEhpZGUgdGhpcyBsaXN0JCc7XG4gICAgICAgICAgICAgICAgY2FzZSAnaGlkZV9zdHJpbmcnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ1xcLSBcXFxcW1t4ID9dXFxcXF0gSGlkZSB0aGlzIGxpc3QnO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2hpZGVfdGlja2VkJzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdeXFwtIFxcXFxbW3g/XVxcXFxdIEhpZGUgdGhpcyBsaXN0JCc7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBjb25zdHJ1Y3Rvcihub3RlTmFtZTogc3RyaW5nLCBsaW5lczogc3RyaW5nW10sIG51bGxWYWx1ZTogc3RyaW5nLCBlc2NhcGVTdHJpbmc6IHN0cmluZywgY29tbWVudFN0cmluZzogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMudGl0bGUgPSBcIlwiO1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gXCJcIjtcbiAgICAgICAgdGhpcy5oaWRkZW4gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pdGVtcyA9IFtdO1xuICAgICAgICB0aGlzLmxvZ3MgPSBuZXcgTElSUExvZygpO1xuICAgICAgICB0aGlzLm51bGxWYWx1ZSA9IG51bGxWYWx1ZTtcbiAgICAgICAgdGhpcy5lc2NhcGVTdHJpbmcgPSBlc2NhcGVTdHJpbmc7XG4gICAgICAgIHRoaXMuY29tbWVudFN0cmluZyA9IGNvbW1lbnRTdHJpbmc7XG5cbiAgICAgICAgY29uc3QgaGVhZGluZ1JlZ0V4ID0gL14jICsoLispJC87XG4gICAgICAgIHRoaXMudGl0bGUgPSBsaW5lc1swXS5yZXBsYWNlKGhlYWRpbmdSZWdFeCwgXCIkMVwiKTtcbiAgICAgICAgbGluZXMuc2hpZnQoKTtcbiAgICAgICAgY29uc3QgbGlzdEJlZ2luSXRlbVN0cmluZyA9IGBeKD8hJHtMSVJQTGlzdC5nZXRTZXR0aW5nU3RyaW5nKCdoaWRlX3N0cmluZycpfSkgezAsM30oLXxcXFxcZCtcXC58XFxcXCopICsoLispJGA7XG4gICAgICAgIGNvbnN0IGxpc3RCZWdpbkl0ZW1SZWdleCA9IG5ldyBSZWdFeHAobGlzdEJlZ2luSXRlbVN0cmluZyk7XG4gICAgICAgIGNvbnN0IGxpc3RCZWdpbkluZGV4ZXMgPSBmaW5kSW5kZXhlcyhsaW5lcywgKGVsZW1lbnQpID0+IGxpc3RCZWdpbkl0ZW1SZWdleC50ZXN0KGVsZW1lbnQpKTtcbiAgICAgICAgaWYgKGxpc3RCZWdpbkluZGV4ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ3MucHVzaChub3RlTmFtZSwgdGhpcy50aXRsZSwgJ2VtcHR5TGlzdCcpO1xuICAgICAgICAgICAgdGhpcy5oaWRkZW4gPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNsZWFuTGluZXMgPSBsaW5lcy5tYXAoKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50LnJlcGxhY2UobGlzdEJlZ2luSXRlbVJlZ2V4LCBcIiQyXCIpXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAobGlzdEJlZ2luSW5kZXhlc1swXSAhPT0gMCkge1xuICAgICAgICAgICAgbGV0IG1kRGVzY3JpcHRpb24gPSBjbGVhbkxpbmVzLnNsaWNlKDAsIGxpc3RCZWdpbkluZGV4ZXNbMF0pO1xuICAgICAgICAgICAgLy8gdGFraW5nIGNhcmUgb2YgTUQwMjJcbiAgICAgICAgICAgIC8vICAgTUQwMjIvYmxhbmtzLWFyb3VuZC1oZWFkaW5nczogSGVhZGluZ3Mgc2hvdWxkIGJlIHN1cnJvdW5kZWQgYnkgYmxhbmsgbGluZXNcbiAgICAgICAgICAgIGlmIChtZERlc2NyaXB0aW9uWzBdID09PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgbWREZXNjcmlwdGlvbi5zaGlmdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gdGFraW5nIGNhcmUgb2YgTUQwMzJcbiAgICAgICAgICAgIC8vICAgTUQwMzIvYmxhbmtzLWFyb3VuZC1saXN0czogTGlzdHMgc2hvdWxkIGJlIHN1cnJvdW5kZWQgYnkgYmxhbmsgbGluZXNcbiAgICAgICAgICAgIC8vIER1ZSB0byBzcGxpdCBvbiAnXFxuJywgdGhlIHNsaWNlLCBhbmQgYXQgbGVhc3QgYSBqb2luIG9uICdcXG4nIHRoZSBsYXN0ICdcXG4nIGlzIGFsd2F5cyBsb3N0ICFcbiAgICAgICAgICAgIC8vIFNvIHRoZSBmb2xvd2luZyBjb2RlIGlzIHVzZWxlc3NcbiAgICAgICAgICAgIC8vIGlmIChtZERlc2NyaXB0aW9uLmF0KC0xKSA9PT0gXCJcIikge1xuICAgICAgICAgICAgLy8gICAgIG1kRGVzY3JpcHRpb24ucG9wKCk7XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICBsZXQgaXNIaWRkZW46IGJvb2xlYW4gPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IGhpZGVSZWdleFRpY2tlZCA9IG5ldyBSZWdFeHAgKExJUlBMaXN0LmdldFNldHRpbmdTdHJpbmcoJ2hpZGVfdGlja2VkJykpO1xuICAgICAgICAgICAgY29uc3QgaGlkZVJlZ2V4ID0gbmV3IFJlZ0V4cCAoTElSUExpc3QuZ2V0U2V0dGluZ1N0cmluZygnaGlkZScpKTtcbiAgICAgICAgICAgIG1kRGVzY3JpcHRpb24ubWFwKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGhpZGVSZWdleFRpY2tlZC50ZXN0KGVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzSGlkZGVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oaWRkZW4gPSBpc0hpZGRlbjtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBtZERlc2NyaXB0aW9uID0gbWREZXNjcmlwdGlvbi5maWx0ZXIoKGVsZW1lbnQpID0+ICEoaGlkZVJlZ2V4LnRlc3QoZWxlbWVudCkpKTtcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBtZERlc2NyaXB0aW9uLmpvaW4oJ1xcbicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IFwiXCI7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBsaXN0QmVnaW5Db3VudCA9IGxpc3RCZWdpbkluZGV4ZXMubGVuZ3RoXG4gICAgICAgIGxldCBpdGVtOiBzdHJpbmdbXTtcbiAgICAgICAgZm9yIChsZXQgY3VycmVudEluZGV4ID0gMDsgY3VycmVudEluZGV4IDwgKGxpc3RCZWdpbkNvdW50IC0gMSk7IGN1cnJlbnRJbmRleCsrKSB7XG4gICAgICAgICAgICBpdGVtID0gKGNsZWFuTGluZXMuc2xpY2UobGlzdEJlZ2luSW5kZXhlc1tjdXJyZW50SW5kZXhdLCBsaXN0QmVnaW5JbmRleGVzW2N1cnJlbnRJbmRleCArIDFdKSk7XG4gICAgICAgICAgICB0aGlzLnB1c2hJdGVtQmFzZWRPbldlaWdodChpdGVtKTtcbiAgICAgICAgfVxuICAgICAgICBpdGVtID0gKGNsZWFuTGluZXMuc2xpY2UobGlzdEJlZ2luSW5kZXhlc1tsaXN0QmVnaW5Db3VudCAtIDFdKSk7XG4gICAgICAgIC8vIHRha2luZyBjYXJlIG9mIE1EMDIyXG4gICAgICAgIC8vICAgTUQwMjIvYmxhbmtzLWFyb3VuZC1oZWFkaW5nczogSGVhZGluZ3Mgc2hvdWxkIGJlIHN1cnJvdW5kZWQgYnkgYmxhbmsgbGluZXNcbiAgICAgICAgaWYgKGl0ZW0uYXQoLTEpID09PSBcIlwiKSB7XG4gICAgICAgICAgICBpdGVtLnBvcCgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHVzaEl0ZW1CYXNlZE9uV2VpZ2h0KGl0ZW0pO1xuICAgIH07XG5cbiAgICBmbHVzaExvZ3MoKTogdm9pZCB7XG4gICAgICAgIHRoaXMubG9ncy5mbHVzaCgpXG4gICAgfTtcblxuICAgIHB1c2hJdGVtQmFzZWRPbldlaWdodChpdGVtOiBzdHJpbmdbXSk6IHZvaWQge1xuICAgICAgICBjb25zdCBJdGVtV2l0aFdlaWdodFJlZ0V4ID0gL15cXCgoXFxkKylcXClcXHMrKC4rKSQvO1xuICAgICAgICBsZXQgcmVnRXhFeGVjdXRpb247XG4gICAgICAgIGxldCByZXBlYXQ6IG51bWJlcjtcbiAgICAgICAgaWYgKChyZWdFeEV4ZWN1dGlvbiA9IEl0ZW1XaXRoV2VpZ2h0UmVnRXguZXhlYyhpdGVtWzBdKSkgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHJlcGVhdCA9IE51bWJlcihyZWdFeEV4ZWN1dGlvblsxXSk7XG4gICAgICAgICAgICBpdGVtWzBdID0gcmVnRXhFeGVjdXRpb25bMl07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXBlYXQgPSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpdGVtWzBdID09PSB0aGlzLm51bGxWYWx1ZSkge1xuICAgICAgICAgICAgaWYgKGl0ZW0ubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgaXRlbVswXSA9IFwiXCI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGl0ZW0uc2hpZnQoKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZXNjYXBlU3RyaW5nUmVnZXggPSBgXiAqJHt0aGlzLmVzY2FwZVN0cmluZ30oLiopYDtcbiAgICAgICAgY29uc3QgZXNjYXBlU3RyaW5nUmVnRXggPSBuZXcgUmVnRXhwKGVzY2FwZVN0cmluZ1JlZ2V4LCAnZ20nKTtcbiAgICAgICAgY29uc3QgZXNjYXBlSXRlbSA9IGl0ZW0ubWFwKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudC5yZXBsYWNlKGVzY2FwZVN0cmluZ1JlZ0V4LCAnJDEnKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGxldCBzdHJpbmdJdGVtID0gZXNjYXBlSXRlbS5qb2luKCdcXG4nKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXBlYXQ7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKHN0cmluZ0l0ZW0pO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGdldFN1Z2dlc3Rpb24obm90ZU5hbWU6IHN0cmluZyk6IExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbiA9IHtcbiAgICAgICAgICAgIG5vdGVOYW1lOiBub3RlTmFtZSxcbiAgICAgICAgICAgIHRpdGxlOiB0aGlzLnRpdGxlLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246ICh0aGlzLmRlc2NyaXB0aW9uLnNwbGl0KCdcXG4nKVswXSksXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb247XG4gICAgfTtcblxuICAgIG5vdEhpZGRlbigpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLmhpZGRlbjtcbiAgICB9O1xuXG4gICAgcGlja1JhbmRvbUl0ZW0oKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IHJhbmRvbUl0ZW06IHN0cmluZyA9IFwiXCI7XG4gICAgICAgIGlmICh0aGlzLml0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJhbmRvbUl0ZW0gPSB0aGlzLml0ZW1zW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMuaXRlbXMubGVuZ3RoKV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJhbmRvbUl0ZW07XG4gICAgfTtcblxuICAgIGdldExvZ3MoKTogTElSUExvZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvZ3M7XG4gICAgfTtcblxuICAgIGdldCBsZW5ndGgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlbXMubGVuZ3RoO1xuICAgIH07XG5cbn07XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuaW50ZXJmYWNlIExJUlBEb1JlZlN1YkludGVyZmFjZSB7XG4gICAgbGFzdExpc3RUaXRsZTogc3RyaW5nO1xuICAgIG1vZGlmaWVkVGV4dDogc3RyaW5nO1xufTtcblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5pbnRlcmZhY2UgTElSUE5vdGVJbnRlcmZhY2Uge1xuICAgIGxvYWRGcm9tTm90ZShub3RlTmFtZTogc3RyaW5nLCBub3RlQ29udGVudDogc3RyaW5nKTogYm9vbGVhbjtcbiAgICBnZXRMaXN0U3VnZ2VzdGlvbigpOiBMSVJQU3VnZ2VzdGlvbkxpc3Q7XG4gICAgcGlja1JhbmRvbUl0ZW1Gcm9tTGlzdChsaXN0VGl0bGU6IHN0cmluZywgd29ya09uUmVmZXJlbmNlOiBib29sZWFuKTogc3RyaW5nOyBcbiAgICBnZXRMb2dzKCk6IExJUlBMb2c7XG4gICAgZ2V0TGlzdFRpdGxlcygpIDogc3RyaW5nW107XG4gICAgZmx1c2hMb2dzKCk6IHZvaWQ7XG59O1xuXG5jbGFzcyBMSVJQTm90ZSBpbXBsZW1lbnRzIExJUlBOb3RlSW50ZXJmYWNlIHtcbiAgICBub3RlTmFtZTogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgbGlzdDogTElSUExpc3RbXTtcbiAgICBsb2dzOiBMSVJQTG9nO1xuICAgIG51bGxWYWx1ZTogc3RyaW5nO1xuICAgIGVzY2FwZVN0cmluZzogc3RyaW5nO1xuICAgIGNvbW1lbnRTdHJpbmc6IHN0cmluZztcbiAgICByb2xsRGljZTogYm9vbGVhbjtcbiAgICBrZWVwQ29tbWVudDogYm9vbGVhbjtcbiAgICByZWZlcmVuY2VNYXhEZXB0aDogbnVtYmVyO1xuXG4gICAgc3RhdGljIGdldFNldHRpbmdTdHJpbmcodmFsdWU6ICcnIHwgJ2RlbGV0ZUNvbW1lbnQnIHwgJ2RlbGV0ZUNvbW1lbnRfdGlja2VkJyA9ICcnKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSAnJykge1xuICAgICAgICAgICAgcmV0dXJuICctIFsgXSBEbyBub3QgcHJlc2VydmUgY29tbWVudHNcXG4nXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnZGVsZXRlQ29tbWVudCc6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnXlxcLSBcXFxcW1t4ID9dXFxcXF0gRG8gbm90IHByZXNlcnZlIGNvbW1lbnRzJCc7XG4gICAgICAgICAgICAgICAgY2FzZSAnZGVsZXRlQ29tbWVudF90aWNrZWQnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ15cXC0gXFxcXFtbeD9dXFxcXF0gRG8gbm90IHByZXNlcnZlIGNvbW1lbnRzJCc7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBjb25zdHJ1Y3RvciAobnVsbFZhbHVlOiBzdHJpbmcsIGVzY2FwZVN0cmluZzogc3RyaW5nLCBjb21tZW50U3RyaW5nOiBzdHJpbmcsIHJlZmVyZW5jZU1heERlcHRoOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5ub3RlTmFtZSA9IFwiXCI7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBcIlwiO1xuICAgICAgICB0aGlzLmxpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5sb2dzID0gbmV3IExJUlBMb2coKTtcbiAgICAgICAgdGhpcy5udWxsVmFsdWUgPSBudWxsVmFsdWU7XG4gICAgICAgIHRoaXMuZXNjYXBlU3RyaW5nID0gZXNjYXBlU3RyaW5nO1xuICAgICAgICB0aGlzLmNvbW1lbnRTdHJpbmcgPSBjb21tZW50U3RyaW5nO1xuICAgICAgICB0aGlzLnJvbGxEaWNlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VNYXhEZXB0aCA9IHJlZmVyZW5jZU1heERlcHRoO1xuICAgICAgICB0aGlzLmtlZXBDb21tZW50ID0gdHJ1ZTtcbiAgICB9O1xuXG4gICAgZ2V0TGlzdFRpdGxlcygpIDogc3RyaW5nW10ge1xuICAgICAgICBsZXQgbGlzdFRpdGxlczpzdHJpbmdbXSA9IFtdO1xuICAgICAgICB0aGlzLmxpc3QubWFwKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBsaXN0VGl0bGVzLnB1c2goZWxlbWVudC50aXRsZSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbGlzdFRpdGxlcztcbiAgICB9O1xuXG4gICAgd29ya1dpdGhDb21tZW50ICh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICAvLyBsZXQncyBkZWZpbmUgc29tZSByZWdleFxuICAgICAgICBjb25zdCB0aWNrU2V0dGluZ1JlZ0V4ID0gbmV3IFJlZ0V4cChMSVJQTm90ZS5nZXRTZXR0aW5nU3RyaW5nKCdkZWxldGVDb21tZW50X3RpY2tlZCcpKTtcbiAgICAgICAgY29uc3QgaGVhZGluZ1JlZ2V4ID0gL14jIC4rJC87XG4gICAgICAgIGNvbnN0IGNvbW1lbnRMaW5lU3RyaW5nID0gYF4ke3RoaXMuY29tbWVudFN0cmluZ30kYDtcbiAgICAgICAgY29uc3QgY29tbWVudExpbmVSZWdleCA9IG5ldyBSZWdFeHAoY29tbWVudExpbmVTdHJpbmcpO1xuICAgICAgICBjb25zdCBjb21tZW50QmxvY2sgPSBgJHt0aGlzLmNvbW1lbnRTdHJpbmd9Lio/JHt0aGlzLmNvbW1lbnRTdHJpbmd9YDtcbiAgICAgICAgY29uc3QgY29tbWVudEJsb2NrUmVnZXggPSBuZXcgUmVnRXhwKGNvbW1lbnRCbG9jayk7XG4gICAgICAgIC8vIGxldCdzIGZpbmQgc2V0dGluZ3NcbiAgICAgICAgY29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgY29uc3Qgc2V0dGluZ0luZGV4ID0gZmluZEluZGV4ZXMobGluZXMsKGVsZW1lbnQpID0+IHRpY2tTZXR0aW5nUmVnRXgudGVzdChlbGVtZW50KSk7XG4gICAgICAgIGNvbnN0IGNvbW1lbnRMaW5lSW5kZXggPSBmaW5kSW5kZXhlcyhsaW5lcywoZWxlbWVudCkgPT4gY29tbWVudExpbmVSZWdleC50ZXN0KGVsZW1lbnQpKTtcbiAgICAgICAgY29uc3QgaGVhZGluZ0luZGV4ID0gZmluZEluZGV4ZXMobGluZXMsKGVsZW1lbnQpID0+IGhlYWRpbmdSZWdleC50ZXN0KGVsZW1lbnQpKTtcbiAgICAgICAgLy8gc2kgcGFzIGRlIHRpdHJlIG9uIHRvdWNoZSBcdTAwRTAgcmllblxuICAgICAgICBpZiAoaGVhZGluZ0luZGV4Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRleHQ7XG4gICAgICAgIH07XG4gICAgICAgIGlmICgoc2V0dGluZ0luZGV4Lmxlbmd0aCA9PT0gMCkgfHwgKHNldHRpbmdJbmRleFswXSA+IGhlYWRpbmdJbmRleFswXSkpIHtcbiAgICAgICAgICAgIC8vIHNpIHBhcyBkZSBzZXR0aW5ncyBvdSBzZXR0aW5ncyBhcHJcdTAwRThzIGxlIHByZW1pZXIgdGl0cmUgMVxuICAgICAgICAgICAgdGhpcy5rZWVwQ29tbWVudCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBpbnRcdTAwRTlncmVyIGluZGV4QmV0d2VlbkZpbmRJbmRleGVzXG4gICAgICAgICAgICB0aGlzLmtlZXBDb21tZW50ID0gaW5kZXhJc0JldHdlZW5GaW5kSW5kZXhlcyhzZXR0aW5nSW5kZXhbMF0sY29tbWVudExpbmVJbmRleClcbiAgICAgICAgICAgIC8vIHNpbm9uIGtlZXBpbmRlXG4gICAgICAgIH1cbiAgICAgICAgbGV0IGluc2lkZUNvbW1lbnQgPSBmYWxzZTtcbiAgICAgICAgY29uc3QgbmV3TGluZXM6c3RyaW5nW10gPSBbXTtcbiAgICAgICAgbGluZXMubWFwKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBsZXQgaXNBQ29tbWVudExpbmUgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChjb21tZW50TGluZVJlZ2V4LnRlc3QoZWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICBpbnNpZGVDb21tZW50ID0gIWluc2lkZUNvbW1lbnQ7XG4gICAgICAgICAgICAgICAgaXNBQ29tbWVudExpbmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGluc2lkZUNvbW1lbnQgfHwgaXNBQ29tbWVudExpbmUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5rZWVwQ29tbWVudCkge1xuICAgICAgICAgICAgICAgICAgICBuZXdMaW5lcy5wdXNoKHRoaXMuZXNjYXBlU3RyaW5nICsgZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMua2VlcENvbW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3TGluZXMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBuZXdMaW5lcy5wdXNoKGVsZW1lbnQucmVwbGFjZShjb21tZW50QmxvY2tSZWdleCwnJykpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG5ld0xpbmVzLmpvaW4oJ1xcbicpO1xuICAgIH07XG5cbiAgICBsb2FkRnJvbU5vdGUobm90ZU5hbWU6IHN0cmluZywgbm90ZUNvbnRlbnQ6IHN0cmluZywgKTogYm9vbGVhbiB7XG4gICAgICAgIHRoaXMubm90ZU5hbWUgPSBub3RlTmFtZTtcbiAgICAgICAgbGV0IGxpbmVzOnN0cmluZ1tdID0gW107XG4gICAgICAgIGxpbmVzID0gdGhpcy53b3JrV2l0aENvbW1lbnQobm90ZUNvbnRlbnQpLnNwbGl0KCdcXG4nKTtcbiAgICAgICAgaWYgKGxpbmVzWzBdID09PSAnJykge1xuICAgICAgICAgICAgLy8gdGFraW5nIGNhcmUgb2YgTUQwMjJcbiAgICAgICAgICAgIC8vIERyb3AgdGhlIGZpcnN0IGxpbmUgb2YgdGhlIG5vdGUgaWYgaXQncyBhbiBlbXB0eSBvbmUsXG4gICAgICAgICAgICAvLyBiZWNhdXNlIHRlY2huaWNhbGx5IE5vdGUgdGl0bGUgaXMgYSBoZWFkaW5nIG9uZVxuICAgICAgICAgICAgbGluZXMuc2hpZnQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaGVhZGluZ1JlZ2V4ID0gL14jIC4rJC87XG4gICAgICAgIGxldCBoZWFkaW5nSW5kZXhlcyA9IGZpbmRJbmRleGVzKGxpbmVzLCAoZWxlbWVudCkgPT4gaGVhZGluZ1JlZ2V4LnRlc3QoZWxlbWVudCkpO1xuICAgICAgICBpZiAoaGVhZGluZ0luZGV4ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ3MucHVzaChub3RlTmFtZSwgJycsICdlbXB0eU5vdGUnKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaGVhZGluZ0luZGV4ZXNbMF0gIT09IDApIHtcbiAgICAgICAgICAgIC8vIHRha2luZyBjYXJlIG9mIE1EMDIyXG4gICAgICAgICAgICAvLyAgIE1EMDIyL2JsYW5rcy1hcm91bmQtaGVhZGluZ3M6IEhlYWRpbmdzIHNob3VsZCBiZSBzdXJyb3VuZGVkIGJ5IGJsYW5rIGxpbmVzXG4gICAgICAgICAgICAvLyBEdWUgdG8gc3BsaXQgb24gJ1xcbicsIHRoZSBzbGljZSwgYW5kIGF0IGxlYXN0IGEgam9pbiBvbiAnXFxuJyB0aGUgbGFzdCAnXFxuJyBpcyBhbHdheXMgbG9zdCAhICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBsZXQgbWREZXNjcmlwdGlvbiA9IGxpbmVzLnNsaWNlKDAsIGhlYWRpbmdJbmRleGVzWzBdKTtcbiAgICAgICAgICAgIGNvbnN0IGRlbGV0ZVJlZ2V4ID0gbmV3IFJlZ0V4cCAoTElSUE5vdGUuZ2V0U2V0dGluZ1N0cmluZygnZGVsZXRlQ29tbWVudCcpKTtcbiAgICAgICAgICAgIG1kRGVzY3JpcHRpb24gPSBtZERlc2NyaXB0aW9uLmZpbHRlcigoZWxlbWVudCkgPT4gIShkZWxldGVSZWdleC50ZXN0KGVsZW1lbnQpKSk7XG4gICAgICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gbWREZXNjcmlwdGlvbi5qb2luKCdcXG4nKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBoZWFkaW5nQ291bnQgPSBoZWFkaW5nSW5kZXhlcy5sZW5ndGg7XG4gICAgICAgIGxldCBwdXNoU3VjY2Vzczpib29sZWFuID0gdHJ1ZTtcbiAgICAgICAgZm9yIChsZXQgY3VycmVudEluZGV4ID0gMDsgY3VycmVudEluZGV4IDwgKGhlYWRpbmdDb3VudCAtIDEpOyBjdXJyZW50SW5kZXgrKykge1xuICAgICAgICAgICAgICAgIHB1c2hTdWNjZXNzID0gdGhpcy5wdXNoTGlzdElmTm90RXhpc3RzKG5ldyBMSVJQTGlzdCh0aGlzLm5vdGVOYW1lLCBsaW5lcy5zbGljZShoZWFkaW5nSW5kZXhlc1tjdXJyZW50SW5kZXhdLCBoZWFkaW5nSW5kZXhlc1tjdXJyZW50SW5kZXggKyAxXSksIHRoaXMubnVsbFZhbHVlLCB0aGlzLmVzY2FwZVN0cmluZywgdGhpcy5jb21tZW50U3RyaW5nKSkgJiYgcHVzaFN1Y2Nlc3M7XG4gICAgICAgIH07XG4gICAgICAgICBwdXNoU3VjY2VzcyA9IHRoaXMucHVzaExpc3RJZk5vdEV4aXN0cyhuZXcgTElSUExpc3QodGhpcy5ub3RlTmFtZSwgbGluZXMuc2xpY2UoaGVhZGluZ0luZGV4ZXNbaGVhZGluZ0NvdW50IC0gMV0pLCB0aGlzLm51bGxWYWx1ZSwgdGhpcy5lc2NhcGVTdHJpbmcsIHRoaXMuY29tbWVudFN0cmluZykpICYmIHB1c2hTdWNjZXNzO1xuICAgICAgICAgcmV0dXJuIHB1c2hTdWNjZXNzO1xuICAgIH07XG5cbiAgICBwdXNoTGlzdElmTm90RXhpc3RzKGxpc3RUb1B1c2g6IExJUlBMaXN0KTogYm9vbGVhbiB7XG4gICAgICAgIGlmICh0aGlzLmdldExpc3RUaXRsZXMoKS5jb250YWlucyhsaXN0VG9QdXNoLnRpdGxlKSkge1xuICAgICAgICAgICAgdGhpcy5sb2dzLnB1c2godGhpcy5ub3RlTmFtZSwgbGlzdFRvUHVzaC50aXRsZSwgJ2R1cEluTm90ZScpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5saXN0LnB1c2gobGlzdFRvUHVzaCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgZ2V0TGlzdFN1Z2dlc3Rpb24od2l0aEhpZGRlbjogYm9vbGVhbiA9IGZhbHNlKTogTElSUFN1Z2dlc3Rpb25MaXN0IHtcbiAgICAgICAgY29uc3Qgbm90ZVN1Z2dlc3Rpb24gPSBuZXcgTElSUFN1Z2dlc3Rpb25MaXN0KCk7XG4gICAgICAgIHRoaXMubGlzdC5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAod2l0aEhpZGRlbiB8fCBlbGVtZW50Lm5vdEhpZGRlbigpKSB7XG4gICAgICAgICAgICAgICAgbm90ZVN1Z2dlc3Rpb24ucHVzaChlbGVtZW50LmdldFN1Z2dlc3Rpb24odGhpcy5ub3RlTmFtZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG5vdGVTdWdnZXN0aW9uO1xuICAgIH07XG5cbiAgICBkb1JlZmVyZW5jZVN1YnN0aXR1dGlvbih0ZXh0OiBzdHJpbmcpOiBMSVJQRG9SZWZTdWJJbnRlcmZhY2Uge1xuICAgICAgICBsZXQgbWF0Y2g7XG4gICAgICAgIGxldCBtb2RpZmllZFRleHQ6c3RyaW5nID0gdGV4dDtcbiAgICAgICAgbGV0IGxpc3RUaXRsZTpzdHJpbmcgPSBcIlwiO1xuICAgICAgICBjb25zdCBzdHJpbmdSZWZSZWdleDogc3RyaW5nID0gYFxceygke3RoaXMubGlzdC5tYXAoKGVsZW1lbnQpID0+IGVzY2FwZVJlZ2V4KGVsZW1lbnQudGl0bGUpKS5qb2luKCd8Jyl9KVxcfWA7XG4gICAgICAgIGZvciAobGV0IHJlcGVhdCA9IDA7IHJlcGVhdCA8IHRoaXMucmVmZXJlbmNlTWF4RGVwdGg7IHJlcGVhdCsrKSB7XG4gICAgICAgICAgICBjb25zdCByZWZSZWdleCA9IG5ldyBSZWdFeHAgKHN0cmluZ1JlZlJlZ2V4LCdtZycpO1xuICAgICAgICAgICAgd2hpbGUgKChtYXRjaCA9IHJlZlJlZ2V4LmV4ZWMobW9kaWZpZWRUZXh0KSkgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBsZXQgbmV3VmFsdWU6IHN0cmluZyA9IHRoaXMucGlja1JhbmRvbUl0ZW1Gcm9tTGlzdChtYXRjaFsxXSwgZmFsc2UpOyBcbiAgICAgICAgICAgICAgICBsaXN0VGl0bGUgPSBtYXRjaFswXTtcbiAgICAgICAgICAgICAgICBtb2RpZmllZFRleHQgPSBtb2RpZmllZFRleHQucmVwbGFjZShsaXN0VGl0bGUsIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICByZWZSZWdleC5sYXN0SW5kZXggPSBtYXRjaC5pbmRleCArIG5ld1ZhbHVlLmxlbmd0aDtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLnJvbGxEaWNlKSB7XG4gICAgICAgICAgICBjb25zdCBkaWNlUm9sbGVyID0gbmV3IERpY2VSb2xsZXIoKTtcbiAgICAgICAgICAgIG1vZGlmaWVkVGV4dCA9IGRpY2VSb2xsZXIucmVwbGFjZURpY2VSb2xscyhtb2RpZmllZFRleHQsJ3snLCd9Jyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGxhc3RMaXN0VGl0bGU6IGxpc3RUaXRsZSxcbiAgICAgICAgICAgIG1vZGlmaWVkVGV4dDogbW9kaWZpZWRUZXh0LFxuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBmbHVzaExvZ3MoKTogdm9pZCB7XG4gICAgICAgIHRoaXMubG9ncy5mbHVzaCgpO1xuICAgICAgICB0aGlzLmxpc3QubWFwKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBlbGVtZW50LmZsdXNoTG9ncygpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcGlja1JhbmRvbUl0ZW1Gcm9tTGlzdChsaXN0VGl0bGU6IHN0cmluZywgd29ya09uUmVmZXJlbmNlOiBib29sZWFuID0gdHJ1ZSk6IHN0cmluZyB7XG4gICAgICAgIGxldCByYW5kb21JdGVtOiBzdHJpbmcgPSBcIlwiO1xuICAgICAgICBsZXQgcmV0dXJuT2ZEb0V4ZWNTdWI6IExJUlBEb1JlZlN1YkludGVyZmFjZSA9IHtcbiAgICAgICAgICAgIGxhc3RMaXN0VGl0bGU6IGxpc3RUaXRsZSxcbiAgICAgICAgICAgIG1vZGlmaWVkVGV4dDogXCJcIixcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgY3VycmVudExpc3QgPSB0aGlzLmxpc3QuZmluZCgoZWxlbWVudCkgPT4gZWxlbWVudC50aXRsZSA9PT0gbGlzdFRpdGxlKTtcbiAgICAgICAgaWYgKGN1cnJlbnRMaXN0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJhbmRvbUl0ZW0gPSBjdXJyZW50TGlzdC5waWNrUmFuZG9tSXRlbSgpO1xuICAgICAgICAgICAgaWYgKHdvcmtPblJlZmVyZW5jZSkge1xuICAgICAgICAgICAgICAgIHJldHVybk9mRG9FeGVjU3ViID0gdGhpcy5kb1JlZmVyZW5jZVN1YnN0aXR1dGlvbihyYW5kb21JdGVtKTtcbiAgICAgICAgICAgICAgICByYW5kb21JdGVtID0gcmV0dXJuT2ZEb0V4ZWNTdWIubW9kaWZpZWRUZXh0O1xuICAgICAgICAgICAgICAgIGNvbnN0IHN0cmluZ1JlZlJlZ2V4OiBzdHJpbmcgPSBgXFx7KCR7dGhpcy5saXN0Lm1hcCgoZWxlbWVudCkgPT4gZXNjYXBlUmVnZXgoZWxlbWVudC50aXRsZSkpLmpvaW4oJ3wnKX0pXFx9YDtcbiAgICAgICAgICAgICAgICBjb25zdCBSZWZSZWdleCA9IG5ldyBSZWdFeHAgKHN0cmluZ1JlZlJlZ2V4KTtcbiAgICAgICAgICAgICAgICBpZiAoUmVmUmVnZXgudGVzdChyYW5kb21JdGVtKSAmJiB3b3JrT25SZWZlcmVuY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJldHVybk9mRG9FeGVjU3ViLmxhc3RMaXN0VGl0bGUgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5PZkRvRXhlY1N1Yi5sYXN0TGlzdFRpdGxlID0gbGlzdFRpdGxlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9ncy5wdXNoKHRoaXMubm90ZU5hbWUsIHJldHVybk9mRG9FeGVjU3ViLmxhc3RMaXN0VGl0bGUsICdyZWZMaW1pdCcpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIHJhbmRvbUl0ZW07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgZ2V0TG9ncygpOiBMSVJQTG9nIHtcbiAgICAgICAgbGV0IGFsbExvZ3MgPSBuZXcgTElSUExvZztcbiAgICAgICAgYWxsTG9ncy5hZGQodGhpcy5sb2dzKTtcbiAgICAgICAgdGhpcy5saXN0Lm1hcCgoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgYWxsTG9ncy5hZGQoZWxlbWVudC5nZXRMb2dzKCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGFsbExvZ3M7XG4gICAgfTtcblxuICAgIGdldCBsZW5ndGgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdC5sZW5ndGg7XG4gICAgfTtcbn07XG5cbmNsYXNzIExJUlBNdWx0aU5vdGUgaW1wbGVtZW50cyBMSVJQTm90ZUludGVyZmFjZSB7XG4gICAgbXVsdGlOb3RlOiBMSVJQTm90ZVtdO1xuICAgIG51bGxWYWx1ZTogc3RyaW5nO1xuICAgIGVzY2FwZVN0cmluZzogc3RyaW5nO1xuICAgIGNvbW1lbnRTdHJpbmc6IHN0cmluZztcbiAgICByZWZlcmVuY2VNYXhEZXB0aDogbnVtYmVyO1xuICAgIGxvZ3M6IExJUlBMb2c7XG5cbiAgICBjb25zdHJ1Y3RvciAobnVsbFZhbHVlOiBzdHJpbmcsIGVzY2FwZVN0cmluZzogc3RyaW5nLCBjb21tZW50U3RyaW5nOiBzdHJpbmcsIHJlZmVyZW5jZU1heERlcHRoOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5tdWx0aU5vdGUgPSBbXTtcbiAgICAgICAgdGhpcy5udWxsVmFsdWUgPSBudWxsVmFsdWU7XG4gICAgICAgIHRoaXMuZXNjYXBlU3RyaW5nID0gZXNjYXBlU3RyaW5nO1xuICAgICAgICB0aGlzLmNvbW1lbnRTdHJpbmcgPSBjb21tZW50U3RyaW5nO1xuICAgICAgICB0aGlzLnJlZmVyZW5jZU1heERlcHRoID0gcmVmZXJlbmNlTWF4RGVwdGg7XG4gICAgICAgIHRoaXMubG9ncyA9IG5ldyBMSVJQTG9nKCk7XG4gICAgfTtcblxuICAgIGxvYWRGcm9tTm90ZShub3RlTmFtZTogc3RyaW5nLCBub3RlQ29udGVudDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnROb3RlID0gbmV3IExJUlBOb3RlKHRoaXMubnVsbFZhbHVlLCB0aGlzLmVzY2FwZVN0cmluZywgdGhpcy5jb21tZW50U3RyaW5nLCB0aGlzLnJlZmVyZW5jZU1heERlcHRoKTtcbiAgICAgICAgbGV0IHN0YXR1cyA9IGN1cnJlbnROb3RlLmxvYWRGcm9tTm90ZShub3RlTmFtZSwgbm90ZUNvbnRlbnQpO1xuICAgICAgICBzdGF0dXMgPSB0aGlzLnB1c2hOb3RlSWZMaXN0Tm90RXhpc3RzKGN1cnJlbnROb3RlKSAmJiBzdGF0dXM7XG4gICAgICAgIHJldHVybiBzdGF0dXM7XG4gICAgfTtcblxuICAgIHB1c2hOb3RlSWZMaXN0Tm90RXhpc3RzKG5vdGVUb1B1c2g6IExJUlBOb3RlKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGFsbExpc3RUaXRsZSA9IHRoaXMuZ2V0TGlzdFRpdGxlcygpO1xuICAgICAgICBsZXQgdW5pYzpib29sZWFuID0gdHJ1ZTtcbiAgICAgICAgbm90ZVRvUHVzaC5nZXRMaXN0VGl0bGVzKCkubWFwKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoYWxsTGlzdFRpdGxlLmNvbnRhaW5zKGVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dzLnB1c2gobm90ZVRvUHVzaC5ub3RlTmFtZSwgZWxlbWVudCwgJ2R1cEluRm9sZGVyJywgdGhpcy5nZXROb3RlTmFtZUZyb21MaXN0VGl0bGUoZWxlbWVudCkpO1xuICAgICAgICAgICAgICAgIHVuaWMgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh1bmljKSB7XG4gICAgICAgICAgICB0aGlzLm11bHRpTm90ZS5wdXNoKG5vdGVUb1B1c2gpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5sb2dzLmFkZChub3RlVG9QdXNoLmxvZ3MpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdW5pYztcbiAgICB9O1xuXG4gICAgZ2V0Tm90ZU5hbWVGcm9tTGlzdFRpdGxlKGxpc3RUaXRsZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IG5vdGUgPSB0aGlzLm11bHRpTm90ZS5maW5kKChlbGVtZW50KSA9PlxuICAgICAgICAgICAgZWxlbWVudC5nZXRMaXN0VGl0bGVzKCkuY29udGFpbnMobGlzdFRpdGxlKVxuICAgICAgICApO1xuICAgICAgICBpZiAobm90ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gbm90ZS5ub3RlTmFtZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFxuICAgIGdldExpc3RUaXRsZXMoKSA6IHN0cmluZ1tdIHtcbiAgICAgICAgbGV0IGxpc3RUaXRsZXM6c3RyaW5nW10gPSBbXTtcbiAgICAgICAgdGhpcy5tdWx0aU5vdGUubWFwKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBsaXN0VGl0bGVzID0gbGlzdFRpdGxlcy5jb25jYXQoZWxlbWVudC5nZXRMaXN0VGl0bGVzKCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGxpc3RUaXRsZXM7XG4gICAgfTtcblxuICAgIGdldExpc3RTdWdnZXN0aW9uKHdpdGhIaWRkZW46IGJvb2xlYW4gPSBmYWxzZSk6IExJUlBTdWdnZXN0aW9uTGlzdCB7XG4gICAgICAgIGxldCBhbGxMaXN0U3VnZ2VzdGlvbiA9IG5ldyBMSVJQU3VnZ2VzdGlvbkxpc3QoKTtcbiAgICAgICAgdGhpcy5tdWx0aU5vdGUubWFwKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBhbGxMaXN0U3VnZ2VzdGlvbiA9IGFsbExpc3RTdWdnZXN0aW9uLmNvbmNhdChlbGVtZW50LmdldExpc3RTdWdnZXN0aW9uKHdpdGhIaWRkZW4pKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhbGxMaXN0U3VnZ2VzdGlvbjtcbiAgICB9O1xuXG4gICAgZ2V0Tm90ZVN1Z2dlc3Rpb24od2l0aEhpZGRlbjogYm9vbGVhbiA9IGZhbHNlKTogTElSUFN1Z2dlc3Rpb25MaXN0IHtcbiAgICAgICAgbGV0IG5vdGVTdWdnZXN0aW9uID0gbmV3IExJUlBTdWdnZXN0aW9uTGlzdDtcbiAgICAgICAgdGhpcy5tdWx0aU5vdGUubWFwKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoZWxlbWVudC5nZXRMaXN0U3VnZ2VzdGlvbih3aXRoSGlkZGVuKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgbm90ZVN1Z2dlc3Rpb24ucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIG5vdGVOYW1lOiBlbGVtZW50Lm5vdGVOYW1lLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZWxlbWVudC5ub3RlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IChlbGVtZW50LmRlc2NyaXB0aW9uLnNwbGl0KCdcXG4nKVswXSksXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG5vdGVTdWdnZXN0aW9uO1xuICAgIH07XG5cbiAgICBkb1JlZmVyZW5jZVN1YnN0aXR1dGlvbih0ZXh0OiBzdHJpbmcpOnN0cmluZyB7XG4gICAgICAgIGxldCBzdXBlck5vdGUgPSBuZXcgTElSUE5vdGUodGhpcy5udWxsVmFsdWUsIHRoaXMuZXNjYXBlU3RyaW5nLCB0aGlzLmNvbW1lbnRTdHJpbmcsIHRoaXMucmVmZXJlbmNlTWF4RGVwdGgpO1xuICAgICAgICB0aGlzLm11bHRpTm90ZS5tYXAoKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIHN1cGVyTm90ZS5saXN0ID0gc3VwZXJOb3RlLmxpc3QuY29uY2F0KGVsZW1lbnQubGlzdCk7XG4gICAgICAgIH0pO1xuICAgICAgICBsZXQgcmV0dXJuT2ZEb0V4ZWNTdWI6IExJUlBEb1JlZlN1YkludGVyZmFjZSA9IHtcbiAgICAgICAgICAgIGxhc3RMaXN0VGl0bGU6ICdSZWZlcmVuY2Ugc3Vic3RpdHV0aW9uIGluIHNlbGVjdGlvbicsXG4gICAgICAgICAgICBtb2RpZmllZFRleHQ6IFwiXCIsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybk9mRG9FeGVjU3ViID0gc3VwZXJOb3RlLmRvUmVmZXJlbmNlU3Vic3RpdHV0aW9uKHRleHQpO1xuICAgICAgICBsZXQgbGlzdFRpdGxlOnN0cmluZyA9IFwiXCI7XG4gICAgICAgIGNvbnN0IHN0cmluZ1JlZlJlZ2V4OiBzdHJpbmcgPSBgXFx7KCR7c3VwZXJOb3RlLmxpc3QubWFwKChlbGVtZW50KSA9PiBlc2NhcGVSZWdleChlbGVtZW50LnRpdGxlKSkuam9pbignfCcpfSlcXH1gO1xuICAgICAgICBjb25zdCByZWZSZWdleCA9IG5ldyBSZWdFeHAoc3RyaW5nUmVmUmVnZXgpO1xuICAgICAgICBpZiAocmVmUmVnZXgudGVzdChyZXR1cm5PZkRvRXhlY1N1Yi5tb2RpZmllZFRleHQpKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ3MucHVzaCgnJywgJycsICdzdWJSZWZMaW1pdCcpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gcmV0dXJuT2ZEb0V4ZWNTdWIubW9kaWZpZWRUZXh0XG4gICAgfTtcblxuICAgIHBpY2tSYW5kb21JdGVtRnJvbUxpc3QobGlzdFRpdGxlOiBzdHJpbmcsIHdvcmtPblJlZmVyZW5jZTogYm9vbGVhbiA9IHRydWUpOiBzdHJpbmcge1xuICAgICAgICBsZXQgc3VwZXJOb3RlID0gbmV3IExJUlBOb3RlKHRoaXMubnVsbFZhbHVlLCB0aGlzLmVzY2FwZVN0cmluZywgdGhpcy5jb21tZW50U3RyaW5nLCB0aGlzLnJlZmVyZW5jZU1heERlcHRoKTtcbiAgICAgICAgc3VwZXJOb3RlLm5vdGVOYW1lID0gdGhpcy5nZXROb3RlTmFtZUZyb21MaXN0VGl0bGUobGlzdFRpdGxlKTtcbiAgICAgICAgdGhpcy5tdWx0aU5vdGUubWFwKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBzdXBlck5vdGUubGlzdCA9IHN1cGVyTm90ZS5saXN0LmNvbmNhdChlbGVtZW50Lmxpc3QpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgcmFuZG9tSXRlbTogc3RyaW5nID0gc3VwZXJOb3RlLnBpY2tSYW5kb21JdGVtRnJvbUxpc3QobGlzdFRpdGxlKTtcbiAgICAgICAgdGhpcy5sb2dzLmFkZChzdXBlck5vdGUuZ2V0TG9ncygpKTtcbiAgICAgICAgcmV0dXJuIHJhbmRvbUl0ZW07XG4gICAgfTtcblxuICAgIGZsdXNoTG9ncygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5sb2dzLmZsdXNoKCk7XG4gICAgICAgIHRoaXMubXVsdGlOb3RlLm1hcCgoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgZWxlbWVudC5mbHVzaExvZ3MoKVxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgZ2V0TG9ncygpOiBMSVJQTG9nIHtcbiAgICAgICAgbGV0IGFsbExvZ3MgPSBuZXcgTElSUExvZztcbiAgICAgICAgYWxsTG9ncy5hZGQodGhpcy5sb2dzKTtcbiAgICAgICAgdGhpcy5tdWx0aU5vdGUubWFwKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBhbGxMb2dzLmFkZChlbGVtZW50LmdldExvZ3MoKSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYWxsTG9ncztcbiAgICB9O1xuXG4gICAgaGFzRXJyb3JzKCk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBhbGxMb2dzID0gdGhpcy5nZXRMb2dzKCk7XG4gICAgICAgIHJldHVybiAoYWxsTG9ncy5nZXQoJ2Vycm9yJykubGVuZ3RoICE9PSAwKSA7XG4gICAgfTtcblxuICAgIGdldCBsZW5ndGgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubXVsdGlOb3RlLmxlbmd0aDtcbiAgICB9O1xuXG59O1xuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmludGVyZmFjZSBMSVJQU3VnZ2VzdGlvbkludGVyZmFjZSB7XG4gICAgbm90ZU5hbWU6IHN0cmluZztcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG59O1xuXG5jbGFzcyBMSVJQU3VnZ2VzdGlvbkxpc3Qge1xuICAgIGxpc3Q6IExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlW107XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5saXN0ID0gW107XG4gICAgfTtcblxuICAgIHB1c2ggKGVsZW1lbnQ6IExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlKTogdm9pZCB7XG4gICAgICAgIHRoaXMubGlzdC5wdXNoKGVsZW1lbnQpO1xuICAgIH07XG5cbiAgICBmaWx0ZXJCeU5vdGVOYW1lKG5vdGVOYW1lOiBzdHJpbmcpOiBMSVJQU3VnZ2VzdGlvbkxpc3Qge1xuICAgICAgICBjb25zdCBmaWx0ZXJMaXN0ID0gbmV3IExJUlBTdWdnZXN0aW9uTGlzdCgpO1xuICAgICAgICB0aGlzLmxpc3QubWFwKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoZWxlbWVudC5ub3RlTmFtZSA9PT0gbm90ZU5hbWUpIHtcbiAgICAgICAgICAgICAgICBmaWx0ZXJMaXN0LnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZmlsdGVyTGlzdDtcbiAgICB9O1xuXG4gICAgZmlsdGVyKGNhbGxiYWNrOiAoZWxlbWVudDogTElSUFN1Z2dlc3Rpb25JbnRlcmZhY2UsIGluZGV4PzogbnVtYmVyLCBhcnJheT86IExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlW10pID0+IGJvb2xlYW4pOiBMSVJQU3VnZ2VzdGlvbkxpc3Qge1xuICAgICAgICBjb25zdCBmaWx0ZXJlZExpc3QgPSBuZXcgTElSUFN1Z2dlc3Rpb25MaXN0KCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5saXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoY2FsbGJhY2sodGhpcy5saXN0W2ldLCBpLCB0aGlzLmxpc3QpKSB7XG4gICAgICAgICAgICAgICAgZmlsdGVyZWRMaXN0LnB1c2godGhpcy5saXN0W2ldKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBmaWx0ZXJlZExpc3Q7XG4gICAgfTtcblxuICAgIGNvbmNhdChvdGhlckxpc3Q6IExJUlBTdWdnZXN0aW9uTGlzdCk6IExJUlBTdWdnZXN0aW9uTGlzdCB7XG4gICAgICAgIGNvbnN0IG5ld0xpc3QgPSBuZXcgTElSUFN1Z2dlc3Rpb25MaXN0KCk7XG4gICAgICAgIG5ld0xpc3QubGlzdCA9IHRoaXMubGlzdC5jb25jYXQob3RoZXJMaXN0Lmxpc3QpO1xuICAgICAgICByZXR1cm4gbmV3TGlzdDtcbiAgICB9O1xuXG4gICAgZ2V0IGxlbmd0aCAoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdC5sZW5ndGg7XG4gICAgfTtcbn1cblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5leHBvcnQgY2xhc3MgTElSUFN1Z2dlc3RNb2RhbCBleHRlbmRzIFN1Z2dlc3RNb2RhbDxMSVJQU3VnZ2VzdGlvbkludGVyZmFjZT4ge1xuICAgIGl0ZW1zOiBMSVJQU3VnZ2VzdGlvbkxpc3Q7XG4gICAgY2FsbGJhY2s6ICh2YWx1ZTogTElSUFN1Z2dlc3Rpb25JbnRlcmZhY2UpID0+IHZvaWQ7XG4gIFxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBpdGVtczogTElSUFN1Z2dlc3Rpb25MaXN0LCBjYWxsYmFjazogKHZhbHVlOiBMSVJQU3VnZ2VzdGlvbkludGVyZmFjZSkgPT4gdm9pZCkge1xuICAgICAgc3VwZXIoYXBwKTtcbiAgICAgIHRoaXMuaXRlbXMgPSBpdGVtcztcbiAgICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9O1xuXG4gICAgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5pdGVtcy5maWx0ZXIoKGl0ZW0pID0+XG4gICAgICAgICAgICBpdGVtLnRpdGxlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkudG9Mb3dlckNhc2UoKSlcbiAgICAgICAgKS5saXN0O1xuICAgIH07XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKGl0ZW06IExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlLCBlbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgZWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogaXRlbS50aXRsZSB9KTtcbiAgICAgICAgbGV0IG1lc3NhZ2U6c3RyaW5nID0gaXRlbS5kZXNjcmlwdGlvblxuICAgICAgICAvLyBDSE9JQ0UgVE8gRE8gOiBEaXNwbGF5IG5vdGUgcGF0aCBhbmQgbmFtZSB3aGVuIG5vIG5vdGUgc2VsZWN0b3IgP1xuICAgICAgICAvLyBpZiAoaXRlbS5ub3RlTmFtZSAhPT0gaXRlbS50aXRsZSkge1xuICAgICAgICAvLyAgICAgaWYgKGl0ZW0uZGVzY3JpcHRpb24gIT09ICcnKSB7XG4gICAgICAgIC8vICAgICAgICAgbWVzc2FnZSA9IGAke2l0ZW0uZGVzY3JpcHRpb259XFxuKGZyb20gOiAke2l0ZW0ubm90ZU5hbWV9KWA7XG4gICAgICAgIC8vICAgICB9IGVsc2Uge1xuICAgICAgICAvLyAgICAgICAgIG1lc3NhZ2UgPSBgKGZyb20gOiAke2l0ZW0ubm90ZU5hbWV9KWA7XG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vIH07XG4gICAgICAgIGVsLmNyZWF0ZUVsKCdzbWFsbCcsIHt0ZXh0OiBtZXNzYWdlfSk7XG4gICAgICB9O1xuICBcbiAgICAgIG9uQ2hvb3NlU3VnZ2VzdGlvbihpdGVtOiBMSVJQU3VnZ2VzdGlvbkludGVyZmFjZSwgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICB0aGlzLmNhbGxiYWNrKGl0ZW0pO1xuICAgICAgfTtcbn07XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuaW50ZXJmYWNlIExJUlBQbHVnaW5TZXR0aW5ncyB7XG4gICAgbm90ZVBhdGg6IHN0cmluZztcbiAgICBudWxsVmFsdWU6IHN0cmluZztcbiAgICBlc2NhcGVWYWx1ZTogc3RyaW5nO1xuICAgIHNlbGVjdGlvbkZvck5vdGlmaWNhdGlvbjogc3RyaW5nO1xuICAgIHNob3dOb3RlU2VsZWN0b3I6IGJvb2xlYW47XG4gICAgc2hvd1dhcm5pbmc6IGJvb2xlYW47XG4gICAgZGVsZXRlU2VsZWN0aW9uRm9yTm90aWZpY2F0aW9uOiBib29sZWFuO1xuICAgIG1heFJlZmVyZW5jZURlcHRoOiBudW1iZXI7XG4gICAgY29tbWVudFZhbHVlOiBzdHJpbmc7XG59O1xuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBMSVJQUGx1Z2luU2V0dGluZ3MgPSB7XG4gICAgbm90ZVBhdGg6ICdOb3RlIG9yIGZvbGRlciBwYXRoJyxcbiAgICBudWxsVmFsdWU6ICdudWxsJyxcbiAgICBlc2NhcGVWYWx1ZTogJy8vJyxcbiAgICBzZWxlY3Rpb25Gb3JOb3RpZmljYXRpb246ICchJyxcbiAgICBzaG93Tm90ZVNlbGVjdG9yOiB0cnVlLFxuICAgIHNob3dXYXJuaW5nOiB0cnVlLFxuICAgIGRlbGV0ZVNlbGVjdGlvbkZvck5vdGlmaWNhdGlvbjogZmFsc2UsXG4gICAgbWF4UmVmZXJlbmNlRGVwdGg6IDMsXG4gICAgY29tbWVudFZhbHVlOiAnJSUnLFxufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTGlzdEl0ZW1SYW5kb21QaWNrZXIgZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzOiBMSVJQUGx1Z2luU2V0dGluZ3M7XG4gICAgbG9nczogTElSUExvZztcblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcbiAgICAgICAgdGhpcy5sb2dzID0gbmV3IExJUlBMb2coKTtcbiAgICAgICAgdGhpcy5hZGRSaWJib25JY29uKCdsaXN0LXRyZWUnLCAnUGljayByYW5kb20gbGlzdCBpdGVtJywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcmVwYXJlQWN0aW9uKCdub3RlJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ2luc2VydC1yYW5kb20taXRlbScsXG4gICAgICAgICAgICBuYW1lOiAnSW5zZXJ0IHJhbmRvbSBpdGVtIGZyb20gbGlzdCcsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucHJlcGFyZUFjdGlvbignbm90ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdpbnNlcnQtbGlzdC1zZXR0aW5nLWl0ZW0nLFxuICAgICAgICAgICAgbmFtZTogJ0luc2VydCBsaXN0IHNldHRpbmdzIHZhbHVlcycsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5zZXJ0U3RyaW5nKExJUlBMaXN0LmdldFNldHRpbmdTdHJpbmcoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ2luc2VydC1ub3RlLXNldHRpbmctaXRlbScsXG4gICAgICAgICAgICBuYW1lOiAnSW5zZXJ0IG5vdGUgc2V0dGluZ3MgdmFsdWVzJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnNlcnRTdHJpbmcoTElSUE5vdGUuZ2V0U2V0dGluZ1N0cmluZygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnaW5zZXJ0LXJlZmVyZW5jZS1pdGVtJyxcbiAgICAgICAgICAgIG5hbWU6ICdJbnNlcnQgbGlzdCByZWZlcmVuY2UnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXBhcmVBY3Rpb24oJ3JlZmVyZW5jZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdyZXBsYWNlLXJlZmVyZW5jZS1pdGVtJyxcbiAgICAgICAgICAgIG5hbWU6ICdSZXBsYWNlIHJlZmVyZW5jZXMgaW4gc2VsZWN0aW9uJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcmVwYXJlQWN0aW9uKCdkb1JlZlN1YnN0aXR1dGlvbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IExJUlBTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG4gICAgfTtcblxuICAgIG9udW5sb2FkKCkge1xuICAgIH07XG5cbiAgICBnZXRMSVJQRmlsZXMgKG5vdGVQYXRoOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgICAgIGxldCBhbGxWYXVsdEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICBsZXQgZmlsZXNJbk5vdGVQYXRoOnN0cmluZ1tdID0gW107XG4gICAgICAgIGxldCBmb3VuZEFGaWxlOiBib29sZWFuID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IG5vdGVGaWxlTmFtZTogc3RyaW5nID0gYCR7bm90ZVBhdGh9Lm1kYFxuICAgICAgICBjb25zdCBub3RlUGF0aFJlZ2V4ID0gbmV3IFJlZ0V4cChgXiR7bm90ZVBhdGh9Ly4rXFwubWQkYCk7XG4gICAgICAgIGFsbFZhdWx0RmlsZXMubWFwKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAobm90ZVBhdGhSZWdleC50ZXN0KGVsZW1lbnQucGF0aCkpIHtcbiAgICAgICAgICAgICAgICBmaWxlc0luTm90ZVBhdGgucHVzaChlbGVtZW50LnBhdGgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50LnBhdGggPT09IG5vdGVGaWxlTmFtZSkge1xuICAgICAgICAgICAgICAgIGZvdW5kQUZpbGUgPSB0cnVlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChmaWxlc0luTm90ZVBhdGgubGVuZ3RoID09PSAwICYmIGZvdW5kQUZpbGUpIHtcbiAgICAgICAgICAgIGZpbGVzSW5Ob3RlUGF0aC5wdXNoKG5vdGVGaWxlTmFtZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZm91bmRBRmlsZSAmJiBmaWxlc0luTm90ZVBhdGgubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ3MucHVzaCgnTGlzdEl0ZW1SYW5kbVBpY2tlcicsJ2dldExJUlBGaWxlcycsJ2ZvbGRlckFuZEZpbGUnKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaWxlc0luTm90ZVBhdGg7XG4gICAgfTtcblxuICAgIGFzeW5jIGxvYWRMSVJQRmlsZXMoKTogUHJvbWlzZTxMSVJQTXVsdGlOb3RlPiB7XG4gICAgICAgIGNvbnN0IGFsbExJUlBGaWxlcyA9IHRoaXMuZ2V0TElSUEZpbGVzKHRoaXMuc2V0dGluZ3Mubm90ZVBhdGgpO1xuICAgICAgICBsZXQgY3VycmVudExJUlAgPSBuZXcgTElSUE11bHRpTm90ZSh0aGlzLnNldHRpbmdzLm51bGxWYWx1ZSwgdGhpcy5zZXR0aW5ncy5lc2NhcGVWYWx1ZSwgdGhpcy5zZXR0aW5ncy5jb21tZW50VmFsdWUsIHRoaXMuc2V0dGluZ3MubWF4UmVmZXJlbmNlRGVwdGgpO1xuXG4gICAgICAgIGZvciAoY29uc3QgY3VycmVudEZpbGUgb2YgYWxsTElSUEZpbGVzKSB7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50RlNPYmplY3QgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoY3VycmVudEZpbGUpO1xuICAgICAgICAgICAgbGV0IGNvbnRlbnQ6c3RyaW5nID0gJyc7XG4gICAgICAgICAgICBpZiAoY3VycmVudEZTT2JqZWN0IGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgICAgICBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY2FjaGVkUmVhZChjdXJyZW50RlNPYmplY3QpO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRMSVJQLmxvYWRGcm9tTm90ZShjdXJyZW50RlNPYmplY3QucGF0aC5zbGljZSgwLCAtMyksIGNvbnRlbnQpO1xuICAgICAgICAgICAgfTsgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gY3VycmVudExJUlA7XG4gICAgfTtcblxuICAgIGFzeW5jIHByZXBhcmVBY3Rpb24oYWN0aW9uOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgY3VycmVudExJUlAgPSBhd2FpdCB0aGlzLmxvYWRMSVJQRmlsZXMoKTtcbiAgICAgICAgaWYgKGN1cnJlbnRMSVJQLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5sb2dzLnB1c2goJ0xpc3RJdGVtUmFuZG9tUGlja2VyJywnbG9hZExJUlBGaWxlcycsJ3BhdGhTZXR0aW5nJyk7XG4gICAgICAgIH07XG4gICAgICAgIGlmICghY3VycmVudExJUlAuaGFzRXJyb3JzKCkgJiYgY3VycmVudExJUlAubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICBpZiAoYWN0aW9uID09PSAnZG9SZWZTdWJzdGl0dXRpb24nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kb1JlZmVyZW5jZVN1YnN0aXR1dGlvbihjdXJyZW50TElSUCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TElSUC5sZW5ndGggPT09IDEgfHwgIXRoaXMuc2V0dGluZ3Muc2hvd05vdGVTZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgICAgICBuZXcgTElSUFN1Z2dlc3RNb2RhbCh0aGlzLmFwcCwgY3VycmVudExJUlAuZ2V0TGlzdFN1Z2dlc3Rpb24oYWN0aW9uID09PSAncmVmZXJlbmNlJyksIChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uID09PSAnbm90ZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndvcmtXaXRoVGl0bGUoY3VycmVudExJUlAsIGl0ZW0udGl0bGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluc2VydFN0cmluZyhgeyR7aXRlbS50aXRsZX19YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9KS5vcGVuKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3IExJUlBTdWdnZXN0TW9kYWwodGhpcy5hcHAsIGN1cnJlbnRMSVJQLmdldE5vdGVTdWdnZXN0aW9uKGFjdGlvbiA9PT0gJ3JlZmVyZW5jZScpLCAoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IExJUlBTdWdnZXN0TW9kYWwodGhpcy5hcHAsIGN1cnJlbnRMSVJQLmdldExpc3RTdWdnZXN0aW9uKGFjdGlvbiA9PT0gJ3JlZmVyZW5jZScpLmZpbHRlckJ5Tm90ZU5hbWUoaXRlbS5ub3RlTmFtZSksIChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ25vdGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud29ya1dpdGhUaXRsZShjdXJyZW50TElSUCwgaXRlbS50aXRsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnNlcnRTdHJpbmcoYHske2l0ZW0udGl0bGV9fWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5vcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pLm9wZW4oKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRvTG9nTWFuYWdlbWVudChjdXJyZW50TElSUC5nZXRMb2dzKCkpO1xuICAgICAgICB0aGlzLmxvZ3MuZmx1c2goKTtcbiAgICAgICAgY3VycmVudExJUlAuZmx1c2hMb2dzKCk7XG4gICAgfTtcblxuICAgIGRvTG9nTWFuYWdlbWVudChtdWx0aU5vdGVMb2dzPzogTElSUExvZyk6IHZvaWQge1xuICAgICAgICBjb25zdCBhbGxMb2dzID0gdGhpcy5sb2dzO1xuICAgICAgICBpZiAobXVsdGlOb3RlTG9ncyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBhbGxMb2dzLmFkZChtdWx0aU5vdGVMb2dzKTtcbiAgICAgICAgICAgIG11bHRpTm90ZUxvZ3MuZmx1c2goKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZXJyb3JNc2c6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGNvbnN0IHdhcm5pbmdNc2c6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGNvbnN0IGluZm9Nc2c6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGFsbExvZ3MubG9ncy5tYXAoKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAoZWxlbWVudC5zdGF0dXMpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdkdXBJbk5vdGUnOlxuICAgICAgICAgICAgICAgICAgICB3YXJuaW5nTXNnLnB1c2goYExpc3QgXCIke2VsZW1lbnQuY2hpbGR9XCIgaXMgZHVwbGljYXRlIGluIG5vdGUgXCIke2VsZW1lbnQuZmF0aGVyfVwiLiBMaXN0IGlzIGlnbm9yZWRgKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZHVwSW5Gb2xkZXInOlxuICAgICAgICAgICAgICAgICAgICBlcnJvck1zZy5wdXNoKGBFUlJPUiA6IExpc3QgXCIke2VsZW1lbnQuY2hpbGR9XCIgZXhpc3RzIGluIHR3byBub3RlcywgXCIke2VsZW1lbnQuZmF0aGVyfVwiIGFuZCBcIiR7ZWxlbWVudC5jb21wbGVtZW50fVwiLCBtYWtlIGNvcnJlY3Rpb24gIWApO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdlbXB0eUxpc3QnOlxuICAgICAgICAgICAgICAgICAgICB3YXJuaW5nTXNnLnB1c2goYExpc3QgXCIke2VsZW1lbnQuY2hpbGR9XCIgaXMgZW1wdHkgaW4gXCIke2VsZW1lbnQuZmF0aGVyfVwiYCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2VtcHR5Tm90ZSc6XG4gICAgICAgICAgICAgICAgICAgIHdhcm5pbmdNc2cucHVzaChgXCIke2VsZW1lbnQuY2hpbGR9XCIgaXMgZW1wdHlgKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAncmVmTGltaXQnOlxuICAgICAgICAgICAgICAgICAgICB3YXJuaW5nTXNnLnB1c2goYFJlZmVyZW5jZSBkZXB0aCBsaW1pdCByZWFjaCB3aXRoIGxpc3QgXCIke2VsZW1lbnQuY2hpbGR9XCIgaW4gbm90ZSBcIiR7ZWxlbWVudC5mYXRoZXJ9XCJgKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgLy8gY2FzZSAnc3ViUmVmTGltaXQnOlxuICAgICAgICAgICAgICAgIC8vICAgICB3YXJuaW5nTXNnLnB1c2goYFJlZmVyZW5jZSBkZXB0aCBsaW1pdCByZWFjaGApO1xuICAgICAgICAgICAgICAgIC8vICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwYXRoU2V0dGluZyc6XG4gICAgICAgICAgICAgICAgICAgIGVycm9yTXNnLnB1c2goYEVSUk9SIDogdmVyaWZ5IHBhdGggaW4gcGx1Z2luIHNldHRpbmdzYCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2ZvbGRlckFuZEZpbGUnOlxuICAgICAgICAgICAgICAgICAgICB3YXJuaW5nTXNnLnB1c2goYEEgbm90ZSB3aXRoIHRoZSBzYW1lIG5hbWUgYXMgdGhlIGZvbGRlciBpbiBzZXR0aW5ncyBnZXRzIGlnbm9yZWQuYCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3Nob3dJdGVtJzpcbiAgICAgICAgICAgICAgICAgICAgaW5mb01zZy5wdXNoKGAke2VsZW1lbnQuY29tcGxlbWVudH1gKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbm9BY3RpdmVWaWV3JzpcbiAgICAgICAgICAgICAgICAgICAgd2FybmluZ01zZy5wdXNoKGBObyBub3RlIGluIGVkaXRpb24gbW9kZSB0byBkbyB0aGlzIGFjdGlvbmApO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBlcnJvck1zZy5tYXAoKGVsZW1lbnQpID0+IG5ldyBOb3RpY2UoZWxlbWVudCkpO1xuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3Muc2hvd1dhcm5pbmcpIHtcbiAgICAgICAgICAgICAgICB3YXJuaW5nTXNnLm1hcCgoZWxlbWVudCkgPT4gbmV3IE5vdGljZShlbGVtZW50KSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaW5mb01zZy5tYXAoKGVsZW1lbnQpID0+IG5ldyBOb3RpY2UoZWxlbWVudCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5sb2dzLmZsdXNoKCk7XG4gICAgfTtcblxuICAgIHdvcmtXaXRoVGl0bGUobm90ZTogTElSUE11bHRpTm90ZSwgbGlzdFRpdGxlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgIGlmIChhY3RpdmVWaWV3KSB7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3Rpb25Gb3JOb3RpZmljYXRpb25SZWdleDpzdHJpbmcgPSBgXiR7dGhpcy5zZXR0aW5ncy5zZWxlY3Rpb25Gb3JOb3RpZmljYXRpb259JGA7XG4gICAgICAgICAgICBjb25zdCBub3RpY2VSZWdleCA9IG5ldyBSZWdFeHAoc2VsZWN0aW9uRm9yTm90aWZpY2F0aW9uUmVnZXgpO1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gYWN0aXZlVmlldy5lZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICBpZiAobm90aWNlUmVnZXgudGVzdChzZWxlY3Rpb24pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dzLnB1c2goJycsJycsJ3Nob3dJdGVtJyxub3RlLnBpY2tSYW5kb21JdGVtRnJvbUxpc3QobGlzdFRpdGxlKSk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZGVsZXRlU2VsZWN0aW9uRm9yTm90aWZpY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZVZpZXcuZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oJycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGV0IHN0cmluZ1RvSW5zZXJ0OiBzdHJpbmcgPSAnJztcbiAgICAgICAgICAgICAgICBjb25zdCByZXBlYXRJbnNlcnRSZWdFeCA9IC9eKFxcZCspKC4qKS9nbTtcbiAgICAgICAgICAgICAgICBsZXQgcmVnRXhFeGVjdXRpb247XG4gICAgICAgICAgICAgICAgbGV0IHJlcGVhdDogbnVtYmVyO1xuICAgICAgICAgICAgICAgIGlmICgocmVnRXhFeGVjdXRpb24gPSByZXBlYXRJbnNlcnRSZWdFeC5leGVjKHNlbGVjdGlvbikpICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcGVhdCA9IE51bWJlcihyZWdFeEV4ZWN1dGlvblsxXSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlbGltaXRlciA9IHNlbGVjdGlvbi5yZXBsYWNlKC9eXFxkKy8sICcnKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXJyYXlTdHJpbmdUb2luc2VydDogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXBlYXQ7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJyYXlTdHJpbmdUb2luc2VydC5wdXNoKG5vdGUucGlja1JhbmRvbUl0ZW1Gcm9tTGlzdChsaXN0VGl0bGUpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdHJpbmdUb0luc2VydCA9IGFycmF5U3RyaW5nVG9pbnNlcnQuam9pbihkZWxpbWl0ZXIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0cmluZ1RvSW5zZXJ0ID0gbm90ZS5waWNrUmFuZG9tSXRlbUZyb21MaXN0KGxpc3RUaXRsZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFjdGl2ZVZpZXcuZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oc3RyaW5nVG9JbnNlcnQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubG9ncy5wdXNoKCdMaXN0SXRlbVJhbmRvbVBpY2tlcicsJ3dvcmtXaXRoVGl0bGUnLCdub0FjdGl2ZVZpZXcnKVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmRvTG9nTWFuYWdlbWVudChub3RlLmdldExvZ3MoKSk7XG4gICAgfTtcblxuICAgIGRvUmVmZXJlbmNlU3Vic3RpdHV0aW9uKG11bHRpTm90ZTogTElSUE11bHRpTm90ZSk6IHZvaWQge1xuICAgICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgaWYgKGFjdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGFjdGl2ZVZpZXcuZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgYWN0aXZlVmlldy5lZGl0b3IucmVwbGFjZVNlbGVjdGlvbihtdWx0aU5vdGUuZG9SZWZlcmVuY2VTdWJzdGl0dXRpb24oc2VsZWN0aW9uKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmxvZ3MucHVzaCgnTGlzdEl0ZW1SYW5kb21QaWNrZXInLCd3b3JrV2l0aFRpdGxlJywnbm9BY3RpdmVWaWV3JylcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgaW5zZXJ0U3RyaW5nKHN0cmluZ1RvSW5zZXJ0OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgIGlmIChhY3RpdmVWaWV3KSB7XG4gICAgICAgICAgICBhY3RpdmVWaWV3LmVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKHN0cmluZ1RvSW5zZXJ0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubG9ncy5wdXNoKCdMaXN0SXRlbVJhbmRvbVBpY2tlcicsJ3dvcmtXaXRoVGl0bGUnLCdub0FjdGl2ZVZpZXcnKVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmRvTG9nTWFuYWdlbWVudCgpO1xuICAgIH07XG5cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG59XG5cbmNsYXNzIExJUlBTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcGx1Z2luOiBMaXN0SXRlbVJhbmRvbVBpY2tlcjtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IExpc3RJdGVtUmFuZG9tUGlja2VyKSB7XG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgZGlzcGxheSgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdQYXRoJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdUaGUgcGF0aCBvZiBhIG5vdGUgb3IgZm9sZGVyLiBFeGFtcGxlOiBcIkZvbGRlci9Ob3RlXCIgb3IgXCJGb2xkZXJcIi4nKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdFbnRlciB0aGUgcGF0aCB0byB5b3VyIG5vdGUnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5ub3RlUGF0aClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm5vdGVQYXRoID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogXCJTcGVjaWZpYyB2YWx1ZXNcIiB9KTtcbiAgICBcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKFwiTnVsbCB2YWx1ZVwiKVxuICAgICAgICAgICAgICAgIC5zZXREZXNjKFwiSWYgdGhlIGZpcnN0IGxpbmUgb2YgYSBsaXN0IGl0ZW0gaGFzIHRoaXMgdmFsdWUsIHRoYXQgbGluZSBpcyBpZ25vcmVkLiBUaGlzIGFsbG93cyB5b3UgdG8gaGF2ZSBwcm9iYWJpbGl0aWVzIG9mIGdldHRpbmcgbm8gcmVzdWx0LiBVc2FnZSBleGFtcGxlOiBoYXZpbmcsIG9yIG5vdCBoYXZpbmcsIGEgcGFydGljbGUgaW4gYSBub3VuLlwiKVxuICAgICAgICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkVudGVyIHZhbHVlXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5udWxsVmFsdWUpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubnVsbFZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoXCJFc2NhcGUgdmFsdWVcIilcbiAgICAgICAgICAgICAgICAuc2V0RGVzYyhcIlRvIGluY2x1ZGUgaGVhZGluZyBvbmUgZWxlbWVudHMgb3IgZmlyc3QtbGV2ZWwgbGlzdCBpdGVtcyBpbiB5b3VyIHJhbmRvbSBsaXN0LCBlc2NhcGUgdGhlbSB3aXRoIHRoZXNlIHZhbHVlcy4gRXhlbXBsZSA6IC8vICMgSGVhZGluZ1wiKVxuICAgICAgICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkVudGVyIHZhbHVlXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lc2NhcGVWYWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXNjYXBlVmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgICAgICAuc2V0TmFtZShcIlNlbGVjdGlvbiB2YWx1ZSBmb3Igbm90aWZpY2F0aW9uXCIpXG4gICAgICAgICAgICAgICAgLnNldERlc2MoXCJJZiB0aGUgc2VsZWN0ZWQgdGV4dCBoYXMgdGhpcyB2YWx1ZSwgdGhlIGl0ZW0gaXMgbm90IGluc2VydGVkOyBpbnN0ZWFkLCBhIG5vdGlmaWNhdGlvbiBpcyBzaG93bi5cIilcbiAgICAgICAgICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4gdGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJFbnRlciB2YWx1ZVwiKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0aW9uRm9yTm90aWZpY2F0aW9uKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGlvbkZvck5vdGlmaWNhdGlvbiA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdCZWhhdmlvcicgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnU2hvdyBub3RlIHNlbGVjdG9yJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdJZiBwYXRoIGlzIGEgZm9sZGVyIGNvbnRhaW5pbmcgYXQgbGVhc3QgdHdvIG5vdGVzLCBhIHNlbGVjdG9yIHdpbGwgYWxsb3cgeW91IHRvIGNob29zZSB0aGUgbm90ZTsgb3RoZXJ3aXNlLCBhbGwgbGlzdHMgd2lsbCBiZSBvZmZlcmVkIHRvIHlvdS4nKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XG4gICAgICAgICAgICAgICAgdG9nZ2xlLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dOb3RlU2VsZWN0b3IpO1xuICAgICAgICAgICAgICAgIHRvZ2dsZS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd05vdGVTZWxlY3RvciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnU2hvdyB3YXJuaW5nJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdBcmUgd2FybmluZ3MgZGlzcGxheWVkIGFzIG5vdGlmaWNhdGlvbnMgPycpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHtcbiAgICAgICAgICAgICAgICB0b2dnbGUuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd1dhcm5pbmcpO1xuICAgICAgICAgICAgICAgIHRvZ2dsZS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd1dhcm5pbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0RlbGV0ZSBzZWxlY3Rpb24gdmFsdWUgb24gbm90aWZpY2F0aW9uJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdJZiB0aGlzIHNldHRpbmcgaXMgb24sIHRoZSBzZWxlY3RlZCBub3RpZmljYXRpb24gdmFsdWUgaXMgcmVtb3ZlZCBhZnRlciBpdFxcJ3MgdXNlZC4nKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XG4gICAgICAgICAgICAgICAgdG9nZ2xlLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlbGV0ZVNlbGVjdGlvbkZvck5vdGlmaWNhdGlvbik7XG4gICAgICAgICAgICAgICAgdG9nZ2xlLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWxldGVTZWxlY3Rpb25Gb3JOb3RpZmljYXRpb24gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1JlZmVyZW5jZSBkZXB0aCBsaW1pdCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnUmVmZXJlbmNlIHJlY3Vyc2lvbiBsaW1pdDogdGhlIG1heGltdW0gbnVtYmVyIG9mIG5lc3RlZCByZWZlcmVuY2UgY2FsbHMgYWxsb3dlZC4gWmVybyBkaXNhYmxlcyByZWZlcmVuY2UgcmVzb2x1dGlvbi4nKVxuICAgICAgICAgICAgLmFkZFNsaWRlcigoc2xpZGVyKSA9PlxuICAgICAgICAgICAgICAgIHNsaWRlclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4UmVmZXJlbmNlRGVwdGgpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRMaW1pdHMoMCwgMTAsIDEpXG4gICAgICAgICAgICAgICAgICAgIC5zZXREeW5hbWljVG9vbHRpcCgpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4UmVmZXJlbmNlRGVwdGggPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgfVxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHNCQUFpRztBQUlqRyxTQUFTLFlBQWUsU0FBYyxXQUE2RDtBQUMvRixRQUFNLFVBQW9CLENBQUM7QUFDM0IsVUFBUSxRQUFRLENBQUMsU0FBUyxVQUFVO0FBQ2xDLFFBQUksVUFBVSxTQUFTLEtBQUssR0FBRztBQUM3QixjQUFRLEtBQUssS0FBSztBQUFBLElBQ3BCO0FBQUEsRUFDRixDQUFDO0FBQ0QsU0FBTztBQUNYO0FBRUEsU0FBUywwQkFBMEIsT0FBZSxTQUFtQixrQkFBMEIsT0FBZ0I7QUFDM0csTUFBSSxhQUFxQjtBQUN6QixNQUFJLGlCQUFpQjtBQUNqQixRQUFLLFFBQVEsU0FBUyxNQUFNLEtBQU8sU0FBUyxRQUFRLFFBQVEsU0FBUyxDQUFDLEdBQUk7QUFDdEUsYUFBTztBQUFBLElBQ1g7QUFBQztBQUFBLEVBQ0w7QUFBQztBQUNELFdBQVMsSUFBRSxHQUFHLElBQUssUUFBUSxTQUFTLEdBQUksSUFBSSxJQUFHLEdBQUc7QUFDOUMsUUFBSyxRQUFRLENBQUMsS0FBSyxTQUFXLFNBQVMsUUFBUSxJQUFFLENBQUMsR0FBSTtBQUNsRCxhQUFPO0FBQUEsSUFDWDtBQUFBLEVBQ0o7QUFDQSxTQUFPO0FBQ1g7QUFFQSxTQUFTLFlBQVksZ0JBQWdDO0FBQ2pELFNBQU8sZUFBZSxRQUFRLHVCQUF1QixN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T0FBTyxTQUFTLDJCQUEyQjtBQUNoRCxjQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDbkMsQ0FBQztBQUFBLElBQ0w7QUFFSixnQkFBWSxTQUFTLE1BQU0sRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUUvQyxRQUFJLHdCQUFRLFdBQVcsRUFDbEIsUUFBUSxvQkFBb0IsRUFDNUIsUUFBUSwrSUFBK0ksRUFDdkosVUFBVSxDQUFDLFdBQVc7QUFDbkIsYUFBTyxTQUFTLEtBQUssT0FBTyxTQUFTLGdCQUFnQjtBQUNyRCxhQUFPLFNBQVMsT0FBTyxVQUFVO0FBQzdCLGFBQUssT0FBTyxTQUFTLG1CQUFtQjtBQUN4QyxjQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDbkMsQ0FBQztBQUFBLElBQ0wsQ0FBQztBQUVMLFFBQUksd0JBQVEsV0FBVyxFQUNsQixRQUFRLGNBQWMsRUFDdEIsUUFBUSwyQ0FBMkMsRUFDbkQsVUFBVSxDQUFDLFdBQVc7QUFDbkIsYUFBTyxTQUFTLEtBQUssT0FBTyxTQUFTLFdBQVc7QUFDaEQsYUFBTyxTQUFTLE9BQU8sVUFBVTtBQUM3QixhQUFLLE9BQU8sU0FBUyxjQUFjO0FBQ25DLGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxNQUNuQyxDQUFDO0FBQUEsSUFDTCxDQUFDO0FBRUwsUUFBSSx3QkFBUSxXQUFXLEVBQ2xCLFFBQVEsd0NBQXdDLEVBQ2hELFFBQVEsb0ZBQXFGLEVBQzdGLFVBQVUsQ0FBQyxXQUFXO0FBQ25CLGFBQU8sU0FBUyxLQUFLLE9BQU8sU0FBUyw4QkFBOEI7QUFDbkUsYUFBTyxTQUFTLE9BQU8sVUFBVTtBQUM3QixhQUFLLE9BQU8sU0FBUyxpQ0FBaUM7QUFDdEQsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ25DLENBQUM7QUFBQSxJQUNMLENBQUM7QUFFTCxRQUFJLHdCQUFRLFdBQVcsRUFDbEIsUUFBUSx1QkFBdUIsRUFDL0IsUUFBUSxzSEFBc0gsRUFDOUg7QUFBQSxNQUFVLENBQUMsV0FDUixPQUNLLFNBQVMsS0FBSyxPQUFPLFNBQVMsaUJBQWlCLEVBQy9DLFVBQVUsR0FBRyxJQUFJLENBQUMsRUFDbEIsa0JBQWtCLEVBQ2xCLFNBQVMsT0FBTyxVQUFVO0FBQzNCLGFBQUssT0FBTyxTQUFTLG9CQUFvQjtBQUN6QyxjQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDL0IsQ0FBQztBQUFBLElBQ1Q7QUFBQSxFQUVSO0FBQ0o7IiwKICAibmFtZXMiOiBbIml0ZW0iLCAiZWxlbWVudCIsICJyZXBlYXQiXQp9Cg==
