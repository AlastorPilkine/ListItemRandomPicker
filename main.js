/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  LIRPSuggestModal: () => LIRPSuggestModal,
  default: () => ListItemRandomPicker
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
function findIndexes(anArray, predicate) {
  const indexes = [];
  anArray.forEach((element, index) => {
    if (predicate(element, index)) {
      indexes.push(index);
    }
  });
  return indexes;
}
var DEFAULT_SETTINGS = {
  notePath: "Full path of a note",
  showWarning: true,
  maxMacroDepth: 1,
  noticePrefix: "!"
};
var LIRPList = class {
  constructor(lines) {
    this.title = "";
    this.description = "";
    this.hidden = false;
    this.items = [];
    this.warning = [];
    const headingRegEx = /^# +(.+)$/;
    this.title = lines[0].replace(headingRegEx, "$1");
    const italicHeadingRegex = /^(_|\*)\S/;
    if (italicHeadingRegex.test(this.title)) {
      this.hidden = true;
    } else {
      this.hidden = false;
    }
    lines.shift();
    const listBeginItemRegex = /^(-|\d+\.) +(.+)$/;
    const listBeginIndexes = findIndexes(lines, (element) => listBeginItemRegex.test(element));
    if (listBeginIndexes.length === 0) {
      this.warning.push(`No items in list ${this.title}`);
      this.hidden = true;
      return;
    }
    const cleanLines = lines.map((element) => {
      return element.replace(listBeginItemRegex, "$2");
    });
    if (listBeginIndexes[0] !== 0) {
      let mdDescription = cleanLines.slice(0, listBeginIndexes[0]);
      if (mdDescription[0] === "") {
        mdDescription.shift();
      }
      this.description = mdDescription.join("\n");
    } else {
      this.description = "";
    }
    const listBeginCount = listBeginIndexes.length;
    let item;
    for (let currentIndex = 0; currentIndex < listBeginCount - 1; currentIndex++) {
      item = cleanLines.slice(listBeginIndexes[currentIndex], listBeginIndexes[currentIndex + 1]);
      this.pushItemBasedOnWeight(item);
    }
    item = cleanLines.slice(listBeginIndexes[listBeginCount - 1]);
    if (item.at(-1) === "") {
      item.pop();
    }
    this.pushItemBasedOnWeight(item);
  }
  pushItemBasedOnWeight(item) {
    const ItemWithWeightRegEx = /^\((\d+)\)\s+(.+)$/;
    let regExExecution;
    let repeat;
    if ((regExExecution = ItemWithWeightRegEx.exec(item[0])) !== null) {
      repeat = Number(regExExecution[1]);
      item[0] = regExExecution[2];
    } else {
      repeat = 1;
    }
    const stringItem = item.join("\n");
    for (let i = 0; i < repeat; i++) {
      this.items.push(stringItem);
    }
  }
  getListSuggestion() {
    const suggestion = {
      title: this.title,
      description: this.description.split("\n")[0]
    };
    return suggestion;
  }
  notHidden() {
    return !this.hidden;
  }
  pickRandomItem() {
    let randomItem = "";
    if (this.items.length > 0) {
      randomItem = this.items[Math.floor(Math.random() * this.items.length)];
    }
    return randomItem;
  }
  getWarning() {
    return this.warning;
  }
};
var LIRPNote = class {
  constructor() {
    this.noteName = "";
    this.description = "";
    this.list = [];
    this.error = [];
    this.warning = [];
  }
  loadFromNote(noteName, noteContent) {
    this.noteName = noteName;
    const lines = noteContent.split("\n");
    const headingRegex = /^# .+$/;
    let headingIndexes = findIndexes(lines, (element) => headingRegex.test(element));
    if (headingIndexes.length === 0) {
      this.error.push(`No heading in note`);
      return false;
    }
    if (headingIndexes[0] !== 0) {
      this.description = lines.slice(0, headingIndexes[0]).join("\n");
    }
    const headingCount = headingIndexes.length;
    for (let currentIndex = 0; currentIndex < headingCount - 1; currentIndex++) {
      this.list.push(new LIRPList(lines.slice(headingIndexes[currentIndex], headingIndexes[currentIndex + 1])));
    }
    this.list.push(new LIRPList(lines.slice(headingIndexes[headingCount - 1])));
    return true;
  }
  getNoteSuggestion() {
    let noteSuggestion;
    noteSuggestion = [];
    this.list.forEach((element) => {
      if (element.notHidden()) {
        noteSuggestion.push(element.getListSuggestion());
      }
    });
    return noteSuggestion;
  }
  execMacroSubstitution(item, macroRecursion) {
    const stringMacroRefRegex = `{(${this.list.map((element) => element.title).join("|")})}`;
    const macroRefRegex = new RegExp(stringMacroRefRegex, "mg");
    let match;
    let modifiedItem = item;
    let listTitle = "";
    while ((match = macroRefRegex.exec(modifiedItem)) !== null) {
      let newValue = this.pickRandomItemFromList(match[1], -1);
      listTitle = match[0];
      modifiedItem = modifiedItem.replace(listTitle, newValue);
      macroRefRegex.lastIndex = match.index + newValue.length;
    }
    return {
      lastListTitle: listTitle,
      modifiedItem
    };
  }
  pickRandomItemFromList(listTitle, macroRecursion) {
    let randomItem = "";
    let returnOfExecMacro = {
      lastListTitle: "",
      modifiedItem: ""
    };
    const currentList = this.list.find((element) => element.title === listTitle);
    if (currentList !== void 0) {
      randomItem = currentList.pickRandomItem();
      for (let repeat = 0; repeat < macroRecursion; repeat++) {
        returnOfExecMacro = this.execMacroSubstitution(randomItem, macroRecursion);
        randomItem = returnOfExecMacro.modifiedItem;
      }
    }
    const stringMacroRefRegex = `{(${this.list.map((element) => element.title).join("|")})}`;
    const macroRefRegex = new RegExp(stringMacroRefRegex);
    if (macroRefRegex.test(randomItem) && macroRecursion !== -1) {
      new import_obsidian.Notice(`Macro depth limit reached in note "${this.noteName}" after calling "${returnOfExecMacro.lastListTitle}"`);
    }
    ;
    return randomItem;
  }
  getError() {
    return this.error;
  }
  getWarning() {
    let allWarning;
    allWarning = [];
    allWarning = allWarning.concat(this.warning);
    this.list.forEach((element) => {
      allWarning = allWarning.concat(element.getWarning());
    });
    let NoteWarning;
    NoteWarning = [];
    allWarning.forEach(
      (element) => NoteWarning.push(`Warning in note "${this.noteName}" : ${element}`)
    );
    return NoteWarning;
  }
};
var LIRPSuggestModal = class extends import_obsidian.SuggestModal {
  constructor(app, items, callback) {
    super(app);
    this.items = items;
    this.callback = callback;
  }
  getSuggestions(query) {
    return this.items.filter(
      (item) => item.title.toLowerCase().includes(query.toLowerCase())
    );
  }
  renderSuggestion(item, el) {
    el.createEl("div", { text: item.title });
    el.createEl("small", { text: item.description });
  }
  onChooseSuggestion(item, evt) {
    this.callback(item.title);
  }
};
var ListItemRandomPicker = class extends import_obsidian.Plugin {
  async onload() {
    await this.loadSettings();
    this.addRibbonIcon("list-tree", "Pick random list item", (evt) => {
      this.doTheJob(this.settings.notePath + ".md");
    });
    this.addCommand({
      id: "insert-random-item",
      name: "Insert random item from list",
      callback: () => {
        this.doTheJob(this.settings.notePath + ".md");
      }
    });
    this.addSettingTab(new LIRPSettingTab(this.app, this));
  }
  onunload() {
  }
  async doTheJob(fullNotePath) {
    const file = this.app.vault.getAbstractFileByPath(fullNotePath);
    if (!file) {
      new import_obsidian.Notice("Note not found!");
      return;
    }
    if (!(file instanceof import_obsidian.TFile)) {
      new import_obsidian.Notice("Invalid file type. Expected a Markdown note file.");
      return;
    }
    const content = await this.app.vault.cachedRead(file);
    const currentLIRP = new LIRPNote();
    const loadSuccess = currentLIRP.loadFromNote(this.settings.notePath, content);
    if (!loadSuccess) {
      currentLIRP.getError().forEach((element) => new import_obsidian.Notice(element));
      return;
    }
    if (this.settings.showWarning) {
      currentLIRP.getWarning().forEach((element) => {
        new import_obsidian.Notice(element);
      });
    }
    ;
    new LIRPSuggestModal(this.app, currentLIRP.getNoteSuggestion(), (title) => {
      this.workWithTitle(currentLIRP, title);
    }).open();
  }
  workWithTitle(Note, listTitle) {
    const stringNoticeRegex = `^ *${this.settings.noticePrefix}(.*)`;
    const noticeRegex = new RegExp(stringNoticeRegex);
    if (noticeRegex.test(listTitle)) {
      new import_obsidian.Notice(Note.pickRandomItemFromList(listTitle, this.settings.maxMacroDepth));
    } else {
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
      if (activeView) {
        let stringToInsert = "";
        const editor = activeView.editor;
        const selection = editor.getSelection();
        const repeatInsertRegEx = /^(\d+)(.*)/gm;
        let regExExecution;
        let repeat;
        if ((regExExecution = repeatInsertRegEx.exec(selection)) !== null) {
          const repeat2 = Number(regExExecution[1]);
          const delimiter = selection.replace(/^\d+/, "");
          const arrayStringToinsert = [];
          for (let i = 0; i < repeat2; i++) {
            arrayStringToinsert.push(Note.pickRandomItemFromList(listTitle, this.settings.maxMacroDepth));
          }
          stringToInsert = arrayStringToinsert.join(delimiter);
        } else {
          stringToInsert = Note.pickRandomItemFromList(listTitle, this.settings.maxMacroDepth);
        }
        editor.replaceSelection(stringToInsert);
      } else {
        new import_obsidian.Notice("No active Markdown editor found.");
      }
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var LIRPSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Note Path").setDesc('The path and filename of the note that contains the lists to be used. Exemple : "Folder/Note".').addText(
      (text) => text.setPlaceholder("Enter the path to your note").setValue(this.plugin.settings.notePath).onChange(async (value) => {
        this.plugin.settings.notePath = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Show warning").setDesc("Display the warnings of notes and lists, if any. Warnings for macro depth limit reached are always displayed.").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.showWarning);
      toggle.onChange(async (value) => {
        this.plugin.settings.showWarning = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Macro depth limit").setDesc("Macro recursion limit: how many nested macro calls are allowed. Zero prevents nested macros from being resolved.").addSlider(
      (slider) => slider.setValue(this.plugin.settings.maxMacroDepth - 1).setLimits(0, 10, 1).setDynamicTooltip().onChange(async (value) => {
        this.plugin.settings.maxMacroDepth = value + 1;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("List prefix for notification").setDesc("If a list heading begin with the specified value, the picked item is not inserted, but notified.").addText(
      (text) => text.setPlaceholder("Enter prefix value").setValue(this.plugin.settings.noticePrefix).onChange(async (value) => {
        this.plugin.settings.noticePrefix = value;
        await this.plugin.saveSettings();
      })
    );
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgZXhlYyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuaW1wb3J0IHsgQXBwLCBTdWdnZXN0TW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBURmlsZSwgTWFya2Rvd25WaWV3IH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5mdW5jdGlvbiBmaW5kSW5kZXhlczxUPihhbkFycmF5OiBUW10sIHByZWRpY2F0ZTogKGVsZW1lbnQ6IFQsIGluZGV4OiBudW1iZXIpID0+IGJvb2xlYW4pOiBudW1iZXJbXSB7XG4gICAgY29uc3QgaW5kZXhlczogbnVtYmVyW10gPSBbXTtcbiAgICBhbkFycmF5LmZvckVhY2goKGVsZW1lbnQsIGluZGV4KSA9PiB7XG4gICAgICBpZiAocHJlZGljYXRlKGVsZW1lbnQsIGluZGV4KSkge1xuICAgICAgICBpbmRleGVzLnB1c2goaW5kZXgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBpbmRleGVzO1xufVxuXG5mdW5jdGlvbiBlc2NhcGVSZWdleChzdHJpbmdUb0VzY2FwZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gc3RyaW5nVG9Fc2NhcGUucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKTtcbn1cbmludGVyZmFjZSBMSVJQUGx1Z2luU2V0dGluZ3Mge1xuICAgIG5vdGVQYXRoOiBzdHJpbmc7XG4gICAgc2hvd1dhcm5pbmc6IGJvb2xlYW47XG4gICAgbWF4TWFjcm9EZXB0aDogbnVtYmVyO1xuICAgIG5vdGljZVByZWZpeDogc3RyaW5nO1xufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBMSVJQUGx1Z2luU2V0dGluZ3MgPSB7XG4gICAgbm90ZVBhdGg6ICdGdWxsIHBhdGggb2YgYSBub3RlJyxcbiAgICBzaG93V2FybmluZzogdHJ1ZSxcbiAgICBtYXhNYWNyb0RlcHRoOiAxLFxuICAgIG5vdGljZVByZWZpeDogJyEnLFxufTtcblxuaW50ZXJmYWNlIExJUlBMaXN0SW50ZXJmYWNlIHtcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgaXRlbXM6IHN0cmluZ1tdO1xuICAgIGdldExpc3RTdWdnZXN0aW9uKCk6IExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlO1xuICAgIG5vdEhpZGRlbigpOiBib29sZWFuO1xuICAgIHBpY2tSYW5kb21JdGVtKCk6IHN0cmluZztcbiAgICBnZXRXYXJuaW5nKCk6IHN0cmluZ1tdO1xufVxuXG5jbGFzcyBMSVJQTGlzdCBpbXBsZW1lbnRzIExJUlBMaXN0SW50ZXJmYWNlIHtcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgaGlkZGVuOiBib29sZWFuO1xuICAgIGl0ZW1zOiBzdHJpbmdbXTtcbiAgICB3YXJuaW5nOiBzdHJpbmdbXVxuXG4gICAgY29uc3RydWN0b3IobGluZXM6IHN0cmluZ1tdKSB7XG4gICAgICAgIHRoaXMudGl0bGUgPSBcIlwiO1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gXCJcIjtcbiAgICAgICAgdGhpcy5oaWRkZW4gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pdGVtcyA9IFtdO1xuICAgICAgICB0aGlzLndhcm5pbmcgPSBbXTtcblxuICAgICAgICBjb25zdCBoZWFkaW5nUmVnRXggPSAvXiMgKyguKykkLztcbiAgICAgICAgdGhpcy50aXRsZSA9IGxpbmVzWzBdLnJlcGxhY2UoaGVhZGluZ1JlZ0V4LCBcIiQxXCIpO1xuICAgICAgICBjb25zdCBpdGFsaWNIZWFkaW5nUmVnZXggPSAvXihffFxcKilcXFMvO1xuICAgICAgICBpZiAoaXRhbGljSGVhZGluZ1JlZ2V4LnRlc3QodGhpcy50aXRsZSkpIHtcbiAgICAgICAgICAgIHRoaXMuaGlkZGVuID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaGlkZGVuID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgbGluZXMuc2hpZnQoKTtcbiAgICAgICAgY29uc3QgbGlzdEJlZ2luSXRlbVJlZ2V4ID0gL14oLXxcXGQrXFwuKSArKC4rKSQvO1xuICAgICAgICBjb25zdCBsaXN0QmVnaW5JbmRleGVzID0gZmluZEluZGV4ZXMobGluZXMsIChlbGVtZW50KSA9PiBsaXN0QmVnaW5JdGVtUmVnZXgudGVzdChlbGVtZW50KSk7XG4gICAgICAgIGlmIChsaXN0QmVnaW5JbmRleGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy53YXJuaW5nLnB1c2goYE5vIGl0ZW1zIGluIGxpc3QgJHt0aGlzLnRpdGxlfWApO1xuICAgICAgICAgICAgdGhpcy5oaWRkZW4gPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNsZWFuTGluZXMgPSBsaW5lcy5tYXAoKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50LnJlcGxhY2UobGlzdEJlZ2luSXRlbVJlZ2V4LCBcIiQyXCIpXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAobGlzdEJlZ2luSW5kZXhlc1swXSAhPT0gMCkge1xuICAgICAgICAgICAgbGV0IG1kRGVzY3JpcHRpb24gPSBjbGVhbkxpbmVzLnNsaWNlKDAsIGxpc3RCZWdpbkluZGV4ZXNbMF0pO1xuICAgICAgICAgICAgLy8gdGFraW5nIGNhcmUgb2YgTUQwMjJcbiAgICAgICAgICAgIC8vICAgTUQwMjIvYmxhbmtzLWFyb3VuZC1oZWFkaW5nczogSGVhZGluZ3Mgc2hvdWxkIGJlIHN1cnJvdW5kZWQgYnkgYmxhbmsgbGluZXNcbiAgICAgICAgICAgIGlmIChtZERlc2NyaXB0aW9uWzBdID09PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgbWREZXNjcmlwdGlvbi5zaGlmdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gdGFraW5nIGNhcmUgb2YgTUQwMzJcbiAgICAgICAgICAgIC8vICAgTUQwMzIvYmxhbmtzLWFyb3VuZC1saXN0czogTGlzdHMgc2hvdWxkIGJlIHN1cnJvdW5kZWQgYnkgYmxhbmsgbGluZXNcbiAgICAgICAgICAgIC8vIER1ZSB0byBzcGxpdCBvbiAnXFxuJywgdGhlIHNsaWNlLCBhbmQgYXQgbGVhc3QgYSBqb2luIG9uICdcXG4nIHRoZSBsYXN0ICdcXG4nIGlzIGFsd2F5cyBsb3N0ICFcbiAgICAgICAgICAgIC8vIFNvIHRoZSBmb2xvd2luZyBjb2RlIGlzIHVzZWxlc3NcbiAgICAgICAgICAgIC8vIGlmIChtZERlc2NyaXB0aW9uLmF0KC0xKSA9PT0gXCJcIikge1xuICAgICAgICAgICAgLy8gICAgIG1kRGVzY3JpcHRpb24ucG9wKCk7XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gbWREZXNjcmlwdGlvbi5qb2luKCdcXG4nKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBcIlwiO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbGlzdEJlZ2luQ291bnQgPSBsaXN0QmVnaW5JbmRleGVzLmxlbmd0aFxuICAgICAgICBsZXQgaXRlbTogc3RyaW5nW107XG4gICAgICAgIGZvciAobGV0IGN1cnJlbnRJbmRleCA9IDA7IGN1cnJlbnRJbmRleCA8IChsaXN0QmVnaW5Db3VudCAtIDEpOyBjdXJyZW50SW5kZXgrKykge1xuICAgICAgICAgICAgaXRlbSA9IChjbGVhbkxpbmVzLnNsaWNlKGxpc3RCZWdpbkluZGV4ZXNbY3VycmVudEluZGV4XSwgbGlzdEJlZ2luSW5kZXhlc1tjdXJyZW50SW5kZXggKyAxXSkpO1xuICAgICAgICAgICAgdGhpcy5wdXNoSXRlbUJhc2VkT25XZWlnaHQoaXRlbSk7XG4gICAgICAgIH1cbiAgICAgICAgaXRlbSA9IChjbGVhbkxpbmVzLnNsaWNlKGxpc3RCZWdpbkluZGV4ZXNbbGlzdEJlZ2luQ291bnQgLSAxXSkpO1xuICAgICAgICAvLyB0YWtpbmcgY2FyZSBvZiBNRDAyMlxuICAgICAgICAvLyAgIE1EMDIyL2JsYW5rcy1hcm91bmQtaGVhZGluZ3M6IEhlYWRpbmdzIHNob3VsZCBiZSBzdXJyb3VuZGVkIGJ5IGJsYW5rIGxpbmVzXG4gICAgICAgIGlmIChpdGVtLmF0KC0xKSA9PT0gXCJcIikge1xuICAgICAgICAgICAgaXRlbS5wb3AoKTtcbiAgICAgICAgfSAgICAgICAgXG4gICAgICAgIHRoaXMucHVzaEl0ZW1CYXNlZE9uV2VpZ2h0KGl0ZW0pO1xuICAgIH1cblxuICAgIHB1c2hJdGVtQmFzZWRPbldlaWdodChpdGVtOiBzdHJpbmdbXSkgOiB2b2lkIHtcbiAgICAgICAgY29uc3QgSXRlbVdpdGhXZWlnaHRSZWdFeCA9IC9eXFwoKFxcZCspXFwpXFxzKyguKykkLztcbiAgICAgICAgbGV0IHJlZ0V4RXhlY3V0aW9uO1xuICAgICAgICBsZXQgcmVwZWF0OiBudW1iZXI7XG4gICAgICAgIGlmICgocmVnRXhFeGVjdXRpb24gPSBJdGVtV2l0aFdlaWdodFJlZ0V4LmV4ZWMoaXRlbVswXSkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICByZXBlYXQgPSBOdW1iZXIocmVnRXhFeGVjdXRpb25bMV0pO1xuICAgICAgICAgICAgaXRlbVswXSA9IHJlZ0V4RXhlY3V0aW9uWzJdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVwZWF0ID0gMTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzdHJpbmdJdGVtID0gaXRlbS5qb2luKCdcXG4nKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXBlYXQ7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKHN0cmluZ0l0ZW0pO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGdldExpc3RTdWdnZXN0aW9uKCk6IExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlIHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbiA9IHtcbiAgICAgICAgICAgIHRpdGxlOiB0aGlzLnRpdGxlLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246ICh0aGlzLmRlc2NyaXB0aW9uLnNwbGl0KCdcXG4nKVswXSksXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb247XG4gICAgfTtcblxuICAgIG5vdEhpZGRlbigpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLmhpZGRlbjtcbiAgICB9XG5cbiAgICBwaWNrUmFuZG9tSXRlbSgpOiBzdHJpbmcge1xuICAgICAgICBsZXQgcmFuZG9tSXRlbTogc3RyaW5nID0gXCJcIjtcbiAgICAgICAgaWYgKHRoaXMuaXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmFuZG9tSXRlbSA9IHRoaXMuaXRlbXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGhpcy5pdGVtcy5sZW5ndGgpXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmFuZG9tSXRlbTtcbiAgICB9XG5cbiAgICBnZXRXYXJuaW5nKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMud2FybmluZztcbiAgICB9XG5cbn1cblxuaW50ZXJmYWNlIExJUlBFeGVjTWFjcm9JbnRlcmZhY2Uge1xuICAgIGxhc3RMaXN0VGl0bGU6IHN0cmluZztcbiAgICBtb2RpZmllZEl0ZW06IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIExJUlBOb3RlSW50ZXJmYWNlIHtcbiAgICBub3RlTmFtZTogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgbG9hZEZyb21Ob3RlKG5vdGVOYW1lOiBzdHJpbmcsIG5vdGVDb250ZW50OiBzdHJpbmcpOiBib29sZWFuO1xuICAgIGdldE5vdGVTdWdnZXN0aW9uKCk6IExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlW107XG4gICAgcGlja1JhbmRvbUl0ZW1Gcm9tTGlzdChsaXN0VGl0bGU6IHN0cmluZywgbWFjcm9SZWN1cnNpb246IG51bWJlcik6IHN0cmluZzsgXG4gICAgZ2V0RXJyb3IoKTogc3RyaW5nW107XG4gICAgZ2V0V2FybmluZygpOiBzdHJpbmdbXTtcbn1cblxuY2xhc3MgTElSUE5vdGUgaW1wbGVtZW50cyBMSVJQTm90ZUludGVyZmFjZSB7XG4gICAgbm90ZU5hbWU6IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIGxpc3Q6IExJUlBMaXN0W107XG4gICAgZXJyb3I6IHN0cmluZ1tdO1xuICAgIHdhcm5pbmc6IHN0cmluZ1tdO1xuXG4gICAgY29uc3RydWN0b3IgKCkge1xuICAgICAgICB0aGlzLm5vdGVOYW1lID0gXCJcIjtcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IFwiXCI7XG4gICAgICAgIHRoaXMubGlzdCA9IFtdO1xuICAgICAgICB0aGlzLmVycm9yID0gW107XG4gICAgICAgIHRoaXMud2FybmluZyA9IFtdO1xuICAgIH1cblxuICAgIGxvYWRGcm9tTm90ZShub3RlTmFtZTogc3RyaW5nLCBub3RlQ29udGVudDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHRoaXMubm90ZU5hbWUgPSBub3RlTmFtZTtcbiAgICAgICAgY29uc3QgbGluZXMgPSBub3RlQ29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGNvbnN0IGhlYWRpbmdSZWdleCA9IC9eIyAuKyQvO1xuICAgICAgICBsZXQgaGVhZGluZ0luZGV4ZXMgPSBmaW5kSW5kZXhlcyhsaW5lcywgKGVsZW1lbnQpID0+IGhlYWRpbmdSZWdleC50ZXN0KGVsZW1lbnQpKTtcbiAgICAgICAgaWYgKGhlYWRpbmdJbmRleGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5lcnJvci5wdXNoKGBObyBoZWFkaW5nIGluIG5vdGVgKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaGVhZGluZ0luZGV4ZXNbMF0gIT09IDApIHtcbiAgICAgICAgICAgIC8vIHRha2luZyBjYXJlIG9mIE1EMDIyXG4gICAgICAgICAgICAvLyAgIE1EMDIyL2JsYW5rcy1hcm91bmQtaGVhZGluZ3M6IEhlYWRpbmdzIHNob3VsZCBiZSBzdXJyb3VuZGVkIGJ5IGJsYW5rIGxpbmVzXG4gICAgICAgICAgICAvLyBEdWUgdG8gc3BsaXQgb24gJ1xcbicsIHRoZSBzbGljZSwgYW5kIGF0IGxlYXN0IGEgam9pbiBvbiAnXFxuJyB0aGUgbGFzdCAnXFxuJyBpcyBhbHdheXMgbG9zdCAhXG4gICAgICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gbGluZXMuc2xpY2UoMCwgaGVhZGluZ0luZGV4ZXNbMF0pLmpvaW4oJ1xcbicpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGhlYWRpbmdDb3VudCA9IGhlYWRpbmdJbmRleGVzLmxlbmd0aFxuICAgICAgICBmb3IgKGxldCBjdXJyZW50SW5kZXggPSAwOyBjdXJyZW50SW5kZXggPCAoaGVhZGluZ0NvdW50IC0gMSk7IGN1cnJlbnRJbmRleCsrKSB7XG4gICAgICAgICAgICB0aGlzLmxpc3QucHVzaChuZXcgTElSUExpc3QobGluZXMuc2xpY2UoaGVhZGluZ0luZGV4ZXNbY3VycmVudEluZGV4XSwgaGVhZGluZ0luZGV4ZXNbY3VycmVudEluZGV4ICsgMV0pKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5saXN0LnB1c2gobmV3IExJUlBMaXN0KGxpbmVzLnNsaWNlKGhlYWRpbmdJbmRleGVzW2hlYWRpbmdDb3VudCAtIDFdKSkpO1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIGdldE5vdGVTdWdnZXN0aW9uKCk6IExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlW10ge1xuICAgICAgICBsZXQgbm90ZVN1Z2dlc3Rpb246IExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlW107XG4gICAgICAgIG5vdGVTdWdnZXN0aW9uID0gW107XG4gICAgICAgIHRoaXMubGlzdC5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoZWxlbWVudC5ub3RIaWRkZW4oKSkge1xuICAgICAgICAgICAgICAgIG5vdGVTdWdnZXN0aW9uLnB1c2goZWxlbWVudC5nZXRMaXN0U3VnZ2VzdGlvbigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBub3RlU3VnZ2VzdGlvbjtcbiAgICB9XG5cbiAgICBleGVjTWFjcm9TdWJzdGl0dXRpb24oaXRlbTogc3RyaW5nLCBtYWNyb1JlY3Vyc2lvbjogbnVtYmVyKTogTElSUEV4ZWNNYWNyb0ludGVyZmFjZSB7XG4gICAgICAgIGNvbnN0IHN0cmluZ01hY3JvUmVmUmVnZXg6IHN0cmluZyA9IGBcXHsoJHt0aGlzLmxpc3QubWFwKChlbGVtZW50KSA9PiBlbGVtZW50LnRpdGxlKS5qb2luKCd8Jyl9KVxcfWA7XG4gICAgICAgIGNvbnN0IG1hY3JvUmVmUmVnZXggPSBuZXcgUmVnRXhwIChzdHJpbmdNYWNyb1JlZlJlZ2V4LCdtZycpO1xuICAgICAgICBsZXQgbWF0Y2g7XG4gICAgICAgIGxldCBtb2RpZmllZEl0ZW06c3RyaW5nID0gaXRlbTtcbiAgICAgICAgbGV0IGxpc3RUaXRsZTpzdHJpbmcgPSBcIlwiO1xuICAgICAgICB3aGlsZSAoKG1hdGNoID0gbWFjcm9SZWZSZWdleC5leGVjKG1vZGlmaWVkSXRlbSkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICBsZXQgbmV3VmFsdWU6IHN0cmluZyA9IHRoaXMucGlja1JhbmRvbUl0ZW1Gcm9tTGlzdChtYXRjaFsxXSwgLTEpOyBcbiAgICAgICAgICAgIGxpc3RUaXRsZSA9IG1hdGNoWzBdO1xuICAgICAgICAgICAgbW9kaWZpZWRJdGVtID0gbW9kaWZpZWRJdGVtLnJlcGxhY2UobGlzdFRpdGxlLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICBtYWNyb1JlZlJlZ2V4Lmxhc3RJbmRleCA9IG1hdGNoLmluZGV4ICsgbmV3VmFsdWUubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBsYXN0TGlzdFRpdGxlOiBsaXN0VGl0bGUsXG4gICAgICAgICAgICBtb2RpZmllZEl0ZW06IG1vZGlmaWVkSXRlbSxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwaWNrUmFuZG9tSXRlbUZyb21MaXN0KGxpc3RUaXRsZTogc3RyaW5nLCBtYWNyb1JlY3Vyc2lvbjogbnVtYmVyKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IHJhbmRvbUl0ZW06IHN0cmluZyA9IFwiXCI7XG4gICAgICAgIGxldCByZXR1cm5PZkV4ZWNNYWNybzogTElSUEV4ZWNNYWNyb0ludGVyZmFjZSA9IHtcbiAgICAgICAgICAgIGxhc3RMaXN0VGl0bGU6IFwiXCIsXG4gICAgICAgICAgICBtb2RpZmllZEl0ZW06IFwiXCIsXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGN1cnJlbnRMaXN0ID0gdGhpcy5saXN0LmZpbmQoKGVsZW1lbnQpID0+IGVsZW1lbnQudGl0bGUgPT09IGxpc3RUaXRsZSk7XG4gICAgICAgIGlmIChjdXJyZW50TGlzdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByYW5kb21JdGVtID0gY3VycmVudExpc3QucGlja1JhbmRvbUl0ZW0oKTtcbiAgICAgICAgICAgIGZvciAobGV0IHJlcGVhdCA9IDA7IHJlcGVhdCA8IG1hY3JvUmVjdXJzaW9uOyByZXBlYXQrKykge1xuICAgICAgICAgICAgICAgIHJldHVybk9mRXhlY01hY3JvID0gdGhpcy5leGVjTWFjcm9TdWJzdGl0dXRpb24ocmFuZG9tSXRlbSwgbWFjcm9SZWN1cnNpb24pO1xuICAgICAgICAgICAgICAgIHJhbmRvbUl0ZW0gPSByZXR1cm5PZkV4ZWNNYWNyby5tb2RpZmllZEl0ZW07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc3RyaW5nTWFjcm9SZWZSZWdleDogc3RyaW5nID0gYFxceygke3RoaXMubGlzdC5tYXAoKGVsZW1lbnQpID0+IGVsZW1lbnQudGl0bGUpLmpvaW4oJ3wnKX0pXFx9YDtcbiAgICAgICAgY29uc3QgbWFjcm9SZWZSZWdleCA9IG5ldyBSZWdFeHAgKHN0cmluZ01hY3JvUmVmUmVnZXgpO1xuICAgICAgICBpZiAobWFjcm9SZWZSZWdleC50ZXN0KHJhbmRvbUl0ZW0pICYmIG1hY3JvUmVjdXJzaW9uICE9PSAtMSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgTWFjcm8gZGVwdGggbGltaXQgcmVhY2hlZCBpbiBub3RlIFwiJHt0aGlzLm5vdGVOYW1lfVwiIGFmdGVyIGNhbGxpbmcgXCIke3JldHVybk9mRXhlY01hY3JvLmxhc3RMaXN0VGl0bGV9XCJgKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHJhbmRvbUl0ZW07XG4gICAgfSBcblxuICAgIGdldEVycm9yKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3I7XG4gICAgfTtcblxuICAgIGdldFdhcm5pbmcoKTogc3RyaW5nW10ge1xuICAgICAgICBsZXQgYWxsV2FybmluZzogc3RyaW5nW107XG4gICAgICAgIGFsbFdhcm5pbmcgPSBbXTtcbiAgICAgICAgYWxsV2FybmluZyA9IGFsbFdhcm5pbmcuY29uY2F0KHRoaXMud2FybmluZyk7XG4gICAgICAgIHRoaXMubGlzdC5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBhbGxXYXJuaW5nID0gYWxsV2FybmluZy5jb25jYXQoZWxlbWVudC5nZXRXYXJuaW5nKCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgbGV0IE5vdGVXYXJuaW5nOiBzdHJpbmdbXTtcbiAgICAgICAgTm90ZVdhcm5pbmcgPSBbXTtcbiAgICAgICAgYWxsV2FybmluZy5mb3JFYWNoKChlbGVtZW50KSA9PiBcbiAgICAgICAgICAgIE5vdGVXYXJuaW5nLnB1c2goYFdhcm5pbmcgaW4gbm90ZSBcIiR7dGhpcy5ub3RlTmFtZX1cIiA6ICR7ZWxlbWVudH1gKVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gTm90ZVdhcm5pbmc7XG4gICAgfTtcblxufVxuaW50ZXJmYWNlIExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlIHtcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG59XG5cblxuZXhwb3J0IGNsYXNzIExJUlBTdWdnZXN0TW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8TElSUFN1Z2dlc3Rpb25JbnRlcmZhY2U+IHtcbiAgICBpdGVtczogTElSUFN1Z2dlc3Rpb25JbnRlcmZhY2VbXTtcbiAgICBjYWxsYmFjazogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQ7XG4gIFxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBpdGVtczogTElSUFN1Z2dlc3Rpb25JbnRlcmZhY2VbXSwgY2FsbGJhY2s6ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkKSB7XG4gICAgICBzdXBlcihhcHApO1xuICAgICAgdGhpcy5pdGVtcyA9IGl0ZW1zO1xuICAgICAgdGhpcy5jYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH1cblxuICAgIGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBMSVJQU3VnZ2VzdGlvbkludGVyZmFjZVtdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlbXMuZmlsdGVyKChpdGVtKSA9PlxuICAgICAgICAgICAgaXRlbS50aXRsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5LnRvTG93ZXJDYXNlKCkpXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgXG4gICAgcmVuZGVyU3VnZ2VzdGlvbihpdGVtOiBMSVJQU3VnZ2VzdGlvbkludGVyZmFjZSwgZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGVsLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGl0ZW0udGl0bGUgfSk7XG4gICAgICAgIGVsLmNyZWF0ZUVsKCdzbWFsbCcsIHt0ZXh0OiBpdGVtLmRlc2NyaXB0aW9ufSk7XG4gICAgICB9XG4gIFxuICAgICAgb25DaG9vc2VTdWdnZXN0aW9uKGl0ZW06IExJUlBTdWdnZXN0aW9uSW50ZXJmYWNlLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIHRoaXMuY2FsbGJhY2soaXRlbS50aXRsZSk7XG4gICAgICB9fVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMaXN0SXRlbVJhbmRvbVBpY2tlciBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IExJUlBQbHVnaW5TZXR0aW5ncztcblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuICAgICAgICB0aGlzLmFkZFJpYmJvbkljb24oJ2xpc3QtdHJlZScsICdQaWNrIHJhbmRvbSBsaXN0IGl0ZW0nLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRvVGhlSm9iKHRoaXMuc2V0dGluZ3Mubm90ZVBhdGggKyAnLm1kJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ2luc2VydC1yYW5kb20taXRlbScsXG4gICAgICAgICAgICBuYW1lOiAnSW5zZXJ0IHJhbmRvbSBpdGVtIGZyb20gbGlzdCcsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZG9UaGVKb2IodGhpcy5zZXR0aW5ncy5ub3RlUGF0aCArICcubWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBMSVJQU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuICAgIH1cblxuICAgIG9udW5sb2FkKCkge1xuXG4gICAgfVxuXG4gICAgYXN5bmMgZG9UaGVKb2IoZnVsbE5vdGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmdWxsTm90ZVBhdGgpO1xuXG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnTm90ZSBub3QgZm91bmQhJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdJbnZhbGlkIGZpbGUgdHlwZS4gRXhwZWN0ZWQgYSBNYXJrZG93biBub3RlIGZpbGUuJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKTtcbiAgICAgICAgY29uc3QgY3VycmVudExJUlAgPSBuZXcgTElSUE5vdGUoKTtcblxuICAgICAgICBjb25zdCBsb2FkU3VjY2VzcyA9IGN1cnJlbnRMSVJQLmxvYWRGcm9tTm90ZSh0aGlzLnNldHRpbmdzLm5vdGVQYXRoLCBjb250ZW50KTtcbiAgICAgICAgaWYgKCFsb2FkU3VjY2Vzcykge1xuICAgICAgICAgICAgY3VycmVudExJUlAuZ2V0RXJyb3IoKS5mb3JFYWNoKChlbGVtZW50KSA9PiBuZXcgTm90aWNlKGVsZW1lbnQpKTtcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnNob3dXYXJuaW5nKSB7XG4gICAgICAgICAgICBjdXJyZW50TElSUC5nZXRXYXJuaW5nKCkuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGVsZW1lbnQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIG5ldyBMSVJQU3VnZ2VzdE1vZGFsKHRoaXMuYXBwLCBjdXJyZW50TElSUC5nZXROb3RlU3VnZ2VzdGlvbigpLCAodGl0bGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMud29ya1dpdGhUaXRsZShjdXJyZW50TElSUCwgdGl0bGUpO1xuICAgICAgICB9KS5vcGVuKCk7XG4gICAgfVxuXG4gICAgd29ya1dpdGhUaXRsZShOb3RlOiBMSVJQTm90ZUludGVyZmFjZSwgbGlzdFRpdGxlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgc3RyaW5nTm90aWNlUmVnZXg6c3RyaW5nID0gYF4gKiR7dGhpcy5zZXR0aW5ncy5ub3RpY2VQcmVmaXh9KC4qKWA7XG4gICAgICAgIGNvbnN0IG5vdGljZVJlZ2V4ID0gbmV3IFJlZ0V4cChzdHJpbmdOb3RpY2VSZWdleCk7XG5cbiAgICAgICAgaWYgKG5vdGljZVJlZ2V4LnRlc3QobGlzdFRpdGxlKSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZShOb3RlLnBpY2tSYW5kb21JdGVtRnJvbUxpc3QobGlzdFRpdGxlLCB0aGlzLnNldHRpbmdzLm1heE1hY3JvRGVwdGgpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXG4gICAgICAgICAgICBpZiAoYWN0aXZlVmlldykge1xuICAgICAgICAgICAgICAgIGxldCBzdHJpbmdUb0luc2VydDogc3RyaW5nID0gJyc7XG4gICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gYWN0aXZlVmlldy5lZGl0b3I7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlcGVhdEluc2VydFJlZ0V4ID0gL14oXFxkKykoLiopL2dtO1xuICAgICAgICAgICAgICAgIGxldCByZWdFeEV4ZWN1dGlvbjtcbiAgICAgICAgICAgICAgICBsZXQgcmVwZWF0OiBudW1iZXI7XG4gICAgICAgICAgICAgICAgaWYgKChyZWdFeEV4ZWN1dGlvbiA9IHJlcGVhdEluc2VydFJlZ0V4LmV4ZWMoc2VsZWN0aW9uKSkgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVwZWF0ID0gTnVtYmVyKHJlZ0V4RXhlY3V0aW9uWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVsaW1pdGVyID0gc2VsZWN0aW9uLnJlcGxhY2UoL15cXGQrLywgJycpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhcnJheVN0cmluZ1RvaW5zZXJ0OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlcGVhdDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcnJheVN0cmluZ1RvaW5zZXJ0LnB1c2goTm90ZS5waWNrUmFuZG9tSXRlbUZyb21MaXN0KGxpc3RUaXRsZSwgdGhpcy5zZXR0aW5ncy5tYXhNYWNyb0RlcHRoKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3RyaW5nVG9JbnNlcnQgPSBhcnJheVN0cmluZ1RvaW5zZXJ0LmpvaW4oZGVsaW1pdGVyKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdHJpbmdUb0luc2VydCA9IE5vdGUucGlja1JhbmRvbUl0ZW1Gcm9tTGlzdChsaXN0VGl0bGUsIHRoaXMuc2V0dGluZ3MubWF4TWFjcm9EZXB0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKHN0cmluZ1RvSW5zZXJ0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIk5vIGFjdGl2ZSBNYXJrZG93biBlZGl0b3IgZm91bmQuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cbn1cblxuY2xhc3MgTElSUFNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IExpc3RJdGVtUmFuZG9tUGlja2VyO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTGlzdEl0ZW1SYW5kb21QaWNrZXIpIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ05vdGUgUGF0aCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnVGhlIHBhdGggYW5kIGZpbGVuYW1lIG9mIHRoZSBub3RlIHRoYXQgY29udGFpbnMgdGhlIGxpc3RzIHRvIGJlIHVzZWQuIEV4ZW1wbGUgOiBcIkZvbGRlci9Ob3RlXCIuJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignRW50ZXIgdGhlIHBhdGggdG8geW91ciBub3RlJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mubm90ZVBhdGgpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5ub3RlUGF0aCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiU2hvdyB3YXJuaW5nXCIpXG4gICAgICAgICAgICAuc2V0RGVzYygnRGlzcGxheSB0aGUgd2FybmluZ3Mgb2Ygbm90ZXMgYW5kIGxpc3RzLCBpZiBhbnkuIFdhcm5pbmdzIGZvciBtYWNybyBkZXB0aCBsaW1pdCByZWFjaGVkIGFyZSBhbHdheXMgZGlzcGxheWVkLicpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHtcbiAgICAgICAgICAgICAgICB0b2dnbGUuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd1dhcm5pbmcpO1xuICAgICAgICAgICAgICAgIHRvZ2dsZS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd1dhcm5pbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJNYWNybyBkZXB0aCBsaW1pdFwiKVxuICAgICAgICAgICAgLnNldERlc2MoXCJNYWNybyByZWN1cnNpb24gbGltaXQ6IGhvdyBtYW55IG5lc3RlZCBtYWNybyBjYWxscyBhcmUgYWxsb3dlZC4gWmVybyBwcmV2ZW50cyBuZXN0ZWQgbWFjcm9zIGZyb20gYmVpbmcgcmVzb2x2ZWQuXCIpXG4gICAgICAgICAgICAuYWRkU2xpZGVyKChzbGlkZXIpID0+XG4gICAgICAgICAgICAgICAgc2xpZGVyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhNYWNyb0RlcHRoIC0gMSlcbiAgICAgICAgICAgICAgICAgICAgLnNldExpbWl0cygwLCAxMCwgMSlcbiAgICAgICAgICAgICAgICAgICAgLnNldER5bmFtaWNUb29sdGlwKClcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhNYWNyb0RlcHRoID0gdmFsdWUgKyAxO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdMaXN0IHByZWZpeCBmb3Igbm90aWZpY2F0aW9uJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdJZiBhIGxpc3QgaGVhZGluZyBiZWdpbiB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWUsIHRoZSBwaWNrZWQgaXRlbSBpcyBub3QgaW5zZXJ0ZWQsIGJ1dCBub3RpZmllZC4nKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdFbnRlciBwcmVmaXggdmFsdWUnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5ub3RpY2VQcmVmaXgpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5ub3RpY2VQcmVmaXggPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICB9XG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7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
